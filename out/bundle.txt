===== FILE: .gitattributes =====
* text=auto eol=lf

*.png binary
*.jpg binary
*.jpeg binary
*.gif binary
*.webp binary
*.ico binary
*.pdf binary
*.zip binary
===== FILE: data_kanto.js =====
// 関東エリア路線データ
window.railwayLinesDataChunks = window.railwayLinesDataChunks || {};
Object.assign(window.railwayLinesDataChunks, {
  "kanto:yamanote": { area: "関東", lineName: "山手線", scope: "東京支社", stations: [{ name: "東京" }, { name: "有楽町" }, { name: "新橋" }, { name: "浜松町" }, { name: "田町" }, { name: "高輪ゲートウェイ" }, { name: "品川" }, { name: "大崎" }, { name: "五反田" }, { name: "目黒" }, { name: "恵比寿" }, { name: "渋谷" }, { name: "原宿" }, { name: "代々木" }, { name: "新宿" }, { name: "新大久保" }, { name: "高田馬場" }, { name: "目白" }, { name: "池袋" }, { name: "大塚" }, { name: "巣鴨" }, { name: "駒込" }, { name: "田端" }, { name: "西日暮里" }, { name: "日暮里" }, { name: "鶯谷" }, { name: "上野" }, { name: "御徒町" }, { name: "秋葉原" }, { name: "神田" }] },
  "kanto:ueno_tokyo_utsunomiya": { area: "関東", lineName: "上野東京ライン", scope: "宇都宮線系統", stations: [{ name: "宇都宮" }, { name: "雀宮" }, { name: "石橋" }, { name: "自治医大" }, { name: "小金井" }, { name: "小山" }, { name: "間々田" }, { name: "野木" }, { name: "古河" }, { name: "栗橋" }, { name: "東鷲宮" }, { name: "久喜" }, { name: "新白岡" }, { name: "白岡" }, { name: "蓮田" }, { name: "東大宮" }, { name: "土呂" }, { name: "大宮" }, { name: "さいたま新都心" }, { name: "浦和" }, { name: "赤羽" }, { name: "尾久" }, { name: "上野" }, { name: "東京" }, { name: "新橋" }, { name: "品川" }, { name: "川崎" }, { name: "横浜" }, { name: "戸塚" }, { name: "大船" }, { name: "藤沢" }, { name: "辻堂" }, { name: "茅ケ崎" }, { name: "平塚" }, { name: "大磯" }, { name: "二宮" }, { name: "国府津" }, { name: "鴨宮" }, { name: "小田原" }, { name: "早川" }, { name: "根府川" }, { name: "真鶴" }, { name: "湯河原" }, { name: "熱海" }] },
  "kanto:ueno_tokyo_takasaki": { area: "関東", lineName: "上野東京ライン", scope: "高崎線系統", stations: [{ name: "東京" }, { name: "上野" }, { name: "赤羽" }, { name: "大宮" }, { name: "桶川" }, { name: "熊谷" }, { name: "高崎" }] },
  "kanto:shonan_shinjuku_utsunomiya": { area: "関東", lineName: "湘南新宿ライン", scope: "宇都宮線系統", stations: [{ name: "宇都宮" }, { name: "雀宮" }, { name: "石橋" }, { name: "自治医大" }, { name: "小金井" }, { name: "小山" }, { name: "間々田" }, { name: "野木" }, { name: "古河" }, { name: "栗橋" }, { name: "東鷲宮" }, { name: "久喜" }, { name: "新白岡" }, { name: "白岡" }, { name: "蓮田" }, { name: "東大宮" }, { name: "土呂" }, { name: "大宮" }, { name: "浦和" }, { name: "赤羽" }, { name: "池袋" }, { name: "新宿" }, { name: "渋谷" }, { name: "恵比寿" }, { name: "大崎" }, { name: "西大井" }, { name: "武蔵小杉" }, { name: "新川崎" }, { name: "横浜" }, { name: "保土ケ谷" }, { name: "東戸塚" }, { name: "戸塚" }, { name: "大船" }, { name: "北鎌倉" }, { name: "鎌倉" }, { name: "逗子" }] },
  "kanto:shonan_shinjuku_takasaki": { area: "関東", lineName: "湘南新宿ライン", scope: "高崎線系統", stations: [{ name: "高崎" }, { name: "倉賀野" }, { name: "新町" }, { name: "神保原" }, { name: "本庄" }, { name: "岡部" }, { name: "深谷" }, { name: "籠原" }, { name: "熊谷" }, { name: "行田" }, { name: "吹上" }, { name: "北鴻巣" }, { name: "鴻巣" }, { name: "北本" }, { name: "桶川" }, { name: "北上尾" }, { name: "上尾" }, { name: "宮原" }, { name: "大宮" }, { name: "浦和" }, { name: "赤羽" }, { name: "池袋" }, { name: "新宿" }, { name: "渋谷" }, { name: "恵比寿" }, { name: "大崎" }, { name: "西大井" }, { name: "武蔵小杉" }, { name: "横浜" }, { name: "戸塚" }, { name: "大船" }, { name: "藤沢" }, { name: "辻堂" }, { name: "茅ケ崎" }, { name: "平塚" }, { name: "大磯" }, { name: "二宮" }, { name: "国府津" }, { name: "鴨宮" }, { name: "小田原" }] },
  "kanto:sotetsu_direct": { area: "関東", lineName: "相鉄線直通列車", scope: "直通", stations: [{ name: "新宿" }, { name: "大崎" }, { name: "武蔵小杉" }] },

  "kanto:tokaido": { area: "関東", lineName: "東海道線", lineNameKana: "とうかいどうせん", scope: "横浜支社", stations: [{ name: "東京" }, { name: "新橋" }, { name: "品川" }, { name: "川崎" }, { name: "横浜" }, { name: "戸塚" }, { name: "大船" }, { name: "藤沢" }, { name: "辻堂" }, { name: "茅ケ崎" }, { name: "平塚" }, { name: "大磯" }, { name: "二宮" }, { name: "国府津" }, { name: "鴨宮" }, { name: "小田原" }, { name: "早川" }, { name: "根府川" }, { name: "真鶴" }, { name: "湯河原" }, { name: "熱海" }] },
  "kanto:keihin_tohoku_local": { area: "関東", lineName: "京浜東北線", lineNameKana: "けいひんとうほくせん", scope: "東京支社", stations: [{ name: "大宮" }, { name: "さいたま新都心" }, { name: "与野" }, { name: "北浦和" }, { name: "浦和" }, { name: "南浦和" }, { name: "蕨" }, { name: "西川口" }, { name: "川口" }, { name: "赤羽" }, { name: "東十条" }, { name: "王子" }, { name: "上中里" }, { name: "田端" }, { name: "西日暮里" }, { name: "日暮里" }, { name: "鶯谷" }, { name: "上野" }, { name: "御徒町" }, { name: "秋葉原" }, { name: "神田" }, { name: "東京" }, { name: "有楽町" }, { name: "新橋" }, { name: "浜松町" }, { name: "田町" }, { name: "高輪ゲートウェイ" }, { name: "品川" }, { name: "大井町" }, { name: "大森" }, { name: "蒲田" }, { name: "川崎" }, { name: "鶴見" }, { name: "新子安" }, { name: "東神奈川" }, { name: "横浜" }, { name: "桜木町" }, { name: "関内" }, { name: "石川町" }, { name: "山手" }, { name: "根岸" }, { name: "磯子" }, { name: "新杉田" }, { name: "洋光台" }, { name: "港南台" }, { name: "本郷台" }, { name: "大船" }] },
  "kanto:yokosuka": { area: "関東", lineName: "横須賀線", lineNameKana: "よこすかせん", scope: "横浜支社", stations: [{ name: "東京" }, { name: "新橋" }, { name: "品川" }, { name: "西大井" }, { name: "武蔵小杉" }, { name: "新川崎" }, { name: "横浜" }, { name: "保土ケ谷" }, { name: "東戸塚" }, { name: "戸塚" }, { name: "大船" }, { name: "北鎌倉" }, { name: "鎌倉" }, { name: "逗子" }, { name: "東逗子" }, { name: "田浦" }, { name: "横須賀" }, { name: "衣笠" }, { name: "久里浜" }] },
  "kanto:nambu": { area: "関東", lineName: "南武線", lineNameKana: "なんぶせん", scope: "横浜支社", stations: [{ name: "川崎" }, { name: "尻手" }, { name: "矢向" }, { name: "鹿島田" }, { name: "平間" }, { name: "向河原" }, { name: "武蔵小杉" }, { name: "武蔵中原" }, { name: "武蔵新城" }, { name: "武蔵溝ノ口" }, { name: "津田山" }, { name: "久地" }, { name: "宿河原" }, { name: "登戸" }, { name: "中野島" }, { name: "稲田堤" }, { name: "矢野口" }, { name: "稲城長沼" }, { name: "南多摩" }, { name: "府中本町" }, { name: "分倍河原" }, { name: "西府" }, { name: "谷保" }, { name: "矢川" }, { name: "西国立" }, { name: "立川" }] },
  "kanto:yokohama": { area: "関東", lineName: "横浜線", lineNameKana: "よこはません", scope: "八王子支社", stations: [{ name: "東神奈川" }, { name: "大口" }, { name: "菊名" }, { name: "新横浜" }, { name: "小机" }, { name: "鴨居" }, { name: "中山" }, { name: "十日市場" }, { name: "長津田" }, { name: "成瀬" }, { name: "町田" }, { name: "古淵" }, { name: "淵野辺" }, { name: "矢部" }, { name: "相模原" }, { name: "橋本" }, { name: "相原" }, { name: "八王子みなみ野" }, { name: "片倉" }, { name: "八王子" }] },
  "kanto:ito": { area: "関東", lineName: "伊東線", lineNameKana: "いとうせん", scope: "横浜支社", stations: [{ name: "熱海" }, { name: "来宮" }, { name: "伊豆多賀" }, { name: "網代" }, { name: "宇佐美" }, { name: "伊東" }] },
  "kanto:sagami": { area: "関東", lineName: "相模線", lineNameKana: "さがみせん", scope: "横浜支社", stations: [{ name: "茅ケ崎" }, { name: "北茅ケ崎" }, { name: "香川" }, { name: "寒川" }, { name: "宮山" }, { name: "倉見" }, { name: "門沢橋" }, { name: "社家" }, { name: "厚木" }, { name: "海老名" }, { name: "入谷" }, { name: "相武台下" }, { name: "下溝" }, { name: "原当麻" }, { name: "番田" }, { name: "上溝" }, { name: "南橋本" }, { name: "橋本" }] },
  "kanto:tsurumi": { area: "関東", lineName: "鶴見線", lineNameKana: "つるみせん", scope: "横浜支社", stations: [{ name: "鶴見" }, { name: "国道" }, { name: "鶴見小野" }, { name: "弁天橋" }, { name: "浅野" }, { name: "安善" }, { name: "武蔵白石" }, { name: "浜川崎" }, { name: "昭和" }, { name: "扇町" }, { name: "新芝浦" }, { name: "海芝浦" }, { name: "大川" }] },

  "kanto:utsunomiya": { area: "関東", lineName: "宇都宮線", scope: "大宮支社", stations: [{ name: "東京" }, { name: "上野" }, { name: "尾久" }, { name: "赤羽" }, { name: "浦和" }, { name: "さいたま新都心" }, { name: "大宮" }, { name: "蓮田" }, { name: "久喜" }, { name: "古河" }, { name: "小山" }, { name: "自治医大" }, { name: "石橋" }, { name: "雀宮" }, { name: "宇都宮" }] },
  "kanto:takasaki": { area: "関東", lineName: "高崎線", scope: "高崎支社", stations: [{ name: "東京" }, { name: "上野" }, { name: "尾久" }, { name: "赤羽" }, { name: "浦和" }, { name: "さいたま新都心" }, { name: "大宮" }, { name: "宮原" }, { name: "上尾" }, { name: "北上尾" }, { name: "桶川" }, { name: "鴻巣" }, { name: "熊谷" }, { name: "籠原" }, { name: "深谷" }, { name: "本庄" }, { name: "新町" }, { name: "倉賀野" }, { name: "高崎" }] },
  "kanto:saikyo": { area: "関東", lineName: "埼京線", scope: "東京支社", stations: [{ name: "大崎" }, { name: "恵比寿" }, { name: "渋谷" }, { name: "新宿" }, { name: "池袋" }, { name: "板橋" }, { name: "十条" }, { name: "赤羽" }, { name: "北赤羽" }, { name: "浮間舟渡" }, { name: "戸田公園" }, { name: "戸田" }, { name: "北戸田" }, { name: "武蔵浦和" }, { name: "中浦和" }, { name: "南与野" }, { name: "与野本町" }, { name: "さいたま新都心" }, { name: "大宮" }] },
  "kanto:kawagoe": { area: "関東", lineName: "川越線", scope: "大宮支社", stations: [{ name: "大宮" }, { name: "川越" }, { name: "高麗川" }] },
  "kanto:musashino": { area: "関東", lineName: "武蔵野線", scope: "関東本部", stations: [{ name: "府中本町" }, { name: "北府中" }, { name: "西国分寺" }, { name: "新小平" }, { name: "新秋津" }, { name: "東所沢" }, { name: "新座" }, { name: "北朝霞" }, { name: "西浦和" }, { name: "武蔵浦和" }, { name: "南浦和" }, { name: "東浦和" }, { name: "東川口" }, { name: "南越谷" }, { name: "越谷レイクタウン" }, { name: "吉川" }, { name: "吉川美南" }, { name: "新三郷" }, { name: "三郷" }, { name: "南流山" }, { name: "新松戸" }, { name: "新八柱" }, { name: "東松戸" }, { name: "市川大野" }, { name: "船橋法典" }, { name: "西船橋" }] },
  "kanto:joetsu_kanto": { area: "関東", lineName: "上越線", scope: "高崎支社", stations: [{ name: "高崎" }, { name: "新前橋" }, { name: "渋川" }, { name: "沼田" }, { name: "水上" }] },
  "kanto:shinetsu_kanto": { area: "関東", lineName: "信越本線", scope: "高崎支社", stations: [{ name: "高崎" }, { name: "安中" }, { name: "磯部" }, { name: "横川" }] },
  "kanto:agatsuma": { area: "関東", lineName: "吾妻線", scope: "高崎支社", stations: [{ name: "渋川" }, { name: "中之条" }, { name: "長野原草津口" }, { name: "万座・鹿沢口" }, { name: "大前" }] },
  "kanto:karasuyama": { area: "関東", lineName: "烏山線", scope: "大宮支社", stations: [{ name: "宝積寺" }, { name: "烏山" }] },
  "kanto:hachiko": { area: "関東", lineName: "八高線", scope: "八王子支社", stations: [{ name: "八王子" }, { name: "拝島" }, { name: "高麗川" }, { name: "寄居" }, { name: "高崎" }] },
  "kanto:nikko": { area: "関東", lineName: "日光線", scope: "大宮支社", stations: [{ name: "宇都宮" }, { name: "日光" }] },
  "kanto:ryomo": { area: "関東", lineName: "両毛線", scope: "高崎支社", stations: [{ name: "高崎" }, { name: "前橋" }, { name: "桐生" }, { name: "足利" }, { name: "小山" }] },

  "kanto:chuo_rapid": { area: "関東", lineName: "中央線快速電車", scope: "東京支社", stations: [{ name: "東京" }, { name: "神田" }, { name: "御茶ノ水" }, { name: "四ツ谷" }, { name: "新宿" }, { name: "中野" }, { name: "荻窪" }, { name: "吉祥寺" }, { name: "三鷹" }, { name: "国分寺" }, { name: "立川" }, { name: "八王子" }, { name: "西八王子" }, { name: "高尾" }] },
  "kanto:chuo_sobu_local": { area: "関東", lineName: "中央・総武各駅停車", scope: "東京支社", stations: [{ name: "三鷹" }, { name: "中野" }, { name: "新宿" }, { name: "四ツ谷" }, { name: "御茶ノ水" }, { name: "秋葉原" }, { name: "錦糸町" }, { name: "亀戸" }, { name: "平井" }, { name: "新小岩" }, { name: "小岩" }, { name: "市川" }, { name: "本八幡" }, { name: "下総中山" }, { name: "西船橋" }] },
  "kanto:chuo_main": { area: "関東", lineName: "中央本線", scope: "東京支社", stations: [{ name: "新宿" }, { name: "立川" }, { name: "八王子" }, { name: "高尾" }, { name: "大月" }, { name: "甲府" }] },
  "kanto:itsukaichi": { area: "関東", lineName: "五日市線", scope: "八王子支社", stations: [{ name: "拝島" }, { name: "武蔵五日市" }] },
  "kanto:ome": { area: "関東", lineName: "青梅線", scope: "八王子支社", stations: [{ name: "立川" }, { name: "拝島" }, { name: "青梅" }, { name: "奥多摩" }] },
  "kanto:koumi": { area: "関東", lineName: "小海線", scope: "八王子支社", stations: [{ name: "小淵沢" }, { name: "野辺山" }, { name: "小諸" }] },

  "kanto:joban": { area: "関東", lineName: "常磐線", scope: "水戸支社", stations: [{ name: "上野" }, { name: "日暮里" }, { name: "三河島" }, { name: "南千住" }, { name: "北千住" }, { name: "松戸" }, { name: "柏" }, { name: "我孫子" }, { name: "取手" }, { name: "藤代" }, { name: "龍ケ崎市" }, { name: "牛久" }, { name: "ひたち野うしく" }, { name: "荒川沖" }, { name: "土浦" }, { name: "石岡" }, { name: "友部" }, { name: "赤塚" }, { name: "水戸" }] },
  "kanto:joban_rapid": { area: "関東", lineName: "常磐線快速電車", scope: "東京支社", stations: [{ name: "品川" }, { name: "新橋" }, { name: "東京" }, { name: "上野" }, { name: "日暮里" }, { name: "北千住" }, { name: "松戸" }, { name: "柏" }, { name: "我孫子" }, { name: "取手" }] },
  "kanto:joban_local": { area: "関東", lineName: "常磐線各駅停車", scope: "東京支社", stations: [{ name: "綾瀬" }, { name: "亀有" }, { name: "金町" }, { name: "松戸" }, { name: "北松戸" }, { name: "馬橋" }, { name: "新松戸" }, { name: "北小金" }, { name: "南柏" }, { name: "柏" }, { name: "北柏" }, { name: "我孫子" }, { name: "天王台" }, { name: "取手" }] },
  "kanto:suigun": { area: "関東", lineName: "水郡線", scope: "水戸支社", stations: [{ name: "水戸" }, { name: "常陸大子" }, { name: "郡山" }] },
  "kanto:mito": { area: "関東", lineName: "水戸線", scope: "水戸支社", stations: [{ name: "小山" }, { name: "下館" }, { name: "友部" }] },

  "kanto:sobu_rapid": { area: "関東", lineName: "総武快速線", scope: "千葉支社", stations: [{ name: "東京" }, { name: "新橋" }, { name: "品川" }, { name: "錦糸町" }, { name: "新小岩" }, { name: "市川" }, { name: "船橋" }, { name: "津田沼" }, { name: "稲毛" }, { name: "千葉" }] },
  "kanto:sobu_main": { area: "関東", lineName: "総武本線", scope: "千葉支社", stations: [{ name: "千葉" }, { name: "佐倉" }, { name: "成東" }, { name: "八日市場" }, { name: "銚子" }] },
  "kanto:keiyo": { area: "関東", lineName: "京葉線", scope: "千葉支社", stations: [{ name: "東京" }, { name: "八丁堀" }, { name: "越中島" }, { name: "潮見" }, { name: "新木場" }, { name: "葛西臨海公園" }, { name: "舞浜" }, { name: "新浦安" }, { name: "市川塩浜" }, { name: "西船橋" }, { name: "二俣新町" }, { name: "南船橋" }, { name: "新習志野" }, { name: "幕張豊砂" }, { name: "海浜幕張" }, { name: "検見川浜" }, { name: "稲毛海岸" }, { name: "千葉みなと" }, { name: "蘇我" }] },
  "kanto:uchibo": { area: "関東", lineName: "内房線", scope: "千葉支社", stations: [{ name: "蘇我" }, { name: "浜野" }, { name: "八幡宿" }, { name: "五井" }, { name: "姉ケ崎" }, { name: "木更津" }, { name: "君津" }, { name: "富浦" }, { name: "那古船形" }, { name: "館山" }, { name: "千倉" }, { name: "安房鴨川" }] },
  "kanto:kashima": { area: "関東", lineName: "鹿島線", scope: "千葉支社", stations: [{ name: "佐原" }, { name: "十二橋" }, { name: "潮来" }, { name: "鹿島神宮" }] },
  "kanto:kururi": { area: "関東", lineName: "久留里線", scope: "千葉支社", stations: [{ name: "木更津" }, { name: "横田" }, { name: "久留里" }, { name: "上総亀山" }] },
  "kanto:sotobo": { area: "関東", lineName: "外房線", scope: "千葉支社", stations: [{ name: "千葉" }, { name: "蘇我" }, { name: "鎌取" }, { name: "誉田" }, { name: "土気" }, { name: "大網" }, { name: "茂原" }, { name: "上総一ノ宮" }, { name: "勝浦" }, { name: "安房鴨川" }] },
  "kanto:togane": { area: "関東", lineName: "東金線", scope: "千葉支社", stations: [{ name: "大網" }, { name: "東金" }, { name: "成東" }] },
  "kanto:narita": { area: "関東", lineName: "成田線", scope: "千葉支社", stations: [{ name: "千葉" }, { name: "成田" }, { name: "佐原" }, { name: "銚子" }] },

  "kanto:monorail": { area: "関東", lineName: "東京モノレール線", scope: "東京モノレール", stations: [{ name: "浜松町" }, { name: "天王洲アイル" }, { name: "大井競馬場前" }, { name: "流通センター" }, { name: "羽田空港第1ターミナル" }, { name: "羽田空港第2ターミナル" }] }
});









===== FILE: data_limited.js =====
// 在来線特急データ
window.railwayLinesDataChunks = window.railwayLinesDataChunks || {};
Object.assign(window.railwayLinesDataChunks, {
  "limited:nex": { area: "在来線特急", lineName: "成田エクスプレス", scope: "特急", stations: [] },
  "limited:hitachi": { area: "在来線特急", lineName: "ひたち・ときわ", scope: "特急", stations: [] },
  "limited:azusa": { area: "在来線特急", lineName: "あずさ・かいじ・富士回遊", scope: "特急", stations: [] },
  "limited:shinano": { area: "在来線特急", lineName: "しなの", scope: "特急", stations: [] },
  "limited:wakashio": { area: "在来線特急", lineName: "わかしお・さざなみ", scope: "特急", stations: [] },
  "limited:shiosai": { area: "在来線特急", lineName: "しおさい", scope: "特急", stations: [] },
  "limited:nikko": { area: "在来線特急", lineName: "日光・きぬがわ", scope: "特急", stations: [] },
  "limited:kusatsu": { area: "在来線特急", lineName: "草津・四万・あかぎ", scope: "特急", stations: [] },
  "limited:odoriko": { area: "在来線特急", lineName: "踊り子・湘南", scope: "特急", stations: [] },
  "limited:inaho": { area: "在来線特急", lineName: "いなほ・しらゆき", scope: "特急", stations: [] },
  "limited:tsugaru": { area: "在来線特急", lineName: "つがる", scope: "特急", stations: [] },
  "limited:sunrise": { area: "在来線特急", lineName: "サンライズ瀬戸・出雲", scope: "特急", stations: [] },
  "limited:extra": { area: "在来線特急", lineName: "臨時列車", scope: "特急", stations: [] }
});
===== FILE: data_shinetsu.js =====
// 信越エリア路線データ
window.railwayLinesDataChunks = window.railwayLinesDataChunks || {};
Object.assign(window.railwayLinesDataChunks, {
  "shinetsu:uetsu": { area: "信越", lineName: "羽越本線", scope: "新潟支社", stations: [{ name: "新津" }, { name: "新発田" }, { name: "中条" }, { name: "坂町" }, { name: "村上" }] },
  "shinetsu:shinetsu_main": { area: "信越", lineName: "信越本線", scope: "新潟支社", stations: [{ name: "直江津" }, { name: "柿崎" }, { name: "柏崎" }, { name: "長岡" }, { name: "見附" }, { name: "東三条" }, { name: "新津" }, { name: "新潟" }] },
  "shinetsu:joetsu": { area: "信越", lineName: "上越線", scope: "高崎・越後湯沢側", stations: [{ name: "高崎" }, { name: "渋川" }, { name: "水上" }, { name: "越後湯沢" }, { name: "小千谷" }, { name: "長岡" }] },
  "shinetsu:shinonoi": { area: "信越", lineName: "篠ノ井線", scope: "長野支社", stations: [{ name: "松本" }, { name: "明科" }, { name: "姨捨" }, { name: "篠ノ井" }] },
  "shinetsu:koshinetsu_chuo_main": { area: "信越", lineName: "中央本線", scope: "長野支社", stations: [{ name: "小淵沢" }, { name: "富士見" }, { name: "上諏訪" }, { name: "岡谷" }, { name: "塩尻" }, { name: "松本" }] },
  "shinetsu:hakushin": { area: "信越", lineName: "白新線", scope: "新潟支社", stations: [{ name: "新潟" }, { name: "豊栄" }, { name: "新発田" }] },
  "shinetsu:banetsu_west": { area: "信越", lineName: "磐越西線", scope: "新潟支社", stations: [{ name: "新津" }, { name: "津川" }, { name: "野沢" }, { name: "日出谷" }, { name: "荻野" }, { name: "会津若松" }] },
  "shinetsu:iiyama": { area: "信越", lineName: "飯山線", scope: "長野支社", stations: [{ name: "長野" }, { name: "豊野" }, { name: "飯山" }, { name: "戸狩野沢温泉" }, { name: "森宮野原" }, { name: "十日町" }, { name: "越後川口" }] },
  "shinetsu:echigo": { area: "信越", lineName: "越後線", scope: "新潟支社", stations: [{ name: "柏崎" }, { name: "吉田" }, { name: "内野" }, { name: "新潟" }] },
  "shinetsu:oito": { area: "信越", lineName: "大糸線", scope: "長野支社", stations: [{ name: "松本" }, { name: "信濃大町" }, { name: "白馬" }, { name: "南小谷" }] },
  "shinetsu:koumi": { area: "信越", lineName: "小海線", scope: "長野支社", stations: [{ name: "小淵沢" }, { name: "野辺山" }, { name: "小海" }, { name: "小諸" }] },
  "shinetsu:tadami": { area: "信越", lineName: "只見線", scope: "新潟支社", stations: [{ name: "只見" }, { name: "大白川" }, { name: "小出" }] },
  "shinetsu:yahiko": { area: "信越", lineName: "弥彦線", scope: "新潟支社", stations: [{ name: "東三条" }, { name: "燕三条" }, { name: "吉田" }, { name: "弥彦" }] },
  "shinetsu:yonesaka": { area: "信越", lineName: "米坂線", scope: "新潟支社", stations: [{ name: "坂町" }, { name: "小国" }, { name: "今泉" }, { name: "米沢" }] },
  "shinetsu:gono": { area: "信越", lineName: "五能線", scope: "能代方", stations: [{ name: "東能代" }, { name: "深浦" }, { name: "鰺ケ沢" }, { name: "五所川原" }, { name: "弘前" }] }
});
===== FILE: data_shinkansen.js =====
// 新幹線データ
window.railwayLinesDataChunks = window.railwayLinesDataChunks || {};
Object.assign(window.railwayLinesDataChunks, {
  "shinkansen:tohoku": { area: "新幹線", lineName: "東北新幹線", scope: "新幹線", stations: [{ name: "東京" }, { name: "大宮" }, { name: "仙台" }, { name: "盛岡" }, { name: "新青森" }] },
  "shinkansen:yamagata": { area: "新幹線", lineName: "山形新幹線", scope: "新幹線", stations: [{ name: "福島" }, { name: "山形" }, { name: "新庄" }] },
  "shinkansen:akita": { area: "新幹線", lineName: "秋田新幹線", scope: "新幹線", stations: [{ name: "盛岡" }, { name: "田沢湖" }, { name: "秋田" }] },
  "shinkansen:joetsu": { area: "新幹線", lineName: "上越新幹線", scope: "新幹線", stations: [{ name: "東京" }, { name: "大宮" }, { name: "越後湯沢" }, { name: "新潟" }] },
  "shinkansen:hokuriku": { area: "新幹線", lineName: "北陸新幹線", scope: "新幹線", stations: [{ name: "東京" }, { name: "高崎" }, { name: "長野" }] }
});
===== FILE: data_tohoku.js =====
// 東北エリア路線データ
window.railwayLinesDataChunks = window.railwayLinesDataChunks || {};
Object.assign(window.railwayLinesDataChunks, {
  "tohoku:uetsu_northern": { area: "東北", lineName: "羽越本線", scope: "秋田・酒田側", stations: [{ name: "秋田" }, { name: "羽後本荘" }, { name: "仁賀保" }, { name: "酒田" }] },
  "tohoku:ou_main_aomori_akita": { area: "東北", lineName: "奥羽本線", scope: "青森・秋田", stations: [{ name: "青森" }, { name: "弘前" }, { name: "大館" }, { name: "鷹ノ巣" }, { name: "秋田" }] },
  "tohoku:ou_main_yamagata": { area: "東北", lineName: "奥羽本線", scope: "山形線", stations: [{ name: "福島" }, { name: "米沢" }, { name: "高畠" }, { name: "赤湯" }, { name: "かみのやま温泉" }, { name: "山形" }, { name: "天童" }, { name: "新庄" }] },
  "tohoku:joban": { area: "東北", lineName: "常磐線", scope: "仙台支社", stations: [{ name: "いわき" }, { name: "原ノ町" }, { name: "相馬" }, { name: "亘理" }, { name: "岩沼" }, { name: "仙台" }] },
  "tohoku:senzan": { area: "東北", lineName: "仙山線", scope: "仙台支社", stations: [{ name: "仙台" }, { name: "奥新川" }, { name: "面白山高原" }, { name: "山寺" }, { name: "山形" }] },
  "tohoku:senseki": { area: "東北", lineName: "仙石線", scope: "仙台支社", stations: [{ name: "あおば通" }, { name: "仙台" }, { name: "本塩釜" }, { name: "松島海岸" }, { name: "高城町" }, { name: "石巻" }] },
  "tohoku:senseki_tohoku": { area: "東北", lineName: "仙石東北ライン", scope: "仙台支社", stations: [{ name: "仙台" }, { name: "塩釜" }, { name: "高城町" }, { name: "石巻" }] },
  "tohoku:tohoku_main": { area: "東北", lineName: "東北本線", scope: "盛岡支社", stations: [{ name: "仙台" }, { name: "松島" }, { name: "小牛田" }, { name: "一ノ関" }, { name: "北上" }, { name: "花巻" }, { name: "盛岡" }] },
  "tohoku:banetsu_west": { area: "東北", lineName: "磐越西線", scope: "会津側", stations: [{ name: "郡山" }, { name: "磐梯熱海" }, { name: "猪苗代" }, { name: "会津若松" }, { name: "野沢" }, { name: "日出谷" }, { name: "荻野" }] },
  "tohoku:aterazawa": { area: "東北", lineName: "左沢線", scope: "山形支社", stations: [{ name: "山形" }, { name: "寒河江" }, { name: "左沢" }] },
  "tohoku:ishinomaki": { area: "東北", lineName: "石巻線", scope: "仙台支社", stations: [{ name: "小牛田" }, { name: "前谷地" }, { name: "石巻" }, { name: "女川" }] },
  "tohoku:ofunato": { area: "東北", lineName: "大船渡線", scope: "盛岡支社", stations: [{ name: "一ノ関" }, { name: "気仙沼" }, { name: "盛" }] },
  "tohoku:ofunato_brt": { area: "東北", lineName: "大船渡線ＢＲＴ", scope: "BRT", stations: [{ name: "気仙沼" }, { name: "陸前高田" }, { name: "盛" }] },
  "tohoku:omminato": { area: "東北", lineName: "大湊線", scope: "盛岡支社", stations: [{ name: "野辺地" }, { name: "下北" }, { name: "大湊" }] },
  "tohoku:oga": { area: "東北", lineName: "男鹿線", scope: "秋田支社", stations: [{ name: "秋田" }, { name: "追分" }, { name: "男鹿" }] },
  "tohoku:kamaishi": { area: "東北", lineName: "釜石線", scope: "盛岡支社", stations: [{ name: "花巻" }, { name: "遠野" }, { name: "釜石" }] },
  "tohoku:kitakami": { area: "東北", lineName: "北上線", scope: "盛岡支社", stations: [{ name: "北上" }, { name: "ほっとゆだ" }, { name: "横手" }] },
  "tohoku:kesennuma": { area: "東北", lineName: "気仙沼線", scope: "仙台支社", stations: [{ name: "小牛田" }, { name: "前谷地" }, { name: "柳津" }, { name: "気仙沼" }] },
  "tohoku:kesennuma_brt": { area: "東北", lineName: "気仙沼線ＢＲＴ", scope: "BRT", stations: [{ name: "柳津" }, { name: "陸前戸倉" }, { name: "清水浜" }, { name: "歌津" }, { name: "気仙沼" }] },
  "tohoku:gono": { area: "東北", lineName: "五能線", scope: "秋田支社", stations: [{ name: "能代" }, { name: "東能代" }, { name: "深浦" }, { name: "鰺ケ沢" }, { name: "五所川原" }, { name: "陸奥鶴田" }, { name: "弘前" }] },
  "tohoku:suigun": { area: "東北", lineName: "水郡線", scope: "水戸支社", stations: [{ name: "水戸" }, { name: "常陸大子" }, { name: "郡山" }] },
  "tohoku:tazawako": { area: "東北", lineName: "田沢湖線", scope: "秋田支社", stations: [{ name: "盛岡" }, { name: "雫石" }, { name: "田沢湖" }, { name: "角館" }, { name: "大曲" }] },
  "tohoku:tadami": { area: "東北", lineName: "只見線", scope: "東北本部", stations: [{ name: "会津若松" }, { name: "会津坂下" }, { name: "会津川口" }, { name: "只見" }, { name: "大白川" }, { name: "小出" }] },
  "tohoku:tsugaru": { area: "東北", lineName: "津軽線", scope: "盛岡支社", stations: [{ name: "青森" }, { name: "蟹田" }, { name: "三厩" }] },
  "tohoku:hachinohe": { area: "東北", lineName: "八戸線", scope: "盛岡支社", stations: [{ name: "八戸" }, { name: "鮫" }, { name: "久慈" }] },
  "tohoku:hanawa": { area: "東北", lineName: "花輪線", scope: "盛岡支社", stations: [{ name: "好摩" }, { name: "荒屋新町" }, { name: "鹿角花輪" }, { name: "大館" }] },
  "tohoku:banetsu_east": { area: "東北", lineName: "磐越東線", scope: "仙台支社", stations: [{ name: "いわき" }, { name: "小野新町" }, { name: "船引" }, { name: "郡山" }] },
  "tohoku:yamada": { area: "東北", lineName: "山田線", scope: "盛岡支社", stations: [{ name: "盛岡" }, { name: "茂市" }, { name: "宮古" }] },
  "tohoku:yonesaka": { area: "東北", lineName: "米坂線", scope: "山形支社", stations: [{ name: "坂町" }, { name: "小国" }, { name: "今泉" }, { name: "米沢" }] },
  "tohoku:rikuu_west": { area: "東北", lineName: "陸羽西線", scope: "山形支社", stations: [{ name: "新庄" }, { name: "余目" }] },
  "tohoku:rikuu_east": { area: "東北", lineName: "陸羽東線", scope: "仙台支社", stations: [{ name: "小牛田" }, { name: "古川" }, { name: "鳴子温泉" }, { name: "新庄" }] }
});
===== FILE: docs\MAKE_BUNDLE_GUIDE.md =====
# MAKE_BUNDLE Guide

## 概要
`tools/make_bundle.ps1` は、プロジェクトを 1 本の `bundle.txt` に連結します。

形式:

```text
===== FILE: relative\path\to\file.ext =====
<file body>
```

## 前提
- Windows PowerShell / PowerShell で実行
- 作業場所はリポジトリ直下

## 実行コマンド

```powershell
powershell -ExecutionPolicy Bypass -File tools\make_bundle.ps1
```

## 生成物
- `out\bundle.txt`
- `out\bundle_report.txt`

## オプション
- 出力先変更

```powershell
powershell -ExecutionPolicy Bypass -File tools\make_bundle.ps1 -OutFile bundle.txt -ReportFile bundle_report.txt
```

- 最大ファイルサイズ変更（MB）

```powershell
powershell -ExecutionPolicy Bypass -File tools\make_bundle.ps1 -MaxFileSizeMB 10
```

- 対象を限定（サンプル検証用）

```powershell
powershell -ExecutionPolicy Bypass -File tools\make_bundle.ps1 -IncludePaths @("README.md","SPEC.md","station_metadata\line_yamanote.js")
```

## 既定の除外
- ディレクトリ:
  - `.git\`
  - `.venv\`, `venv\`
  - `__pycache__\`
  - `node_modules\`
  - `dist\`, `build\`, `out\`, `.pytest_cache\`
- ファイル:
  - `*.pyc`, `*.log`, `*.tmp`
  - `.env`（`.env.example` は対象）

## 注意
- `bundle.txt` 内でヘッダ行 `===== FILE: ... =====` は予約です。
- バイナリ判定（NUL 含有）やサイズ上限に引っかかったファイルはスキップされ、`bundle_report.txt` に記録されます。

===== FILE: docs\RESTORE_GUIDE.md =====
# RESTORE Guide (Excel Macro)

## 目的
制限PCで `bundle.txt` からファイルを自動復元します。

## 使うもの
- メモ帳
- Excel（マクロ有効）
- `excel_macro\RestoreFromBundle.bas`

## 手順
1. ブラウザで `bundle.txt` を開いて `Ctrl + A` → `Ctrl + C`。
2. 制限PCでメモ帳を開き、貼り付け。
3. Excelファイルを保存したいフォルダに `bundle.txt` として保存（UTF-8推奨）。
4. Excelを開く。
5. `Alt + F11` → VBAエディタ。
6. `ファイル` → `ファイルのインポート` から `RestoreFromBundle.bas` を読み込み。
7. `RestoreFilesFromBundle` を実行。

## 復元先
- `<Excelファイルと同じフォルダ>\restored\`

## 仕様
- `bundle.txt` のヘッダ行:
  - `===== FILE: relative\path\to\file.ext =====`
- 既存ファイルは上書き。
- フォルダ階層は自動作成。
- UTF-8（BOMあり/なし）対応。
- 改行は CRLF/LF 混在でも読込可能。

## エラー時
- ダイアログに「どのファイルで失敗したか」を含めて表示します。
- よくある原因:
  - `bundle.txt` がExcelと同じフォルダにない
  - 相対パスに不正文字（`:`, `..`）が含まれる
  - 書き込み権限不足

===== FILE: excel_macro\RestoreFromBundle.bas =====
Attribute VB_Name = "RestoreFromBundle"
Option Explicit

' Restores files from bundle.txt placed next to this workbook.
' Output directory: <workbook folder>\restored\
' Overwrite policy: overwrite existing files.

Public Sub RestoreFilesFromBundle()
    On Error GoTo EH

    Dim baseDir As String
    Dim bundlePath As String
    Dim outRoot As String
    Dim content As String

    baseDir = ThisWorkbook.Path
    If Len(baseDir) = 0 Then
        MsgBox "先にExcelファイルを保存してください。", vbExclamation
        Exit Sub
    End If

    bundlePath = baseDir & "\bundle.txt"
    outRoot = baseDir & "\restored"

    If Dir(bundlePath) = "" Then
        MsgBox "bundle.txt が見つかりません: " & bundlePath, vbExclamation
        Exit Sub
    End If

    EnsureFolderExists outRoot
    content = ReadUtf8Text(bundlePath)
    content = NormalizeNewlines(RemoveUtf8Bom(content))

    ParseAndRestore content, outRoot

    MsgBox "復元完了: " & outRoot, vbInformation
    Exit Sub

EH:
    MsgBox "復元エラー: " & Err.Description, vbCritical
End Sub

Private Sub ParseAndRestore(ByVal bundleText As String, ByVal outRoot As String)
    Dim lines() As String
    Dim i As Long
    Dim line As String
    Dim currentPath As String
    Dim currentBody As String
    Dim inFile As Boolean

    lines = Split(bundleText, vbLf)
    inFile = False
    currentPath = ""
    currentBody = ""

    For i = LBound(lines) To UBound(lines)
        line = lines(i)
        If IsHeaderLine(line) Then
            If inFile Then
                WriteOneFile outRoot, currentPath, currentBody
            End If
            currentPath = ExtractPathFromHeader(line)
            currentBody = ""
            inFile = True
        Else
            If inFile Then
                If Len(currentBody) = 0 Then
                    currentBody = line
                Else
                    currentBody = currentBody & vbLf & line
                End If
            End If
        End If
    Next i

    If inFile Then
        WriteOneFile outRoot, currentPath, currentBody
    End If
End Sub

Private Function IsHeaderLine(ByVal s As String) As Boolean
    Dim t As String
    t = Trim$(s)
    If Left$(t, 11) <> "===== FILE:" Then
        IsHeaderLine = False
        Exit Function
    End If
    If Right$(t, 5) <> "=====" Then
        IsHeaderLine = False
        Exit Function
    End If
    If Len(ExtractPathFromHeader(t)) = 0 Then
        IsHeaderLine = False
        Exit Function
    End If
    IsHeaderLine = True
End Function

Private Function ExtractPathFromHeader(ByVal headerLine As String) As String
    Dim t As String
    Dim body As String
    t = Trim$(headerLine)
    If Left$(t, 11) <> "===== FILE:" Then Exit Function
    If Right$(t, 5) <> "=====" Then Exit Function

    body = Mid$(t, 12, Len(t) - 16) ' remove prefix and suffix
    body = Trim$(body)
    ExtractPathFromHeader = Replace(body, "/", "\")
End Function

Private Sub WriteOneFile(ByVal outRoot As String, ByVal relPath As String, ByVal fileBodyLf As String)
    On Error GoTo EH

    Dim safeRel As String
    Dim fullPath As String
    Dim parentDir As String
    Dim textOut As String

    safeRel = SanitizeRelPath(relPath)
    If Len(safeRel) = 0 Then
        Err.Raise vbObjectError + 200, , "不正な相対パス: " & relPath
    End If

    fullPath = outRoot & "\" & safeRel
    parentDir = Left$(fullPath, InStrRev(fullPath, "\") - 1)
    EnsureFolderExists parentDir

    ' WriteText uses vbCrLf for line breaks in Windows editors.
    textOut = Replace(fileBodyLf, vbLf, vbCrLf)
    WriteUtf8Text fullPath, textOut
    Exit Sub

EH:
    Err.Raise vbObjectError + 201, , "書き込み失敗: " & relPath & " / " & Err.Description
End Sub

Private Function SanitizeRelPath(ByVal relPath As String) As String
    Dim p As String
    p = Replace(relPath, "/", "\")
    p = Trim$(p)
    Do While Left$(p, 1) = "\"
        p = Mid$(p, 2)
    Loop
    If InStr(p, ":") > 0 Then p = ""
    If InStr(p, "..\") > 0 Or Right$(p, 2) = ".." Then p = ""
    SanitizeRelPath = p
End Function

Private Sub EnsureFolderExists(ByVal folderPath As String)
    Dim parts() As String
    Dim i As Long
    Dim cur As String

    If Len(folderPath) = 0 Then Exit Sub

    parts = Split(folderPath, "\")
    If UBound(parts) < 0 Then Exit Sub

    cur = parts(0)
    If InStr(cur, ":") = 0 Then
        cur = ""
    End If

    For i = 1 To UBound(parts)
        If Len(cur) = 0 Then
            cur = parts(i)
        Else
            cur = cur & "\" & parts(i)
        End If
        If Len(cur) > 0 Then
            If Dir(cur, vbDirectory) = "" Then MkDir cur
        End If
    Next i
End Sub

Private Function ReadUtf8Text(ByVal filePath As String) As String
    Dim stm As Object
    Set stm = CreateObject("ADODB.Stream")

    stm.Type = 2 ' text
    stm.Charset = "utf-8"
    stm.Open
    stm.LoadFromFile filePath
    ReadUtf8Text = stm.ReadText(-1)
    stm.Close
End Function

Private Sub WriteUtf8Text(ByVal filePath As String, ByVal body As String)
    Dim stm As Object
    Set stm = CreateObject("ADODB.Stream")

    stm.Type = 2 ' text
    stm.Charset = "utf-8"
    stm.Open
    stm.WriteText body
    stm.SaveToFile filePath, 2 ' overwrite
    stm.Close
End Sub

Private Function RemoveUtf8Bom(ByVal s As String) As String
    If Len(s) > 0 Then
        If AscW(Left$(s, 1)) = &HFEFF Then
            RemoveUtf8Bom = Mid$(s, 2)
            Exit Function
        End If
    End If
    RemoveUtf8Bom = s
End Function

Private Function NormalizeNewlines(ByVal s As String) As String
    s = Replace(s, vbCrLf, vbLf)
    s = Replace(s, vbCr, vbLf)
    NormalizeNewlines = s
End Function

===== FILE: railway_lines.js =====
// アプリ本体（file:// で動作。fetch不要）
// 路線データは data_*.js から読み込む。
function normalizeStationMetaKey(name) {
  return String(name || "")
    .replace(/\s+/g, "")
    .replace(/駅$/g, "");
}

function getStationMetadataByName(name) {
  const root = window.stationMetadata || {};
  const key = normalizeStationMetaKey(name);
  return root[key] || root[String(name || "")] || null;
}

function mergeInterchanges(primaryList, fallbackList) {
  const out = [];
  const seen = {};

  function pushAll(list) {
    (Array.isArray(list) ? list : []).forEach(function (it) {
      const op = String((it && it.toOperator) || "");
      const line = String((it && it.toLine) || "");
      const st = String((it && it.toStationName) || "");
      const key = [op, line, st].join("|");
      if (!key || seen[key]) {
        return;
      }
      seen[key] = true;
      out.push({ toOperator: op, toLine: line, toStationName: st });
    });
  }

  pushAll(primaryList);
  pushAll(fallbackList);
  return out;
}

function normalizeLegacyLine(line) {
  const stations = Array.isArray(line && line.stations) ? line.stations : [];
  return {
    area: (line && line.area) || "未分類",
    lineName: (line && line.lineName) || "名称未設定",
    lineNameKana: (line && line.lineNameKana) || "",
    scope: (line && line.scope) || "",
    stations: stations.map(function (st) {
      const stationName = st && st.name ? String(st.name) : "駅名未設定";
      const meta = getStationMetadataByName(stationName) || {};
      const inlineInterchanges = Array.isArray(st && st.interchanges) ? st.interchanges : [];
      return {
        id: st && st.id ? String(st.id) : "",
        name: stationName,
        nameKana: st && (st.nameKana || st.kana) ? String(st.nameKana || st.kana) : String(meta.nameKana || ""),
        interchanges: mergeInterchanges(inlineInterchanges, meta.interchanges)
      };
    })
  };
}

function buildLineDataMap(railDataRoot, fallbackChunks) {
  const out = {};
  const fallback = fallbackChunks || {};
  Object.keys(fallback).forEach(function (lineId) {
    out[lineId] = normalizeLegacyLine(fallback[lineId]);
  });

  const lines = (railDataRoot && railDataRoot.lines) || {};
  const stations = (railDataRoot && railDataRoot.stations) || {};
  const interchanges = (railDataRoot && railDataRoot.interchanges) || {};

  Object.keys(lines).forEach(function (lineId) {
    const line = lines[lineId] || {};
    let mappedStations = [];

    if (Array.isArray(line.stationIds) && line.stationIds.length) {
      mappedStations = line.stationIds.map(function (stationId) {
        const s = stations[stationId] || {};
        const stationName = s.name || stationId;
        const meta = getStationMetadataByName(stationName) || {};
        return {
          id: stationId,
          name: stationName,
          nameKana: String(s.nameKana || s.kana || meta.nameKana || ""),
          interchanges: mergeInterchanges(
            Array.isArray(interchanges[stationId]) ? interchanges[stationId] : [],
            meta.interchanges
          )
        };
      });
    } else if (Array.isArray(line.stations)) {
      mappedStations = line.stations.map(function (st) {
        const sid = st && st.id ? String(st.id) : "";
        const stationName = st && st.name ? String(st.name) : "駅名未設定";
        const meta = getStationMetadataByName(stationName) || {};
        const inlineInterchanges = sid && Array.isArray(interchanges[sid])
          ? interchanges[sid]
          : (Array.isArray(st && st.interchanges) ? st.interchanges : []);
        return {
          id: sid,
          name: stationName,
          nameKana: st && (st.nameKana || st.kana) ? String(st.nameKana || st.kana) : String(meta.nameKana || ""),
          interchanges: mergeInterchanges(inlineInterchanges, meta.interchanges)
        };
      });
    }

    out[lineId] = {
      area: line.area || "未分類",
      lineName: line.lineName || lineId,
      lineNameKana: line.lineNameKana || "",
      scope: line.scope || "",
      stations: mappedStations
    };
  });

  return out;
}

function buildDirectionLinesFromRailData(railDataRoot) {
  const groups = (railDataRoot && railDataRoot.groups) || {};
  const lines = (railDataRoot && railDataRoot.lines) || {};
  const out = {};

  Object.keys(groups).forEach(function (groupName) {
    const ids = Array.isArray(groups[groupName]) ? groups[groupName] : [];
    const names = [];
    ids.forEach(function (lineId) {
      const line = lines[lineId];
      const name = line && line.lineName;
      if (name && names.indexOf(name) === -1) {
        names.push(name);
      }
    });
    if (names.length) {
      out[groupName] = names;
    }
  });

  return out;
}

const railDataRoot = window.railData || {};
const directionLinesFromData = buildDirectionLinesFromRailData(railDataRoot);
const railwayLinesData = buildLineDataMap(railDataRoot, window.railwayLinesDataChunks || {});
(function () {
  const AREA_PRIORITY = ["関東", "東北", "信越"];

  const statusMeta = {
    normal: { label: "平常運転", badge: "b-normal" },
    delay: { label: "遅延", badge: "b-delay" },
    suspend: { label: "運転見合わせ", badge: "b-suspend" },
    stop: { label: "運休", badge: "b-stop" }
  };
  const ROUTE_SYMBOL_BY_LINE_NAME = {
    "山手線": "JY",
    "京浜東北線": "JK",
    "東海道線": "JT",
    "横須賀線": "JO",
    "南武線": "JN",
    "横浜線": "JH",
    "相模線": "JI",
    "湘南新宿ライン": "JS",
    "上野東京ライン": "JU",
    "宇都宮線": "JU",
    "高崎線": "JU",
    "埼京線": "JA",
    "川越線": "JA",
    "中央線快速電車": "JC",
    "中央・総武各駅停車": "JB",
    "総武快速線": "JO",
    "京葉線": "JE",
    "武蔵野線": "JM",
    "常磐線": "JJ",
    "常磐線快速電車": "JJ",
    "常磐線各駅停車": "JL",
    "東京モノレール線": "MO"
  };
  const ROUTE_COLOR_BY_SYMBOL = {
    "JY": "#9acd32",
    "JK": "#00b2e5",
    "JT": "#f68b1f",
    "JO": "#1f3a93",
    "JN": "#f4a300",
    "JH": "#7fbf3f",
    "JS": "#e95d0f",
    "JU": "#f68b1f",
    "JA": "#00ac9a",
    "JC": "#f15a22",
    "JB": "#ffd400",
    "JE": "#c2185b",
    "JM": "#e95d0f",
    "JJ": "#00b261",
    "JL": "#00a0e9"
  };
  const ROUTE_ICON_BY_SYMBOL = {
    "JY": "route_icons/ico_rosen_jy.svg",
    "MO": "route_icons/ico_rosen_mo.svg",
    "JE": "route_icons/ico_rosen_je.svg",
    "JL": "route_icons/ico_rosen_jl.svg",
    "JJ": "route_icons/ico_rosen_jj.svg",
    "JB": "route_icons/ico_rosen_jb.svg",
    "JC": "route_icons/ico_rosen_jc.svg",
    "JM": "route_icons/ico_rosen_jm.svg",
    "JA": "route_icons/ico_rosen_ja.svg",
    "JU": "route_icons/ico_rosen_ju.svg",
    "JI": "route_icons/ico_rosen_ji.svg",
    "JN": "route_icons/ico_rosen_jn.svg",
    "JK": "route_icons/ico_rosen_jk.svg",
    "JH": "route_icons/ico_rosen_jh.svg",
    "JO": "route_icons/ico_rosen_jo.svg",
    "JT": "route_icons/ico_rosen_jt.svg",
    "JS": "route_icons/ico_rosen_js.svg"
  };

  const STALE_MINUTES = 20;

  const DIRECTION_ORDER = [
    "all",
    "山手線",
    "直通サービス",
    "東海道方面",
    "東北・高崎方面",
    "中央方面",
    "常磐方面",
    "総武方面",
    "東京モノレール線",
    "東北方面",
    "信越方面",
    "在来線特急",
    "新幹線"
  ];

  const DIRECTION_LINES = {
    "山手線": ["山手線"],
    "直通サービス": ["上野東京ライン", "湘南新宿ライン", "相鉄線直通列車"],
    "東海道方面": ["東海道線", "京浜東北線", "横須賀線", "南武線", "横浜線", "伊東線", "相模線", "鶴見線"],
    "東北・高崎方面": ["宇都宮線", "高崎線", "京浜東北線", "埼京線", "川越線", "武蔵野線", "上越線", "信越本線", "吾妻線", "烏山線", "八高線", "日光線", "両毛線"],
    "中央方面": ["中央線快速電車", "中央・総武各駅停車", "中央本線", "武蔵野線", "五日市線", "青梅線", "八高線", "小海線"],
    "常磐方面": ["常磐線", "常磐線快速電車", "常磐線各駅停車", "水郡線", "水戸線"],
    "総武方面": ["総武快速線", "総武本線", "中央・総武各駅停車", "京葉線", "武蔵野線", "内房線", "鹿島線", "久留里線", "外房線", "東金線", "成田線"],
    "東京モノレール線": ["東京モノレール線"],
    "東北方面": ["羽越本線", "奥羽本線", "常磐線", "仙山線", "仙石線", "仙石東北ライン", "東北本線", "磐越西線", "左沢線", "石巻線", "大船渡線", "大船渡線ＢＲＴ", "大湊線", "男鹿線", "釜石線", "北上線", "気仙沼線", "気仙沼線ＢＲＴ", "五能線", "水郡線", "田沢湖線", "只見線", "津軽線", "八戸線", "花輪線", "磐越東線", "山田線", "米坂線", "陸羽西線", "陸羽東線"],
    "信越方面": ["羽越本線", "信越本線", "上越線", "篠ノ井線", "中央本線", "白新線", "磐越西線", "飯山線", "越後線", "大糸線", "小海線", "只見線", "弥彦線", "米坂線"],
    "在来線特急": ["成田エクスプレス", "ひたち・ときわ", "あずさ・かいじ・富士回遊", "しなの", "わかしお・さざなみ", "しおさい", "日光・きぬがわ", "草津・四万・あかぎ", "踊り子・湘南", "いなほ・しらゆき", "つがる", "サンライズ瀬戸・出雲", "臨時列車"],
    "新幹線": ["東北新幹線", "山形新幹線", "秋田新幹線", "上越新幹線", "北陸新幹線"]
  };

  Object.keys(directionLinesFromData).forEach(function (groupName) {
    DIRECTION_LINES[groupName] = directionLinesFromData[groupName];
    if (DIRECTION_ORDER.indexOf(groupName) === -1) {
      DIRECTION_ORDER.push(groupName);
    }
  });

  const lineNameIndex = buildLineNameIndex();
  const state = createInitialState();
  let selectedDirectionFilter = loadDirectionFilter();
  let selectedStation = loadSelectedStation();

  const ui = {
    rawText: document.getElementById("rawText"),
    parseBtn: document.getElementById("parseBtn"),
    clearBtn: document.getElementById("clearBtn"),
    parseResult: document.getElementById("parseResult"),
    cards: document.getElementById("cards"),
    directionFilters: document.getElementById("directionFilters"),
    manualLine: document.getElementById("manualLine"),
    manualStatus: document.getElementById("manualStatus"),
    manualDirection: document.getElementById("manualDirection"),
    manualSection: document.getElementById("manualSection"),
    manualCause: document.getElementById("manualCause"),
    manualResume: document.getElementById("manualResume"),
    manualApply: document.getElementById("manualApply"),
    debugForceSegments: document.getElementById("debugForceSegments"),
    stationDetail: document.getElementById("stationDetail")
  };

  init();

  function init() {
    refreshManualLineOptions();
    setupDirectionFilters();
    loadState();
    render();

    ui.parseBtn.addEventListener("click", handleParse);
    ui.clearBtn.addEventListener("click", function () {
      ui.rawText.value = "";
      ui.parseResult.textContent = "入力をクリアしました";
    });

    if (ui.debugForceSegments) {
      ui.debugForceSegments.checked = localStorage.getItem("debugForceSegments") === "1";
      ui.debugForceSegments.addEventListener("change", function () {
        try {
          localStorage.setItem("debugForceSegments", ui.debugForceSegments.checked ? "1" : "0");
        } catch (_) {}
        render();
      });
    }

    ui.manualApply.addEventListener("click", function () {
      const lineId = ui.manualLine.value;
      if (!lineId) {
        return;
      }

      ensureLine(lineId);
      const target = state[lineId];
      target.status = ui.manualStatus.value;
      const manualDir = directionByMode(ui.manualDirection.value, railwayLinesData[lineId].lineName);
      target.directionMode = manualDir.mode;
      target.directionUpLabel = manualDir.upLabel;
      target.directionDownLabel = manualDir.downLabel;
      target.section = ui.manualSection.value.trim();
      target.sectionRanges = rangesFromSectionText(target.section);
      target.cause = ui.manualCause.value.trim();
      target.resume = ui.manualResume.value.trim();
      target.updatedAt = nowLabel();
      target.isCleared = false;

      persistState();
      render();
      ui.parseResult.textContent = "手動設定を反映しました: " + displayName(lineId);
    });
  }

  function loadDirectionFilter() {
    try {
      const v = localStorage.getItem("directionFilter");
      if (v && (v === "all" || DIRECTION_ORDER.indexOf(v) !== -1)) {
        return v;
      }
    } catch (_) {}
    return "all";
  }

  function saveDirectionFilter(v) {
    try {
      localStorage.setItem("directionFilter", v);
    } catch (_) {}
  }

  function loadSelectedStation() {
    try {
      const raw = localStorage.getItem("selectedStationV1");
      if (!raw) {
        return null;
      }
      const parsed = JSON.parse(raw);
      if (!parsed || !parsed.key || !parsed.stationName) {
        return null;
      }
      return parsed;
    } catch (_) {
      return null;
    }
  }

  function saveSelectedStation() {
    try {
      if (!selectedStation) {
        localStorage.removeItem("selectedStationV1");
        return;
      }
      localStorage.setItem("selectedStationV1", JSON.stringify(selectedStation));
    } catch (_) {}
  }

  function makeStationKey(lineId, stationName) {
    return String(lineId || "") + "::" + normalizeStationToken(stationName);
  }

  function setSelectedStation(lineId, line, station) {
    const lineSafe = line || {};
    const stationSafe = station || {};
    selectedStation = {
      key: makeStationKey(lineId, stationSafe.name),
      lineId: lineId,
      lineName: lineSafe.lineName || "",
      lineScope: lineSafe.scope || "",
      lineArea: lineSafe.area || "",
      stationName: stationSafe.name || "",
      stationKana: detectStationKana(stationSafe),
      interchanges: cleanInterchanges(stationSafe.interchanges || [])
    };
    saveSelectedStation();
    render();
  }

  function cleanInterchanges(list) {
    const out = [];
    const seen = {};
    (Array.isArray(list) ? list : []).forEach(function (it) {
      const item = {
        toOperator: cleanText((it && it.toOperator) || ""),
        toLine: cleanText((it && it.toLine) || ""),
        toStationName: cleanText((it && it.toStationName) || "")
      };
      const key = [item.toOperator, item.toLine, item.toStationName].join("|");
      if (!key || seen[key]) {
        return;
      }
      seen[key] = true;
      out.push(item);
    });
    return out;
  }

  function setupDirectionFilters() {
    if (!ui.directionFilters) {
      return;
    }
    renderDirectionFilters();
    ui.directionFilters.addEventListener("click", function (ev) {
      const t = ev.target;
      if (!t || !t.classList || !t.classList.contains("dir-filter-btn")) {
        return;
      }
      const val = t.getAttribute("data-direction") || "all";
      selectedDirectionFilter = val;
      saveDirectionFilter(val);
      renderDirectionFilters();
      render();
    });
  }

  function renderDirectionFilters() {
    if (!ui.directionFilters) {
      return;
    }
    ui.directionFilters.innerHTML = "";
    DIRECTION_ORDER.forEach(function (dirName) {
      const b = document.createElement("button");
      b.type = "button";
      b.className = "dir-filter-btn" + (selectedDirectionFilter === dirName ? " active" : "");
      b.setAttribute("data-direction", dirName);
      b.textContent = dirName === "all" ? "すべて" : dirName;
      ui.directionFilters.appendChild(b);
    });
  }

  function lineMatchesDirection(lineName) {
    if (!selectedDirectionFilter || selectedDirectionFilter === "all") {
      return true;
    }
    const targets = DIRECTION_LINES[selectedDirectionFilter] || [];
    return targets.indexOf(lineName) !== -1;
  }

  function buildLineNameIndex() {
    const index = {};
    Object.keys(railwayLinesData).forEach(function (lineId) {
      const line = railwayLinesData[lineId];
      const names = [line.lineName];
      if (line.lineName.endsWith("線")) {
        names.push(line.lineName.replace(/線$/, ""));
      }

      names.forEach(function (name) {
        if (!index[name]) {
          index[name] = [];
        }
        if (index[name].indexOf(lineId) === -1) {
          index[name].push(lineId);
        }
      });
    });
    return index;
  }

  function refreshManualLineOptions() {
    const selected = ui.manualLine.value;
    ui.manualLine.innerHTML = "";

    Object.keys(railwayLinesData).forEach(function (lineId) {
      const opt = document.createElement("option");
      opt.value = lineId;
      opt.textContent = displayName(lineId);
      ui.manualLine.appendChild(opt);
    });

    if (selected && railwayLinesData[selected]) {
      ui.manualLine.value = selected;
    }
  }


  function formatLineTitle(line) {
    const rawName = (line && line.lineName) || "";
    const name = lineNameWithSymbol(rawName);
    const kana = (line && line.lineNameKana) || "";
    if (!name) {
      return "";
    }
    if (!kana) {
      return name;
    }
    return name + " （" + kana + "）";
  }

  function renderLineTitleNode(target, line) {
    if (!target) {
      return;
    }
    target.innerHTML = "";

    const rawName = (line && line.lineName) || "";
    const symbol = routeSymbolByLineName(rawName);
    if (symbol) {
      target.appendChild(createRouteSymbolNode(symbol));
    }

    const nameMain = document.createElement("span");
    nameMain.className = "line-name-main";
    const kana = (line && line.lineNameKana) || "";
    nameMain.textContent = rawName ? (rawName + (kana ? " （" + kana + "）" : "")) : "";
    target.appendChild(nameMain);
  }

  function displayName(lineId) {
    const line = railwayLinesData[lineId];
    if (!line) {
      return lineId;
    }
    const scope = line.scope ? " / " + line.scope : "";
    return "[" + line.area + "] " + lineNameWithSymbol(line.lineName) + scope;
  }

  function lineNameWithSymbol(lineName) {
    const name = String(lineName || "");
    const symbol = routeSymbolByLineName(name);
    if (!symbol || !name) {
      return name;
    }
    return symbol + " " + name;
  }

  function routeSymbolByLineName(lineName) {
    return ROUTE_SYMBOL_BY_LINE_NAME[String(lineName || "")] || "";
  }

  function routeColorBySymbol(symbol) {
    return ROUTE_COLOR_BY_SYMBOL[String(symbol || "")] || "#4f6a59";
  }

  function routeIconBySymbol(symbol) {
    return ROUTE_ICON_BY_SYMBOL[String(symbol || "")] || "";
  }

  function createRouteSymbolNode(symbol) {
    const iconPath = routeIconBySymbol(symbol);
    if (iconPath) {
      const img = document.createElement("img");
      img.className = "route-symbol-icon";
      img.src = iconPath;
      img.alt = symbol;
      img.loading = "lazy";
      return img;
    }
    const badge = document.createElement("span");
    badge.className = "route-symbol-badge";
    badge.style.backgroundColor = routeColorBySymbol(symbol);
    badge.textContent = symbol;
    return badge;
  }

  function createInitialState() {
    const s = {};
    Object.keys(railwayLinesData).forEach(function (lineId) {
      s[lineId] = defaultLineState();
    });
    return s;
  }

  function defaultLineState() {
    return {
      status: "normal",
      directionMode: "unknown",
      directionUpLabel: "上り",
      directionDownLabel: "下り",
      section: "",
      sectionRanges: [],
      cause: "",
      resume: "",
      sourceText: "",
      updatedAt: "",
      isCleared: false
    };
  }

  function ensureLine(lineId, area, lineName, scope) {
    if (!lineId) {
      return;
    }

    if (!railwayLinesData[lineId]) {
      railwayLinesData[lineId] = {
        area: area || "未分類",
        lineName: lineName || lineId,
        scope: scope || "",
        stations: []
      };
      // 新規動的路線も索引に追加
      const names = [railwayLinesData[lineId].lineName];
      if (railwayLinesData[lineId].lineName.endsWith("線")) {
        names.push(railwayLinesData[lineId].lineName.replace(/線$/, ""));
      }
      names.forEach(function (name) {
        if (!lineNameIndex[name]) {
          lineNameIndex[name] = [];
        }
        if (lineNameIndex[name].indexOf(lineId) === -1) {
          lineNameIndex[name].push(lineId);
        }
      });
      refreshManualLineOptions();
    setupDirectionFilters();
    }

    if (!state[lineId]) {
      state[lineId] = defaultLineState();
    }
  }

  function loadState() {
    try {
      const raw = localStorage.getItem("railwayStatusStateV3");
      if (!raw) {
        return;
      }
      const loaded = JSON.parse(raw);
      Object.keys(loaded).forEach(function (lineId) {
        if (!railwayLinesData[lineId]) {
          return;
        }
        ensureLine(lineId);
        state[lineId] = Object.assign({}, defaultLineState(), loaded[lineId]);
      });
    } catch (_) {
      // localStorage が使えない環境でも動作継続
    }
  }

  function persistState() {
    try {
      localStorage.setItem("railwayStatusStateV3", JSON.stringify(state));
    } catch (_) {
      // 無視
    }
  }

  function clearLineState(lineId) {
    ensureLine(lineId);
    state[lineId] = defaultLineState();
    state[lineId].isCleared = true;
    state[lineId].updatedAt = nowLabel();
  }

  function handleParse() {
    const text = normalize(ui.rawText.value);
    if (!text) {
      ui.parseResult.textContent = "本文が空です";
      return;
    }

    const parsed = parseNotice(text);
    const targetIds = uniq((parsed.lineIds && parsed.lineIds.length ? parsed.lineIds : [parsed.lineId]).filter(Boolean));
    if (!targetIds.length) {
      ui.parseResult.textContent = "路線名を特定できませんでした。本文に路線名を含めてください。";
      return;
    }

    const now = nowLabel();
    targetIds.forEach(function (lineId) {
      const line = railwayLinesData[lineId] || {};
      ensureLine(lineId, line.area || parsed.area, line.lineName || parsed.lineName, line.scope || parsed.scope);

      const target = state[lineId];
      target.status = parsed.status;
      target.directionMode = parsed.directionMode;
      target.directionUpLabel = parsed.directionUpLabel;
      target.directionDownLabel = parsed.directionDownLabel;
      target.section = parsed.section;
      target.sectionRanges = parsed.sectionRanges;
      target.cause = parsed.cause;
      target.resume = parsed.resume;
      target.sourceText = text;
      target.updatedAt = now;
      target.isCleared = false;
    });

    persistState();
    render();

    const affectedLines = targetIds.map(function (lineId) {
      const line = railwayLinesData[lineId] || {};
      return line.lineName
        ? (lineNameWithSymbol(line.lineName) + (line.scope ? "（" + line.scope + "）" : ""))
        : lineId;
    });

    const lines = [
      "路線: " + affectedLines.join(" / "),
      "状態: " + statusMeta[parsed.status].label,
      "方向: " + parsed.directionLabel,
      "区間: " + (parsed.section || "未抽出"),
      "原因: " + (parsed.cause || "未抽出"),
      "再開見込み: " + (parsed.resume || "未抽出")
    ];

    if (parsed.note) {
      lines.push("判定メモ: " + parsed.note);
    }

    ui.parseResult.textContent = lines.join("\n");
  }
  function parseNotice(text) {
    const sectionInfo = detectSection(text);
    const linePick = detectLineAndArea(text, sectionInfo.stationTokens);
    const directionInfo = detectDirection(text, linePick.lineName);
    const status = detectStatus(text);
    const sectionResolved = resolveOperationalSection(text, status, sectionInfo);
    const cause = detectCause(text);
    const resume = detectResume(text, status);

    return {
      lineId: linePick.lineId,
      lineIds: linePick.lineIds || (linePick.lineId ? [linePick.lineId] : []),
      lineName: linePick.lineName,
      area: linePick.area,
      scope: linePick.scope,
      note: linePick.note,
      status: status,
      directionMode: directionInfo.mode,
      directionUpLabel: directionInfo.upLabel,
      directionDownLabel: directionInfo.downLabel,
      directionLabel: directionInfo.display,
      section: sectionResolved.text,
      sectionRanges: sectionResolved.ranges,
      cause: cause,
      resume: resume
    };
  }
  function detectLineAndArea(text, stationTokens) {
    const lineName = detectLineName(text);
    const scopeHint = detectScopeHint(text, lineName);
    if (!lineName) {
      return { lineId: "", lineIds: [], lineName: "", area: "", scope: "", note: "" };
    }

    const candidates = lineNameIndex[lineName] || [];

    if (candidates.length === 0) {
      const dynamicId = "unknown:" + slug(lineName);
      return {
        lineId: dynamicId,
        lineIds: [dynamicId],
        lineName: lineName,
        area: "未分類",
        scope: scopeHint,
        note: "未登録路線のため未分類で作成"
      };
    }

    if (candidates.length === 1) {
      const id = candidates[0];
      return {
        lineId: id,
        lineIds: [id],
        lineName: railwayLinesData[id].lineName,
        area: railwayLinesData[id].area,
        scope: railwayLinesData[id].scope || "",
        note: ""
      };
    }

    const specialTargets = pickSpecialMultiTargets(lineName, text, candidates);
    if (specialTargets && specialTargets.length) {
      const first = specialTargets[0];
      const hasExplicitBranch = hasSpecialBranchHint(lineName, text);
      return {
        lineId: first,
        lineIds: specialTargets,
        lineName: railwayLinesData[first].lineName,
        area: railwayLinesData[first].area,
        scope: railwayLinesData[first].scope || "",
        note: hasExplicitBranch
          ? "系統キーワードで判定"
          : "系統特定不可のため同名系統すべてに反映"
      };
    }

    const resolved = resolveByStationsAndArea(text, stationTokens, scopeHint, candidates);
    resolved.lineIds = resolved.lineId ? [resolved.lineId] : [];
    return resolved;
  }

  function isSpecialMultiLine(lineName) {
    return lineName === "湘南新宿ライン" || lineName === "上野東京ライン";
  }

  function hasSpecialBranchHint(lineName, text) {
    if (!isSpecialMultiLine(lineName)) {
      return false;
    }
    return /(宇都宮線|宇都宮方面|高崎線|高崎方面)/.test(text);
  }

  function pickSpecialMultiTargets(lineName, text, candidates) {
    if (!isSpecialMultiLine(lineName)) {
      return null;
    }

    const hasUtsunomiya = /(宇都宮線|宇都宮方面)/.test(text);
    const hasTakasaki = /(高崎線|高崎方面)/.test(text);

    if (hasUtsunomiya && !hasTakasaki) {
      const onlyU = candidates.filter(function (lineId) {
        return (railwayLinesData[lineId].scope || "").indexOf("宇都宮") !== -1;
      });
      if (onlyU.length) {
        return onlyU;
      }
    }

    if (hasTakasaki && !hasUtsunomiya) {
      const onlyT = candidates.filter(function (lineId) {
        return (railwayLinesData[lineId].scope || "").indexOf("高崎") !== -1;
      });
      if (onlyT.length) {
        return onlyT;
      }
    }

    if (hasUtsunomiya && hasTakasaki) {
      const both = candidates.filter(function (lineId) {
        const scope = railwayLinesData[lineId].scope || "";
        return scope.indexOf("宇都宮") !== -1 || scope.indexOf("高崎") !== -1;
      });
      return both.length ? both : candidates.slice();
    }

    return candidates.slice();
  }
  function detectLineName(text) {
    const names = Object.keys(lineNameIndex).sort(function (a, b) {
      return b.length - a.length;
    });

    for (const name of names) {
      if (text.indexOf(name) !== -1) {
        return lineNameIndex[name] && lineNameIndex[name][0]
          ? railwayLinesData[lineNameIndex[name][0]].lineName
          : name;
      }
    }

    const m = text.match(/^([\u4E00-\u9FFF\u3040-\u30FFA-Za-z0-9々ヶ・\-]+(?:線|本線|各駅停車))/);
    return m ? m[1] : "";
  }

  function resolveByStationsAndArea(text, stationTokens, scopeHint, candidates) {
    const scored = candidates.map(function (lineId) {
      const stations = railwayLinesData[lineId].stations || [];
      const scope = railwayLinesData[lineId].scope || "";
      let score = 0;

      stationTokens.forEach(function (token) {
        if (hasStation(stations, token)) {
          score += 2;
        }
      });

      stations.forEach(function (st) {
        if (st.name && text.indexOf(st.name) !== -1) {
          score += 1;
        }
      });

      if (text.indexOf(railwayLinesData[lineId].area + "エリア") !== -1 || text.indexOf(railwayLinesData[lineId].area) !== -1) {
        score += 1;
      }
      if (scopeHint && scope && scope.indexOf(scopeHint) !== -1) {
        score += 3;
      }
      if (scope && text.indexOf(scope) !== -1) {
        score += 2;
      }

      return { lineId: lineId, score: score };
    });

    scored.sort(function (a, b) {
      if (b.score !== a.score) {
        return b.score - a.score;
      }
      const areaA = railwayLinesData[a.lineId].area;
      const areaB = railwayLinesData[b.lineId].area;
      return AREA_PRIORITY.indexOf(areaA) - AREA_PRIORITY.indexOf(areaB);
    });

    const top = scored[0];
    const second = scored[1];
    const ambiguous = second && top.score === second.score;

    return {
      lineId: top.lineId,
      lineName: railwayLinesData[top.lineId].lineName,
      area: railwayLinesData[top.lineId].area,
      scope: railwayLinesData[top.lineId].scope || "",
      note: ambiguous
        ? "同名路線が複数あるため駅名・管轄ヒント・優先順で判定（候補: " + candidates.map(displayName).join(" / ") + "）"
        : "同名路線を駅名/管轄ヒントで判定"
    };
  }

  function detectScopeHint(text, lineName) {
    if (!lineName) {
      return "";
    }
    const escaped = escapeRegExp(lineName);
    const m = text.match(new RegExp(escaped + "（([^）]+)）"));
    if (m) {
      return cleanText(m[1]);
    }
    return "";
  }

  function hasStation(stations, token) {
    for (const st of stations) {
      if (st.name === token) {
        return true;
      }
    }
    return false;
  }

  function detectStatus(text) {
    if (/(平常運転|平常通り|通常通り)/.test(text)) {
      return "normal";
    }
    if (/(運転を?見合わせ|見合せ|運転見合わせ)/.test(text)) {
      return "suspend";
    }
    if (/(運転を取りやめ|運休とな|運休します|区間運休|一部運休|直通運転.*中止|運転を中止)/.test(text)) {
      return "stop";
    }
    if (/(徐行運転|遅れ|遅延|ダイヤ乱れ|見込まれます)/.test(text)) {
      return "delay";
    }
    return "delay";
  }

  function detectDirection(text, lineName) {
    const lineUsesLoopTerms = /山手線/.test(lineName || "");
    const hasBoth = /(上下線|両方向|双方|上下とも|内回り・外回り|内回りと外回り|外回り・内回り)/.test(text);
    const hasUp = /(上り線|上り列車)/.test(text);
    const hasDown = /(下り線|下り列車)/.test(text);
    const hasInner = /(内回り)/.test(text);
    const hasOuter = /(外回り)/.test(text);

    if (lineUsesLoopTerms || hasInner || hasOuter) {
      const upLabel = "内回り";
      const downLabel = "外回り";
      if (hasBoth || (hasInner && hasOuter)) {
        return directionObj("both", upLabel, downLabel, "内回り/外回り");
      }
      if (hasInner) {
        return directionObj("up", upLabel, downLabel, "内回りのみ");
      }
      if (hasOuter) {
        return directionObj("down", upLabel, downLabel, "外回りのみ");
      }
      if (hasUp && hasDown) {
        return directionObj("both", upLabel, downLabel, "内回り/外回り");
      }
      if (hasUp) {
        return directionObj("up", upLabel, downLabel, "内回りのみ");
      }
      if (hasDown) {
        return directionObj("down", upLabel, downLabel, "外回りのみ");
      }
      return directionObj("unknown", upLabel, downLabel, "方向不明");
    }

    const upLabel = "上り";
    const downLabel = "下り";
    if (hasBoth || (hasUp && hasDown)) {
      return directionObj("both", upLabel, downLabel, "上下線");
    }
    if (hasUp) {
      return directionObj("up", upLabel, downLabel, "上りのみ");
    }
    if (hasDown) {
      return directionObj("down", upLabel, downLabel, "下りのみ");
    }
    return directionObj("unknown", upLabel, downLabel, "方向不明");
  }

  function detectSection(text) {
    const sections = [];
    const tokens = [];
    const ranges = [];

    const pairPatterns = [
      /([\u4E00-\u9FFF\u3040-\u30FFA-Za-z0-9々ヶ・]+)\s*[〜～\-－]\s*([\u4E00-\u9FFF\u3040-\u30FFA-Za-z0-9々ヶ・]+)駅?間/g,
      /([\u4E00-\u9FFF\u3040-\u30FFA-Za-z0-9々ヶ・]+)\s*[〜～\-－]\s*([\u4E00-\u9FFF\u3040-\u30FFA-Za-z0-9々ヶ・]+)間/g
    ];

    pairPatterns.forEach(function (p) {
      let m;
      while ((m = p.exec(text)) !== null) {
        const from = normalizeStationToken(cleanText(m[1]));
        const to = normalizeStationToken(cleanText(m[2]));
        sections.push(from + "〜" + to);
        tokens.push(from);
        tokens.push(to);
        ranges.push({ from: from, to: to });
      }
    });

    const uniqSections = uniq(sections);
    const uniqTokens = uniq(tokens);

    return {
      text: uniqSections.join(" / "),
      stationTokens: uniqTokens,
      ranges: ranges
    };
  }

  function resolveOperationalSection(text, status, sectionInfo) {
    const base = sectionInfo || { text: "", ranges: [] };
    const ranges = Array.isArray(base.ranges) ? base.ranges : [];

    if (status !== "suspend" && status !== "stop") {
      return {
        text: base.text || "",
        ranges: ranges
      };
    }

    const linked = detectOperationLinkedRanges(text);
    if (linked.length) {
      return {
        text: linked.map(function (r) {
          return r.from + "〜" + r.to;
        }).join(" / "),
        ranges: linked
      };
    }

    // 「A〜B駅間での〜の影響で、上下線で運転を見合わせ」のような文は
    // 原因発生箇所が抽出されるため、全線見合わせとして区間を空にする。
    if (isLikelyWholeLineSuspension(text)) {
      return { text: "", ranges: [] };
    }

    return {
      text: base.text || "",
      ranges: ranges
    };
  }

  function detectOperationLinkedRanges(text) {
    const out = [];
    const seen = {};
    const patterns = [
      /([\u4E00-\u9FFF\u3040-\u30FFA-Za-z0-9々ヶ・]+)\s*[〜～\-－]\s*([\u4E00-\u9FFF\u3040-\u30FFA-Za-z0-9々ヶ・]+)駅?間の[^。\n]*(運転を?見合わせ|運休|運転を取りやめ|運転を中止)/g,
      /([\u4E00-\u9FFF\u3040-\u30FFA-Za-z0-9々ヶ・]+)\s*[〜～\-－]\s*([\u4E00-\u9FFF\u3040-\u30FFA-Za-z0-9々ヶ・]+)駅?間で(?!の)[^。\n]*(運転を?見合わせ|運休|運転を取りやめ|運転を中止)/g
    ];

    patterns.forEach(function (p) {
      let m;
      while ((m = p.exec(text)) !== null) {
        const from = normalizeStationToken(cleanText(m[1]));
        const to = normalizeStationToken(cleanText(m[2]));
        const key = from + "|" + to;
        if (!from || !to || from === to || seen[key]) {
          continue;
        }
        seen[key] = true;
        out.push({ from: from, to: to });
      }
    });

    return out;
  }

  function isLikelyWholeLineSuspension(text) {
    if (/一部/.test(text)) {
      return false;
    }
    return /(上下線|全線|全区間)[^。\n]{0,24}(運転を?見合わせ|運休|運転を取りやめ|運転を中止)/.test(text);
  }

  function detectCause(text) {
    const patterns = [
      /([^。\n]+?)の影響で/,
      /([^。\n]+?)を行うため/,
      /([^。\n]+?)を防ぐため/,
      /([^。\n]+?)のため/,
      /([^。\n]+?)を踏まえ/,
      /([^。\n]+?)に伴う/,
      /([^。\n]+?)により/
    ];

    for (const p of patterns) {
      const m = text.match(p);
      if (!m) {
        continue;
      }
      const c = cleanupCausePhrase(m[1]);
      if (c) {
        return c;
      }
    }

    return "";
  }

  function cleanupCausePhrase(raw) {
    let s = String(raw || "");
    s = s.replace(/（[^）]*）/g, " ");
    s = s.split(/[、，,]/).pop() || s;

    // 「宇都宮線内での人身事故」のような前置きから主因部分だけを残す
    s = s.replace(/^.*?での\s*/, "");
    s = s.replace(/^.*?における\s*/, "");
    s = s.replace(/^.*?は\s*/, "");
    s = s.replace(/^.*?で\s*/, "");
    s = s.replace(/^の+/, "");

    return cleanText(s);
  }

  function detectResume(text, status) {
    if (/運転再開見込.*立っていません/.test(text) || /再開見込.*未定/.test(text)) {
      return "未定";
    }

    if (/運転再開の時期は改めてお知らせ/.test(text)) {
      return "時期未定（別途案内）";
    }

    const m1 = text.match(/運転再開(?:見込|見込み)?(?:は|を)?\s*([^。\n]+)/);
    if (m1) {
      return cleanText(m1[1]);
    }

    const m2 = text.match(/(?:再開予定|再開見込み)\s*[:：]?\s*([^。\n]+)/);
    if (m2) {
      return cleanText(m2[1]);
    }

    if (/当面の間/.test(text) && (status === "stop" || status === "suspend")) {
      return "当面の間";
    }

    return "";
  }

  function render() {
    const previousScrollByLine = captureStationScrollPositions();
    ui.cards.innerHTML = "";

    const orderedIds = Object.keys(railwayLinesData).sort(function (a, b) {
      const aArea = railwayLinesData[a].area;
      const bArea = railwayLinesData[b].area;

      if (aArea !== bArea) {
        return AREA_PRIORITY.indexOf(aArea) - AREA_PRIORITY.indexOf(bArea);
      }

      const byName = railwayLinesData[a].lineName.localeCompare(railwayLinesData[b].lineName, "ja");
      if (byName !== 0) {
        return byName;
      }
      return (railwayLinesData[a].scope || "").localeCompare((railwayLinesData[b].scope || ""), "ja");
    });

    const forceSegments = !!(ui.debugForceSegments && ui.debugForceSegments.checked);

    orderedIds.forEach(function (lineId) {
      ensureLine(lineId);

      const line = railwayLinesData[lineId];
      if (!lineMatchesDirection(line.lineName)) {
        return;
      }
      const s = state[lineId];
      const meta = statusMeta[s.status] || statusMeta.normal;

      const card = document.createElement("section");
      card.className = "card";

      const ageMin = getUpdatedAgeMinutes(s.updatedAt);
      const isStale = ageMin !== null && ageMin >= STALE_MINUTES;
      if (isStale) {
        card.classList.add("card-stale");
      }

      const head = document.createElement("div");
      head.className = "head";

      const headMain = document.createElement("div");
      headMain.className = "head-main";

      const title = document.createElement("div");
      title.className = "line-name";
      renderLineTitleNode(title, line);

      const areaChip = document.createElement("span");
      areaChip.className = "station";
      areaChip.textContent = line.area;
      const scopeChip = document.createElement("span");
      scopeChip.className = "station";
      scopeChip.textContent = line.scope || "管轄未設定";
      const badge = document.createElement("span");
      badge.className = "badge " + meta.badge;
      badge.textContent = meta.label;

      const readAt = document.createElement("span");
      readAt.className = "read-at";
      readAt.textContent = "データ読込時刻: " + (s.updatedAt || "未更新");

      headMain.appendChild(title);
      headMain.appendChild(areaChip);
      headMain.appendChild(scopeChip);
      headMain.appendChild(badge);
      headMain.appendChild(readAt);

      const headRight = document.createElement("div");
      headRight.className = "head-right";
      const clearBtn = document.createElement("button");
      clearBtn.type = "button";
      clearBtn.className = "btn-clear-card";
      clearBtn.textContent = "クリア";
      clearBtn.addEventListener("click", function () {
        clearLineState(lineId);
        persistState();
        render();
        ui.parseResult.textContent = "カードをクリアしました: " + displayName(lineId);
      });
      headRight.appendChild(clearBtn);

      head.appendChild(headMain);
      head.appendChild(headRight);

      const metaBlock = document.createElement("div");
      metaBlock.className = "meta";
      const sourceText = escapeHtml((s.sourceText || "---")).replace(/\n/g, "<br>");
      metaBlock.innerHTML = [
        "<div class=\"meta-grid\">",
        "  <div class=\"meta-main\">",
        "    <span class=\"direction-basis\">" + escapeHtml(directionBasisText(line.lineName)) + "</span><br>",
        "    方向: " + escapeHtml(displayDirectionForCard(s)) + "<br>",
        "    区間: " + escapeHtml(displayFieldForCard(s, s.section, "全線/未設定")) + "<br>",
        "    原因: " + escapeHtml(displayFieldForCard(s, s.cause, "未設定")) + "<br>",
        "    再開見込み: " + escapeHtml(displayFieldForCard(s, s.resume, "未設定")) + "<br>",
        (isStale ? "<span class=\"stale-alert\">データ読込から " + ageMin + " 分経過（再確認推奨）</span>" : ""),
        "  </div>",
        "  <div class=\"meta-source\">",
        "    <div class=\"meta-label\">解析した自然文</div>",
        "    <div class=\"meta-source-text\">" + sourceText + "</div>",
        "  </div>",
        "</div>"
      ].join("");

      const stations = document.createElement("div");
      stations.className = "stations";
      stations.setAttribute("data-line-id", lineId);
      const preservedScroll = previousScrollByLine[lineId];
      let loopForScrollRestore = false;

      if (!line.stations.length) {
        const note = document.createElement("span");
        note.className = "station";
        note.textContent = "駅データ未設定";
        stations.appendChild(note);
      } else {
        const isLoopLine = isLoopLineName(line.lineName);
        loopForScrollRestore = isLoopLine;
        const baseStations = line.stations;
        const loopDisplayLaps = isLoopLine ? 3 : 1;
        const displayStations = [];
        for (let lap = 0; lap < loopDisplayLaps; lap += 1) {
          baseStations.forEach(function (st, idx) {
            displayStations.push({
              station: st,
              baseIdx: idx,
              lap: lap
            });
          });
        }
        const ranges = Array.isArray(s.sectionRanges) && s.sectionRanges.length
          ? s.sectionRanges
          : rangesFromSectionText(s.section);
        const affectedMap = buildAffectedSegments(baseStations, ranges, isLoopLine);
        const wholeLineByStatus = (!ranges.length && !cleanText(s.section) && (s.status === "suspend" || s.status === "stop"));
        const segmentCount = isLoopLine ? baseStations.length : baseStations.length - 1;
        if (wholeLineByStatus) {
          for (let i = 0; i < segmentCount; i += 1) {
            affectedMap[i] = true;
          }
        }

        displayStations.forEach(function (entry, displayIdx) {
          const st = entry.station;
          const station = document.createElement("span");
          station.className = "station";
          if (isLoopLine) {
            station.setAttribute("data-loop-base-idx", String(entry.baseIdx));
            station.setAttribute("data-loop-lap", String(entry.lap));
          }

          const stationName = document.createElement("span");
          stationName.className = "station-name";
          stationName.textContent = st.name;
          station.appendChild(stationName);

          const interchangeLabels = collectInterchangeLabels(st);
          const stationKey = makeStationKey(lineId, st.name);
          const stationKana = detectStationKana(st);
          if (interchangeLabels.length) {
            station.classList.add("station-with-xfer");
          }
          if (selectedStation && selectedStation.key === stationKey) {
            station.classList.add("station-selected");
          }
          if (stationKana) {
            station.title = stationKana;
          }
          station.addEventListener("click", function () {
            setSelectedStation(lineId, line, st);
          });

          stations.appendChild(station);
          if (displayIdx < displayStations.length - 1) {
            const segment = document.createElement("span");
            segment.className = "segment";
            if (isLoopLine && entry.baseIdx === baseStations.length - 1) {
              segment.classList.add("segment-loop-close");
              segment.title = "環状接続: " + st.name + "→" + baseStations[0].name;
            }

            const topTrack = document.createElement("span");
            topTrack.className = "seg-track top";
            const bottomTrack = document.createElement("span");
            bottomTrack.className = "seg-track bottom";
            const affectedIdx = isLoopLine ? entry.baseIdx : displayIdx;

            if (affectedMap[affectedIdx]) {
              const statusClass = "status-" + normalizeStatus(s.status);
              const mode = s.directionMode || "unknown";
              applyTrackActivation(topTrack, bottomTrack, mode, statusClass);
              segment.title = directionDisplayFromState(s) + " に影響";
            } else if (forceSegments) {
              applyTrackActivation(topTrack, bottomTrack, "both", "status-delay");
              segment.title = "デバッグ強制表示";
            }

            segment.appendChild(topTrack);
            segment.appendChild(bottomTrack);
            stations.appendChild(segment);
          }
        });
      }

      card.appendChild(head);
      card.appendChild(metaBlock);
      card.appendChild(stations);
      ui.cards.appendChild(card);
      if (line.stations.length) {
        if (loopForScrollRestore) {
          setupPseudoInfiniteLoopScroll(stations, preservedScroll);
        } else if (typeof preservedScroll === "number" && preservedScroll >= 0) {
          stations.scrollLeft = preservedScroll;
        }
      }
    });

    renderSelectedStationPanel();
  }

  function captureStationScrollPositions() {
    const out = {};
    if (!ui.cards) {
      return out;
    }
    const lists = ui.cards.querySelectorAll(".stations[data-line-id]");
    lists.forEach(function (el) {
      const lineId = el.getAttribute("data-line-id");
      if (!lineId) {
        return;
      }
      out[lineId] = el.scrollLeft || 0;
    });
    return out;
  }

  function renderSelectedStationPanel() {
    if (!ui.stationDetail) {
      return;
    }
    ui.stationDetail.innerHTML = "";

    if (!selectedStation || !selectedStation.stationName) {
      const empty = document.createElement("p");
      empty.className = "station-detail-empty";
      empty.textContent = "駅を選択してください。";
      ui.stationDetail.appendChild(empty);
      return;
    }

    const head = document.createElement("div");
    head.className = "station-detail-head";

    const h3 = document.createElement("h3");
    h3.className = "station-detail-title";
    h3.textContent = selectedStation.stationName;
    head.appendChild(h3);

    const sub = document.createElement("div");
    sub.className = "station-detail-sub";

    const areaChip = document.createElement("span");
    areaChip.className = "station-detail-chip";
    areaChip.textContent = selectedStation.lineArea || "未分類";
    sub.appendChild(areaChip);

    const lineChip = document.createElement("span");
    lineChip.className = "station-detail-chip";
    lineChip.textContent = lineNameWithSymbol(selectedStation.lineName || "") || "路線未設定";
    sub.appendChild(lineChip);
    const symbol = routeSymbolByLineName(selectedStation.lineName || "");
    if (symbol) {
      sub.appendChild(createRouteSymbolNode(symbol));
    }

    if (selectedStation.lineScope) {
      const scopeChip = document.createElement("span");
      scopeChip.className = "station-detail-chip";
      scopeChip.textContent = selectedStation.lineScope;
      sub.appendChild(scopeChip);
    }
    head.appendChild(sub);
    ui.stationDetail.appendChild(head);

    const kanaBlock = document.createElement("div");
    kanaBlock.className = "station-detail-block";
    const kanaLabel = document.createElement("p");
    kanaLabel.className = "station-detail-label";
    kanaLabel.textContent = "駅名かな";
    const kanaValue = document.createElement("p");
    kanaValue.className = "station-detail-value";
    kanaValue.textContent = selectedStation.stationKana || "未登録";
    kanaBlock.appendChild(kanaLabel);
    kanaBlock.appendChild(kanaValue);
    ui.stationDetail.appendChild(kanaBlock);

    const xferBlock = document.createElement("div");
    xferBlock.className = "station-detail-block";
    const xferLabel = document.createElement("p");
    xferLabel.className = "station-detail-label";
    xferLabel.textContent = "乗換路線";
    xferBlock.appendChild(xferLabel);

    const list = cleanInterchanges(selectedStation.interchanges || []);
    if (!list.length) {
      const noXfer = document.createElement("p");
      noXfer.className = "station-detail-value";
      noXfer.textContent = "登録なし";
      xferBlock.appendChild(noXfer);
    } else {
      const ul = document.createElement("ul");
      ul.className = "station-xfer-list";
      list.forEach(function (it) {
        const li = document.createElement("li");
        li.className = "station-xfer-item";
        const parts = [];
        if (it.toOperator) {
          parts.push(it.toOperator);
        }
        if (it.toLine) {
          parts.push(it.toLine);
        }
        let text = parts.join(" ");
        if (!text) {
          text = "路線名未設定";
        }
        if (it.toStationName) {
          text += "（" + it.toStationName + "）";
        }
        li.textContent = text;
        ul.appendChild(li);
      });
      xferBlock.appendChild(ul);
    }
    ui.stationDetail.appendChild(xferBlock);
  }


  function directionBasisText(lineName) {
    if (isLoopLineName(lineName)) {
      return "方向基準: → 外回り / ← 内回り";
    }
    return "方向基準: → 下り / ← 上り";
  }

  function directionObj(mode, upLabel, downLabel, display) {
    return {
      mode: mode,
      upLabel: upLabel,
      downLabel: downLabel,
      display: display
    };
  }

  function directionByMode(mode, lineName) {
    const loop = isLoopLineName(lineName);
    const upLabel = loop ? "内回り" : "上り";
    const downLabel = loop ? "外回り" : "下り";
    if (mode === "both") {
      return directionObj("both", upLabel, downLabel, upLabel + "/" + downLabel);
    }
    if (mode === "up") {
      return directionObj("up", upLabel, downLabel, upLabel + "のみ");
    }
    if (mode === "down") {
      return directionObj("down", upLabel, downLabel, downLabel + "のみ");
    }
    return directionObj("unknown", upLabel, downLabel, "方向不明");
  }

  function displayDirectionForCard(s) {
    if (s && s.isCleared) {
      return "---";
    }
    return directionDisplayFromState(s);
  }

  function displayFieldForCard(s, value, fallback) {
    if (s && s.isCleared) {
      return "---";
    }
    return value || fallback;
  }

  function directionDisplayFromState(s) {
    if (!s) {
      return "方向不明";
    }
    if (s.directionMode === "both") {
      return (s.directionUpLabel || "上り") + "/" + (s.directionDownLabel || "下り");
    }
    if (s.directionMode === "up") {
      return (s.directionUpLabel || "上り") + "のみ";
    }
    if (s.directionMode === "down") {
      return (s.directionDownLabel || "下り") + "のみ";
    }
    return "方向不明";
  }

  function collectInterchangeLabels(station) {
    const list = Array.isArray(station && station.interchanges) ? station.interchanges : [];
    const labels = [];

    list.forEach(function (it) {
      const line = cleanText((it && it.toLine) || "");
      const op = cleanText((it && it.toOperator) || "");
      let label = line || cleanText((it && it.toStationName) || "");
      if (!label) {
        return;
      }
      if (op && label.indexOf(op) === -1) {
        label = op + " " + label;
      }
      if (labels.indexOf(label) === -1) {
        labels.push(label);
      }
    });

    return labels;
  }

  function detectStationKana(station) {
    const raw = cleanText((station && (station.nameKana || station.kana)) || "");
    if (raw) {
      return raw;
    }
    const name = cleanText(station && station.name);
    if (!name || !/^[\u3040-\u309F\u30A0-\u30FFー・\s]+$/.test(name)) {
      return "";
    }
    return katakanaToHiragana(name).replace(/\s+/g, "");
  }

  function katakanaToHiragana(input) {
    return String(input || "").replace(/[\u30A1-\u30F6]/g, function (ch) {
      return String.fromCharCode(ch.charCodeAt(0) - 0x60);
    });
  }

  function rangesFromSectionText(sectionText) {
    const ranges = [];
    String(sectionText || "").split("/").forEach(function (chunk) {
      const part = cleanText(chunk);
      if (!part) {
        return;
      }
      const m = part.match(/^(.+?)〜(.+)$/);
      if (m) {
        ranges.push({ from: cleanText(m[1]), to: cleanText(m[2]) });
      }
    });
    return ranges;
  }

  function isLoopLineName(lineName) {
    return /山手線/.test(lineName || "");
  }

  function setupPseudoInfiniteLoopScroll(stationsEl, preservedScrollLeft) {
    const anchors = stationsEl.querySelectorAll('.station[data-loop-base-idx="0"]');
    if (!anchors || anchors.length < 3) {
      return;
    }

    const a0 = anchors[0];
    const a1 = anchors[1];
    const lapWidth = a1.offsetLeft - a0.offsetLeft;
    if (!(lapWidth > 0)) {
      return;
    }

    if (typeof preservedScrollLeft === "number" && preservedScrollLeft >= 0) {
      stationsEl.scrollLeft = preservedScrollLeft;
    } else {
      stationsEl.scrollLeft = lapWidth;
    }
    let adjusting = false;

    stationsEl.addEventListener("scroll", function () {
      if (adjusting) {
        return;
      }
      const x = stationsEl.scrollLeft;
      if (x < lapWidth * 0.5) {
        adjusting = true;
        stationsEl.scrollLeft = x + lapWidth;
        adjusting = false;
        return;
      }
      if (x > lapWidth * 1.5) {
        adjusting = true;
        stationsEl.scrollLeft = x - lapWidth;
        adjusting = false;
      }
    });
  }

  function buildAffectedSegments(stations, ranges, isLoopLine) {
    const affected = {};
    const count = Array.isArray(stations) ? stations.length : 0;
    const loopEnabled = !!isLoopLine && count >= 2;

    (ranges || []).forEach(function (r) {
      const fromIdx = findStationIndex(stations, r.from);
      const toIdx = findStationIndex(stations, r.to);
      if (fromIdx < 0 || toIdx < 0 || fromIdx === toIdx) {
        return;
      }

      if (!loopEnabled) {
        const start = Math.min(fromIdx, toIdx);
        const end = Math.max(fromIdx, toIdx);
        for (let i = start; i < end; i += 1) {
          affected[i] = true;
        }
        return;
      }

      const forward = loopSegmentPath(count, fromIdx, toIdx, true);
      const backward = loopSegmentPath(count, fromIdx, toIdx, false);
      const chosen = forward.length <= backward.length ? forward : backward;
      chosen.forEach(function (idx) {
        affected[idx] = true;
      });
    });
    return affected;
  }

  function loopSegmentPath(stationCount, fromIdx, toIdx, forward) {
    const segments = [];
    let cur = fromIdx;
    while (cur !== toIdx) {
      if (forward) {
        segments.push(cur);
        cur = (cur + 1) % stationCount;
      } else {
        const prev = (cur - 1 + stationCount) % stationCount;
        segments.push(prev);
        cur = prev;
      }
    }
    return segments;
  }

  function findStationIndex(stations, stationName) {
    for (let i = 0; i < stations.length; i += 1) {
      if (normalizeStationToken(stations[i].name) === normalizeStationToken(stationName)) {
        return i;
      }
    }
    return -1;
  }

  function applyTrackActivation(topTrack, bottomTrack, mode, statusClass) {
    if (mode === "both") {
      activateTrack(topTrack, statusClass, "flow-left");
      activateTrack(bottomTrack, statusClass, "flow-right");
      return;
    }
    if (mode === "up") {
      activateTrack(topTrack, statusClass, "flow-left");
      return;
    }
    if (mode === "down") {
      activateTrack(bottomTrack, statusClass, "flow-right");
      return;
    }
    activateTrack(topTrack, statusClass, "flow-pulse");
    activateTrack(bottomTrack, statusClass, "flow-pulse");
  }

  function activateTrack(trackEl, statusClass, flowClass) {
    trackEl.classList.add("active");
    trackEl.classList.add(statusClass);
    trackEl.classList.add(flowClass);
  }

  function normalizeStatus(status) {
    if (status === "normal" || status === "delay" || status === "suspend" || status === "stop") {
      return status;
    }
    return "unknown";
  }

  function parseUpdatedAt(value) {
    const m = String(value || "").match(/^(\d{4})\/(\d{2})\/(\d{2})\s+(\d{2}):(\d{2}):(\d{2})$/);
    if (!m) {
      return null;
    }
    return new Date(Number(m[1]), Number(m[2]) - 1, Number(m[3]), Number(m[4]), Number(m[5]), Number(m[6]));
  }

  function getUpdatedAgeMinutes(updatedAt) {
    const d = parseUpdatedAt(updatedAt);
    if (!d || Number.isNaN(d.getTime())) {
      return null;
    }
    const diff = Date.now() - d.getTime();
    if (diff < 0) {
      return 0;
    }
    return Math.floor(diff / 60000);
  }

  function normalize(input) {
    return String(input || "")
      .replace(/\r\n/g, "\n")
      .replace(/\u3000/g, " ")
      .replace(/[‐‑‒–—―ー]/g, "-")
      .trim();
  }

  function normalizeStationToken(input) {
    return cleanText(input)
      .replace(/\s+/g, "")
      .replace(/駅$/g, "");
  }

  function cleanText(input) {
    return String(input || "")
      .replace(/^[、。\s]+|[、。\s]+$/g, "")
      .replace(/\s+/g, " ");
  }

  function nowLabel() {
    const d = new Date();
    const p = function (n) {
      return String(n).padStart(2, "0");
    };
    return d.getFullYear() + "/" + p(d.getMonth() + 1) + "/" + p(d.getDate()) + " " + p(d.getHours()) + ":" + p(d.getMinutes()) + ":" + p(d.getSeconds());
  }

  function uniq(items) {
    const out = [];
    items.forEach(function (x) {
      if (x && out.indexOf(x) === -1) {
        out.push(x);
      }
    });
    return out;
  }

  function slug(input) {
    return String(input || "").replace(/\s+/g, "_");
  }

  function escapeRegExp(str) {
    return String(str || "").replace(/[.*+?^${}()|[\]\\]/g, "\\$&");
  }

  function escapeHtml(str) {
    return String(str)
      .replace(/&/g, "&amp;")
      .replace(/</g, "&lt;")
      .replace(/>/g, "&gt;")
      .replace(/\"/g, "&quot;")
      .replace(/'/g, "&#39;");
  }
})();







































===== FILE: railway_status_map.html =====
<!doctype html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>鉄道運行状況マップ</title>
  <style>
    :root {
      --bg: #edf6f0;
      --panel: #ffffff;
      --line: #c7ddce;
      --text: #173424;
      --muted: #4f6a59;
      --ok: #008a4a;
      --warn: #9a6700;
      --stop: #b42318;
      --suspend: #7a1b17;
      --accent: #007f41;
      --accent-soft: #e5f5eb;
      --hero: #005d31;
      --hero2: #007a3d;
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      font-family: "Yu Gothic UI", "Yu Gothic", Meiryo, sans-serif;
      color: var(--text);
      background:
        radial-gradient(circle at 85% 0%, rgba(120, 194, 146, 0.34) 0%, rgba(120, 194, 146, 0) 34%),
        linear-gradient(180deg, #eef7f1 0%, var(--bg) 38%, #eef7f1 100%);
    }

    .hero {
      background:
        linear-gradient(135deg, var(--hero) 0%, var(--hero2) 75%),
        repeating-linear-gradient(90deg, rgba(255,255,255,0.03) 0, rgba(255,255,255,0.03) 2px, transparent 2px, transparent 10px);
      color: #effcf2;
      border-bottom: 1px solid rgba(255,255,255,0.14);
    }

    .hero-inner {
      max-width: 1560px;
      margin: 0 auto;
      padding: 24px 16px 20px;
      display: grid;
      gap: 16px;
    }

    .hero-top {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      align-items: center;
    }

    .chip {
      font-size: 12px;
      font-weight: 700;
      padding: 3px 10px;
      border-radius: 999px;
      background: rgba(255,255,255,0.14);
      border: 1px solid rgba(255,255,255,0.24);
      letter-spacing: 0.02em;
    }

    .hero h1 {
      margin: 0;
      font-size: 30px;
      line-height: 1.2;
      letter-spacing: 0.02em;
    }

    .hero p {
      margin: 0;
      color: #d4efde;
      line-height: 1.7;
      max-width: 860px;
      font-size: 14px;
    }

    .flow {
      margin-top: 2px;
      display: grid;
      gap: 10px;
      grid-template-columns: repeat(3, minmax(0, 1fr));
    }

    .flow-card {
      border: 1px solid rgba(255,255,255,0.22);
      background: rgba(255,255,255,0.08);
      border-radius: 10px;
      padding: 10px 12px;
      backdrop-filter: blur(1px);
    }

    .flow-card strong {
      display: block;
      font-size: 13px;
      margin-bottom: 3px;
      color: #f2fff6;
    }

    .flow-card span {
      font-size: 12px;
      color: #d4efde;
      line-height: 1.45;
      display: block;
    }

    .wrap {
      max-width: 1560px;
      margin: 0 auto;
      padding: 16px;
      display: grid;
      gap: 16px;
      grid-template-columns: 420px minmax(0, 1fr) 320px;
      grid-template-areas: "left main station";
    }

    .panel {
      background: var(--panel);
      border: 1px solid var(--line);
      border-radius: 12px;
      padding: 16px;
      box-shadow: 0 2px 12px rgba(0, 63, 31, 0.08);
      min-width: 0;
    }

    h2 { margin: 0 0 8px; font-size: 16px; }

    .hint {
      color: var(--muted);
      font-size: 12px;
      line-height: 1.6;
      margin: 0;
    }

    .primary-block {
      margin-top: 10px;
      border: 1px solid #b9dec6;
      background: linear-gradient(180deg, #f3fcf6 0%, #eaf7ef 100%);
      border-radius: 10px;
      padding: 10px;
    }

    textarea, select, input, button {
      width: 100%;
      border: 1px solid var(--line);
      border-radius: 8px;
      padding: 10px;
      font-size: 14px;
      font-family: inherit;
      background: #fff;
    }

    textarea {
      min-height: 170px;
      resize: vertical;
      line-height: 1.5;
      background: #fbfdff;
    }

    button {
      background: var(--accent);
      color: #fff;
      border-color: var(--accent);
      cursor: pointer;
      font-weight: 700;
    }

    button.secondary {
      background: #fff;
      color: var(--accent);
    }

    .stack { display: grid; gap: 8px; margin-top: 10px; }

    .result {
      font-size: 13px;
      padding: 10px;
      background: #f8fafc;
      border: 1px solid var(--line);
      border-radius: 8px;
      line-height: 1.5;
      white-space: pre-wrap;
    }

    .direction-filter-wrap {
      margin: 6px 0 12px;
      padding: 8px;
      border: 1px solid #d4e6da;
      border-radius: 10px;
      background: #f5fbf7;
    }

    .direction-filters {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      align-items: center;
    }

    .dir-filter-btn {
      width: auto;
      min-width: 84px;
      padding: 6px 10px;
      border: 1px solid #bfd7c8;
      border-radius: 999px;
      background: #ffffff;
      color: #1f4f34;
      font-size: 12px;
      font-weight: 700;
      cursor: pointer;
      line-height: 1;
    }

    .dir-filter-btn.active {
      border-color: var(--accent);
      background: var(--accent);
      color: #ffffff;
    }

    .sub-title {
      margin-top: 12px;
      font-size: 12px;
      color: var(--muted);
      font-weight: 700;
      letter-spacing: 0.02em;
    }

    .cards { display: grid; gap: 12px; min-width: 0; }
    .left-panel { grid-area: left; }
    .main-panel { grid-area: main; }
    .station-panel {
      grid-area: station;
      align-self: start;
      position: sticky;
      top: 12px;
      max-height: calc(100vh - 24px);
      overflow-y: auto;
    }

    .card {
      border: 1px solid var(--line);
      border-radius: 12px;
      background: #fff;
      padding: 12px;
      min-width: 0;
      overflow: hidden;
    }

    .card-stale {
      border-color: #f59e0b;
      box-shadow: 0 0 0 2px rgba(245, 158, 11, 0.18) inset;
    }

    .stale-alert {
      display: inline-block;
      margin-top: 2px;
      color: #b45309;
      font-weight: 700;
    }

        .head { display: flex; gap: 8px; align-items: flex-start; min-width: 0; }
    .head-main { display: flex; gap: 8px; align-items: center; flex-wrap: wrap; min-width: 0; }
    .head-right { margin-left: auto; display: flex; align-items: center; }

    .line-name {
      font-size: 18px;
      font-weight: 700;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      flex-wrap: wrap;
    }
    .route-symbol-badge {
      width: 28px;
      height: 28px;
      border-radius: 6px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      color: #ffffff;
      font-size: 11px;
      font-weight: 800;
      letter-spacing: 0.02em;
      box-shadow: inset 0 0 0 1px rgba(255,255,255,0.2);
      line-height: 1;
      flex: 0 0 auto;
    }
    .route-symbol-icon {
      width: 28px;
      height: 28px;
      display: inline-block;
      flex: 0 0 auto;
      object-fit: contain;
      image-rendering: -webkit-optimize-contrast;
    }
    .line-name-main {
      display: inline-block;
    }
    .badge {
      flex: 0 0 auto;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      min-width: 84px;
      font-size: 13px;
      line-height: 1.2;
      padding: 6px 10px;
      border-radius: 12px;
      color: #fff;
      font-weight: 700;
    }

    .read-at {
      font-size: 15px;
      font-weight: 700;
      color: var(--text);
      line-height: 1.2;
      white-space: nowrap;
    }

    .btn-clear-card {
      width: auto;
      min-width: 72px;
      padding: 6px 10px;
      border-radius: 8px;
      border: 1px solid #f1b8b8;
      background: #fff5f5;
      color: #9f1239;
      font-size: 12px;
      font-weight: 700;
      cursor: pointer;
      line-height: 1;
    }
    .btn-clear-card:hover {
      background: #ffe4e6;
      border-color: #e78e8e;
    }

    .b-normal { background: var(--ok); }
    .b-delay { background: var(--warn); }
    .b-suspend { background: var(--suspend); }
    .b-stop { background: var(--stop); }

    .meta {
      margin-top: 8px;
      font-size: 13px;
      color: #374151;
      line-height: 1.6;
    }

    .meta-grid {
      display: grid;
      grid-template-columns: minmax(260px, 380px) minmax(0, 1fr);
      gap: 10px;
      align-items: start;
    }
    .direction-basis {
      display: inline-block;
      font-weight: 700;
      color: #0f5b32;
      margin-bottom: 2px;
    }

    .meta-main {
      border: 1px solid #d6e4da;
      border-radius: 8px;
      background: #f5fbf7;
      padding: 8px 10px;
      font-size: 14px;
      line-height: 1.7;
    }

    .meta-source {
      border: 1px solid #d6e4da;
      border-radius: 8px;
      background: #ffffff;
      padding: 8px 10px;
      min-height: 100%;
    }

    .meta-label {
      font-size: 11px;
      color: #5f7467;
      font-weight: 700;
      letter-spacing: 0.02em;
      margin-bottom: 4px;
    }

    .meta-source-text {
      white-space: normal;
      word-break: break-word;
      line-height: 1.5;
      font-size: 12px;
      color: #2f4838;
      max-height: 120px;
      overflow-y: auto;
      padding-right: 2px;
    }

    .legend {
      margin-top: 8px;
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      align-items: center;
      font-size: 11px;
      color: var(--muted);
    }

    .legend-item {
      display: inline-flex;
      gap: 4px;
      align-items: center;
      border: 1px solid var(--line);
      border-radius: 999px;
      padding: 3px 8px;
      background: #f5fbf7;
    }

    .legend-mark {
      width: 20px;
      height: 6px;
      border-radius: 99px;
      border: 1px solid #c4d8cb;
      background: #dce9df;
    }
    .legend-mark.both {
      background: linear-gradient(to bottom, #d92d20 0 50%, #d92d20 50% 100%);
    }
    .legend-mark.up {
      background: linear-gradient(to bottom, #d92d20 0 50%, #c4d8cb 50% 100%);
    }
    .legend-mark.down {
      background: linear-gradient(to bottom, #c4d8cb 0 50%, #d92d20 50% 100%);
    }

    .stations {
      margin-top: 14px;
      display: flex;
      flex-wrap: nowrap;
      gap: 10px;
      align-items: center;
      width: 100%;
      max-width: 100%;
      min-width: 0;
      overflow-x: auto;
      overflow-y: hidden;
      padding: 10px 8px;
      border: 1px solid #d4e6da;
      border-radius: 10px;
      background: #f5fbf7;
      scrollbar-width: thin;
      scrollbar-color: #8fa799 #dfe8e1;
      contain: content;
    }

    .stations::-webkit-scrollbar {
      height: 8px;
    }
    .stations::-webkit-scrollbar-track {
      background: #dfe8e1;
      border-radius: 99px;
    }
    .stations::-webkit-scrollbar-thumb {
      background: #8fa799;
      border-radius: 99px;
    }

    .station {
      flex: 0 0 auto;
      display: inline-flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
      gap: 4px;
      font-size: 13px;
      font-weight: 600;
      border: 1px solid var(--line);
      border-radius: 12px;
      padding: 6px 10px;
      background: #ffffff;
      white-space: nowrap;
      min-width: 84px;
    }
    .stations .station {
      position: relative;
      cursor: pointer;
      transition: border-color 0.15s ease, box-shadow 0.15s ease, transform 0.15s ease;
    }
    .stations .station:hover {
      transform: translateY(-1px);
      border-color: #9cc8ac;
      box-shadow: 0 0 0 2px rgba(118, 174, 136, 0.18);
    }
    .stations .station.station-with-xfer {
      border-color: #1f8a53;
      box-shadow: inset 0 0 0 1px rgba(31, 138, 83, 0.16);
    }
    .stations .station.station-with-xfer::after {
      content: "";
      position: absolute;
      top: 5px;
      right: 6px;
      width: 6px;
      height: 6px;
      border-radius: 50%;
      background: #1f8a53;
    }
    .stations .station.station-selected {
      border-color: #0a6e3a;
      box-shadow: 0 0 0 2px rgba(10, 110, 58, 0.25);
    }

    .station-name {
      display: block;
      width: 100%;
      text-align: center;
      line-height: 1.2;
    }

    .station-xfers {
      display: inline-flex;
      gap: 4px;
      align-items: center;
      justify-content: center;
      flex-wrap: nowrap;
      min-height: 16px;
    }

    .xfer-badge {
      display: inline-block;
      font-size: 10px;
      line-height: 1;
      padding: 3px 6px;
      border-radius: 999px;
      border: 1px solid #bbf7d0;
      background: #f0fdf4;
      color: #166534;
      font-weight: 700;
      max-width: 140px;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .xfer-more {
      font-size: 10px;
      color: #475569;
      font-weight: 700;
    }
    .station-detail-empty {
      margin: 0;
      font-size: 13px;
      color: var(--muted);
      line-height: 1.7;
    }
    .station-detail-head {
      padding: 10px;
      border: 1px solid #d6e4da;
      border-radius: 10px;
      background: #f5fbf7;
    }
    .station-detail-title {
      margin: 0;
      font-size: 22px;
      line-height: 1.2;
    }
    .station-detail-sub {
      margin-top: 6px;
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      align-items: center;
    }
    .station-detail-chip {
      border: 1px solid #bfd7c8;
      border-radius: 999px;
      background: #ffffff;
      padding: 3px 9px;
      font-size: 12px;
      font-weight: 700;
      color: #1f4f34;
    }
    .station-detail-block {
      margin-top: 10px;
      border: 1px solid #d6e4da;
      border-radius: 10px;
      padding: 10px;
      background: #ffffff;
    }
    .station-detail-label {
      margin: 0 0 6px;
      font-size: 11px;
      color: #5f7467;
      font-weight: 700;
      letter-spacing: 0.02em;
    }
    .station-detail-value {
      margin: 0;
      font-size: 13px;
      color: #2f4838;
      line-height: 1.6;
    }
    .station-xfer-list {
      margin: 0;
      padding: 0;
      list-style: none;
      display: grid;
      gap: 6px;
    }
    .station-xfer-item {
      margin: 0;
      padding: 8px;
      border: 1px solid #d6e4da;
      border-radius: 8px;
      background: #f8fcf9;
      font-size: 12px;
      color: #2f4838;
      line-height: 1.5;
    }

    .segment {
      flex: 0 0 auto;
      width: 44px;
      display: inline-flex;
      flex-direction: column;
      gap: 2px;
    }
    .segment-loop-close {
      border: 1px dashed #9dbfaa;
      border-radius: 10px;
      padding: 2px;
      background: rgba(230, 245, 235, 0.7);
    }

    .seg-track {
      position: relative;
      overflow: hidden;
      height: 6px;
      border-radius: 99px;
      background: #c4d8cb;
      border: 1px solid #c4d8cb;
    }
    .seg-track.active { border-color: transparent; }
    .seg-track.active.status-normal { background: #008a4a; }
    .seg-track.active.status-delay { background: #ca8a04; }
    .seg-track.active.status-suspend { background: #9f1239; }
    .seg-track.active.status-stop { background: #b91c1c; }
    .seg-track.active.status-unknown { background: #f59e0b; }
    .seg-track.active::after {
      content: "";
      position: absolute;
      top: 0;
      bottom: 0;
      width: 55%;
      left: 0;
      opacity: 0.95;
      will-change: transform;
      background: linear-gradient(
        90deg,
        rgba(255,255,255,0.02) 0%,
        rgba(255,255,255,0.98) 45%,
        rgba(255,255,255,0.02) 100%
      );
      transform: translateX(-130%);
    }

    .seg-track.active.flow-right::before,
    .seg-track.active.flow-left::before {
      content: "";
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      width: 0;
      height: 0;
      z-index: 2;
      filter: drop-shadow(0 0 1px rgba(0,0,0,0.25));
    }

    .seg-track.active.flow-right::before {
      right: 2px;
      border-top: 4px solid transparent;
      border-bottom: 4px solid transparent;
      border-left: 6px solid rgba(255,255,255,0.95);
    }

    .seg-track.active.flow-left::before {
      left: 2px;
      border-top: 4px solid transparent;
      border-bottom: 4px solid transparent;
      border-right: 6px solid rgba(255,255,255,0.95);
    }

    .seg-track.flow-right::after {
      animation: sweepLinear 1.1s linear infinite;
    }

    .seg-track.flow-left::after {
      animation: sweepLinear 1.1s linear infinite reverse;
    }

    .seg-track.flow-pulse::after {
      width: 65%;
      animation: sweepPulse 1.2s ease-in-out infinite;
    }

    @keyframes sweepLinear {
      from { transform: translateX(-130%); }
      to { transform: translateX(210%); }
    }

    @keyframes sweepPulse {
      0% { opacity: 0.25; transform: translateX(-20%); }
      50% { opacity: 1; transform: translateX(25%); }
      100% { opacity: 0.25; transform: translateX(70%); }
    }

    @media (max-width: 1320px) {
      .wrap {
        grid-template-columns: 420px minmax(0, 1fr);
        grid-template-areas:
          "left main"
          "station station";
      }
      .station-panel {
        position: static;
        max-height: none;
      }
    }

    @media (max-width: 980px) {
      .flow { grid-template-columns: 1fr; }
      .wrap {
        grid-template-columns: 1fr;
        grid-template-areas:
          "left"
          "main"
          "station";
      }
      .hero h1 { font-size: 24px; }
      .meta-grid { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>
  <header class="hero">
    <div class="hero-inner">
      <div class="hero-top">
        <span class="chip">FILE:// 実行</span>
        <span class="chip">EDGE 対応</span>
        <span class="chip">インストール不要</span>
      </div>
      <h1>自然文から運行状況を即時反映</h1>
      <p>運行情報の文章を貼り付けるだけで、路線・区間・原因・再開見込みを自動抽出して路線カードへ反映します。手動入力は補助機能として利用できます。</p>
      <div class="flow">
        <div class="flow-card">
          <strong>1. 自然文入力</strong>
          <span>公式発表文をそのまま貼り付け</span>
        </div>
        <div class="flow-card">
          <strong>2. 解析して反映</strong>
          <span>路線・区間・状態を自動抽出</span>
        </div>
        <div class="flow-card">
          <strong>3. 必要時のみ手動補正</strong>
          <span>抜けた項目だけ最小修正</span>
        </div>
      </div>
    </div>
  </header>

  <div class="wrap">
    <aside class="panel left-panel">
      <h2>自然文入力（主機能）</h2>
      <p class="hint">例: 五能線は、五所川原～陸奥鶴田駅間での線路に支障物の影響で、鰺ケ沢～弘前駅間の上下線で運転を見合わせています。</p>

      <div class="primary-block">
        <textarea id="rawText" placeholder="ここに自然文を貼り付け"></textarea>
        <div class="stack">
          <button id="parseBtn">解析して反映</button>
          <button id="clearBtn" class="secondary">入力をクリア</button>
        </div>
      </div>

      <div id="parseResult" class="result" style="margin-top:10px;">待機中</div>
      <div class="legend">
        <span class="legend-item"><span class="legend-mark both"></span>上下/両方向</span>
        <span class="legend-item"><span class="legend-mark up"></span>上り/内回りのみ</span>
        <span class="legend-item"><span class="legend-mark down"></span>下り/外回りのみ</span>
        <span class="legend-item">色: 平常=緑 / 遅延=黄 / 見合わせ=濃赤 / 運休=赤</span>
      </div>
      <label class="hint" style="display:flex;align-items:center;gap:8px;margin-top:8px;">
        <input id="debugForceSegments" type="checkbox" style="width:auto;" />
        デバッグ: 全駅間ラインを強制表示（アニメ確認）
      </label>

      <div class="sub-title">手動設定（補助）</div>
      <div class="stack">
        <select id="manualLine"></select>
        <select id="manualStatus">
          <option value="normal">平常運転</option>
          <option value="delay">遅延</option>
          <option value="suspend">運転見合わせ</option>
          <option value="stop">運休</option>
        </select>
        <select id="manualDirection">
          <option value="both">上下/両方向</option>
          <option value="up">上り/内回りのみ</option>
          <option value="down">下り/外回りのみ</option>
          <option value="unknown">方向不明</option>
        </select>
        <input id="manualSection" placeholder="区間（例: 鰺ケ沢〜弘前）" />
        <input id="manualCause" placeholder="原因（例: 線路支障物）" />
        <input id="manualResume" placeholder="再開見込み（例: 未定）" />
        <button id="manualApply" class="secondary">手動で反映</button>
      </div>
    </aside>

    <main class="panel main-panel">
      <h2>路線一覧</h2>
      <div class="direction-filter-wrap">
        <div id="directionFilters" class="direction-filters"></div>
      </div>
      <div id="cards" class="cards"></div>
    </main>

    <aside class="panel station-panel">
      <h2>駅データ</h2>
      <p class="hint">路線図の駅をクリックすると詳細を表示します。乗換駅は枠色と右上ドットで示します。</p>
      <div id="stationDetail" style="margin-top:10px;">
        <p class="station-detail-empty">駅を選択してください。</p>
      </div>
    </aside>
  </div>

  <script src="data_kanto.js"></script>
<script src="data_tohoku.js"></script>
<script src="data_shinetsu.js"></script>
<script src="data_limited.js"></script>
<script src="data_shinkansen.js"></script>
<script src="sample_notices.js"></script>
<script src="station_metadata/line_yamanote.js"></script>
<script src="station_metadata/group_direct_service.js"></script>
<script src="station_metadata/line_chuo_rapid.js"></script>
<script src="station_metadata/lines/kanto_chuo_rapid.js"></script>
<script src="station_metadata/lines/kanto_chuo_sobu_local.js"></script>
<script src="station_metadata/lines/kanto_chuo_main.js"></script>
<script src="station_metadata/lines/kanto_itsukaichi.js"></script>
<script src="station_metadata/lines/kanto_ome.js"></script>
<script src="station_metadata/lines/kanto_koumi.js"></script>
<script src="station_metadata/lines/kanto_tokaido.js"></script>
<script src="station_metadata/lines/kanto_keihin_tohoku.js"></script>
<script src="station_metadata/lines/kanto_yokosuka.js"></script>
<script src="station_metadata/lines/kanto_nambu.js"></script>
<script src="station_metadata/lines/kanto_yokohama.js"></script>
<script src="station_metadata/lines/kanto_ito.js"></script>
<script src="station_metadata/lines/kanto_sagami.js"></script>
<script src="station_metadata/lines/kanto_tsurumi.js"></script>
<script src="station_metadata/lines/kanto_utsunomiya.js"></script>
<script src="station_metadata/lines/kanto_takasaki.js"></script>
<script src="station_metadata/lines/kanto_saikyo.js"></script>
<script src="station_metadata/lines/kanto_kawagoe.js"></script>
<script src="station_metadata/lines/kanto_musashino.js"></script>
<script src="station_metadata/lines/kanto_joetsu.js"></script>
<script src="station_metadata/lines/kanto_shinetsu_main.js"></script>
<script src="station_metadata/lines/kanto_agatsuma.js"></script>
<script src="station_metadata/lines/kanto_karasuyama.js"></script>
<script src="station_metadata/lines/kanto_hachiko.js"></script>
<script src="station_metadata/lines/kanto_nikko.js"></script>
<script src="station_metadata/lines/kanto_ryomo.js"></script>
<script src="station_metadata/lines/kanto_joban.js"></script>
<script src="station_metadata/lines/kanto_joban_rapid.js"></script>
<script src="station_metadata/lines/kanto_joban_local.js"></script>
<script src="station_metadata/lines/kanto_suigun.js"></script>
<script src="station_metadata/lines/kanto_mito.js"></script>
<script src="station_metadata/lines/kanto_sobu_rapid.js"></script>
<script src="station_metadata/lines/kanto_sobu_main.js"></script>
<script src="station_metadata/lines/kanto_keiyo.js"></script>
<script src="station_metadata/lines/kanto_uchibo.js"></script>
<script src="station_metadata/lines/kanto_kashima.js"></script>
<script src="station_metadata/lines/kanto_kururi.js"></script>
<script src="station_metadata/lines/kanto_sotobo.js"></script>
<script src="station_metadata/lines/kanto_togane.js"></script>
<script src="station_metadata/lines/kanto_narita.js"></script>
<script src="station_metadata/lines/kanto_monorail.js"></script>
<script src="station_metadata/lines/shinetsu_uetsu.js"></script>
<script src="station_metadata/lines/shinetsu_shinetsu_main.js"></script>
<script src="station_metadata/lines/shinetsu_joetsu.js"></script>
<script src="station_metadata/lines/shinetsu_shinonoi.js"></script>
<script src="station_metadata/lines/shinetsu_koshinetsu_chuo_main.js"></script>
<script src="station_metadata/lines/shinetsu_hakushin.js"></script>
<script src="station_metadata/lines/shinetsu_banetsu_west.js"></script>
<script src="station_metadata/lines/shinetsu_iiyama.js"></script>
<script src="station_metadata/lines/shinetsu_echigo.js"></script>
<script src="station_metadata/lines/shinetsu_oito.js"></script>
<script src="station_metadata/lines/shinetsu_koumi.js"></script>
<script src="station_metadata/lines/shinetsu_tadami.js"></script>
<script src="station_metadata/lines/shinetsu_yahiko.js"></script>
<script src="station_metadata/lines/shinetsu_yonesaka.js"></script>
<script src="station_metadata/lines/shinetsu_gono.js"></script>
<script src="station_metadata/line_sobu_joban.js"></script>
<script src="station_metadata/line_tohoku_shinetsu.js"></script>
<script src="station_metadata/lines/tohoku_tohoku_main.js"></script>
<script src="station_metadata/lines/tohoku_hachinohe.js"></script>
<script src="station_metadata/lines/tohoku_ou_main_aomori_akita.js"></script>
<script src="station_metadata/lines/tohoku_tsugaru.js"></script>
<script src="station_metadata/lines/tohoku_hanawa.js"></script>
<script src="station_metadata/lines/tohoku_omminato.js"></script>
<script src="station_metadata/lines/tohoku_kitakami.js"></script>
<script src="station_metadata/lines/tohoku_kamaishi.js"></script>
<script src="station_metadata/lines/tohoku_tazawako.js"></script>
<script src="station_metadata/lines/tohoku_senzan.js"></script>
<script src="station_metadata/lines/tohoku_senseki.js"></script>
<script src="station_metadata/lines/tohoku_senseki_tohoku.js"></script>
<script src="station_metadata/lines/tohoku_ishinomaki.js"></script>
<script src="station_metadata/lines/tohoku_kesennuma.js"></script>
<script src="station_metadata/lines/tohoku_kesennuma_brt.js"></script>
<script src="station_metadata/lines/tohoku_ofunato.js"></script>
<script src="station_metadata/lines/tohoku_ofunato_brt.js"></script>
<script src="station_metadata/lines/tohoku_yamada.js"></script>
<script src="station_metadata/lines/tohoku_gono.js"></script>
<script src="station_metadata/lines/tohoku_oga.js"></script>
<script src="station_metadata/lines/tohoku_uetsu_northern.js"></script>
<script src="station_metadata/lines/tohoku_rikuu_east.js"></script>
<script src="station_metadata/lines/tohoku_rikuu_west.js"></script>
<script src="station_metadata/lines/tohoku_yonesaka.js"></script>
<script src="station_metadata/lines/tohoku_banetsu_west.js"></script>
<script src="station_metadata/lines/tohoku_banetsu_east.js"></script>
<script src="station_metadata/lines/tohoku_aterazawa.js"></script>
<script src="station_metadata/lines/tohoku_tadami.js"></script>
<script src="station_metadata/lines/tohoku_suigun.js"></script>
<script src="station_metadata/lines/tohoku_joban.js"></script>
<script src="station_metadata.js"></script>
<script src="railway_lines.js"></script>
</body>
</html>


































===== FILE: README.md =====
# Railway Status Map

## Overview
- Local-only railway operation status viewer for strict environments.
- Runs with `file://` in Microsoft Edge.
- No install, no web server, no external CDN.
- Main workflow: natural language input -> parse -> auto-apply to line cards.

## Files
- `railway_status_map.html`: UI and styles.
- `railway_lines.js`: line master data + parser + rendering logic.

## Run
1. Put `railway_status_map.html` and `railway_lines.js` in the same folder.
2. Open `railway_status_map.html` in Edge (double-click is fine).

## Current Data Model
- Internal key: `area:line_key`
- Line record:
  - `area` (e.g. 関東 / 東北 / 信越)
  - `lineName`
  - `scope` (管轄・系統区分、同一エリア内分割に対応)
  - `stations` (ordered station list for segment visualization)

## Implemented Features
- Natural language parsing:
  - Line detection
  - Area/scope disambiguation (station match + scope hint)
  - Status detection (`normal`, `delay`, `suspend`, `stop`)
  - Section extraction (`A〜B`)
  - Cause/resume extraction
  - Direction detection (`both`, `up`, `down`, `unknown`)
- Manual override:
  - Line / status / direction / section / cause / resume
- Card view:
  - Area + scope chips
  - Station list
  - Intended segment highlight by affected section and direction

## Known Issue (Important)
- Segment animation/color on station links is currently **not visible in actual browser output** (reported during testing), despite CSS/JS implementation being present.
- This is the first item to debug in the next session.

## Next Session Quick Plan
1. Add temporary debug mode to force all segments active (`both + delay`) and verify rendering path.
2. If still invisible:
   - replace current segment CSS animation with simpler always-visible solid color first,
   - then reintroduce motion.
3. If CSS remains unreliable on target Edge:
   - switch segment rendering to SVG-based lines/arrows.

## Example Input (tested)
- `京浜東北線は、東十条～王子駅間での異音の確認の影響で、上下線の一部列車に遅れがでています。`

## Notes for Migration
- Copy this whole folder as-is to home PC.
- Open in Edge and continue editing these same two files.

## Bundle Export / Restore
- Create one-file bundle:
  - `powershell -ExecutionPolicy Bypass -File tools\make_bundle.ps1`
- Output:
  - `out\bundle.txt`
  - `out\bundle_report.txt`
- Excel restore macro:
  - `excel_macro\RestoreFromBundle.bas`
- Operation guides:
  - `docs\MAKE_BUNDLE_GUIDE.md`
  - `docs\RESTORE_GUIDE.md`
===== FILE: reports\station_completeness.md =====
# 駅データ完全性レポート

- 生成日時: 2026-02-22T05:38:18.897Z
- 対象路線数: 111

## 判定状態
- `station_master/full_line_stations.json` が未作成のため、全駅網羅判定は未実施です。
- まずは全路線の正規駅順を `full_line_stations.json` に投入してください。

## 現在の登録駅数一覧
- `kanto:agatsuma` 吾妻線（高崎支社）: 5駅
- `kanto:chuo_main` 中央本線（東京支社）: 6駅
- `kanto:chuo_rapid` 中央線快速電車（東京支社）: 14駅
- `kanto:chuo_sobu_local` 中央・総武各駅停車（東京支社）: 15駅
- `kanto:hachiko` 八高線（八王子支社）: 5駅
- `kanto:ito` 伊東線（横浜支社）: 6駅
- `kanto:itsukaichi` 五日市線（八王子支社）: 2駅
- `kanto:joban` 常磐線（水戸支社）: 19駅
- `kanto:joban_local` 常磐線各駅停車（東京支社）: 14駅
- `kanto:joban_rapid` 常磐線快速電車（東京支社）: 10駅
- `kanto:joetsu_kanto` 上越線（高崎支社）: 5駅
- `kanto:karasuyama` 烏山線（大宮支社）: 2駅
- `kanto:kashima` 鹿島線（千葉支社）: 4駅
- `kanto:kawagoe` 川越線（大宮支社）: 3駅
- `kanto:keihin_tohoku_local` 京浜東北線（東京支社）: 47駅
- `kanto:keiyo` 京葉線（千葉支社）: 7駅
- `kanto:koumi` 小海線（八王子支社）: 3駅
- `kanto:kururi` 久留里線（千葉支社）: 4駅
- `kanto:mito` 水戸線（水戸支社）: 3駅
- `kanto:monorail` 東京モノレール線（東京モノレール）: 6駅
- `kanto:musashino` 武蔵野線（関東本部）: 8駅
- `kanto:nambu` 南武線（横浜支社）: 26駅
- `kanto:narita` 成田線（千葉支社）: 4駅
- `kanto:nikko` 日光線（大宮支社）: 2駅
- `kanto:ome` 青梅線（八王子支社）: 4駅
- `kanto:ryomo` 両毛線（高崎支社）: 5駅
- `kanto:sagami` 相模線（横浜支社）: 18駅
- `kanto:saikyo` 埼京線（東京支社）: 8駅
- `kanto:shinetsu_kanto` 信越本線（高崎支社）: 4駅
- `kanto:shonan_shinjuku_takasaki` 湘南新宿ライン（高崎線系統）: 16駅
- `kanto:shonan_shinjuku_utsunomiya` 湘南新宿ライン（宇都宮線系統）: 15駅
- `kanto:sobu_main` 総武本線（千葉支社）: 5駅
- `kanto:sobu_rapid` 総武快速線（千葉支社）: 10駅
- `kanto:sotetsu_direct` 相鉄線直通列車（直通）: 3駅
- `kanto:sotobo` 外房線（千葉支社）: 10駅
- `kanto:suigun` 水郡線（水戸支社）: 3駅
- `kanto:takasaki` 高崎線（高崎支社）: 19駅
- `kanto:togane` 東金線（千葉支社）: 3駅
- `kanto:tokaido` 東海道線（横浜支社）: 21駅
- `kanto:tsurumi` 鶴見線（横浜支社）: 13駅
- `kanto:uchibo` 内房線（千葉支社）: 12駅
- `kanto:ueno_tokyo_takasaki` 上野東京ライン（高崎線系統）: 7駅
- `kanto:ueno_tokyo_utsunomiya` 上野東京ライン（宇都宮線系統）: 7駅
- `kanto:utsunomiya` 宇都宮線（大宮支社）: 15駅
- `kanto:yamanote` 山手線（東京支社）: 30駅
- `kanto:yokohama` 横浜線（八王子支社）: 20駅
- `kanto:yokosuka` 横須賀線（横浜支社）: 19駅
- `limited:azusa` あずさ・かいじ・富士回遊（特急）: 0駅
- `limited:extra` 臨時列車（特急）: 0駅
- `limited:hitachi` ひたち・ときわ（特急）: 0駅
- `limited:inaho` いなほ・しらゆき（特急）: 0駅
- `limited:kusatsu` 草津・四万・あかぎ（特急）: 0駅
- `limited:nex` 成田エクスプレス（特急）: 0駅
- `limited:nikko` 日光・きぬがわ（特急）: 0駅
- `limited:odoriko` 踊り子・湘南（特急）: 0駅
- `limited:shinano` しなの（特急）: 0駅
- `limited:shiosai` しおさい（特急）: 0駅
- `limited:sunrise` サンライズ瀬戸・出雲（特急）: 0駅
- `limited:tsugaru` つがる（特急）: 0駅
- `limited:wakashio` わかしお・さざなみ（特急）: 0駅
- `shinetsu:banetsu_west` 磐越西線（新潟支社）: 6駅
- `shinetsu:echigo` 越後線（新潟支社）: 4駅
- `shinetsu:gono` 五能線（能代方）: 5駅
- `shinetsu:hakushin` 白新線（新潟支社）: 3駅
- `shinetsu:iiyama` 飯山線（長野支社）: 7駅
- `shinetsu:joetsu` 上越線（高崎・越後湯沢側）: 6駅
- `shinetsu:koshinetsu_chuo_main` 中央本線（長野支社）: 6駅
- `shinetsu:koumi` 小海線（長野支社）: 4駅
- `shinetsu:oito` 大糸線（長野支社）: 4駅
- `shinetsu:shinetsu_main` 信越本線（新潟支社）: 8駅
- `shinetsu:shinonoi` 篠ノ井線（長野支社）: 4駅
- `shinetsu:tadami` 只見線（新潟支社）: 3駅
- `shinetsu:uetsu` 羽越本線（新潟支社）: 5駅
- `shinetsu:yahiko` 弥彦線（新潟支社）: 4駅
- `shinetsu:yonesaka` 米坂線（新潟支社）: 4駅
- `shinkansen:akita` 秋田新幹線（新幹線）: 3駅
- `shinkansen:hokuriku` 北陸新幹線（新幹線）: 3駅
- `shinkansen:joetsu` 上越新幹線（新幹線）: 4駅
- `shinkansen:tohoku` 東北新幹線（新幹線）: 5駅
- `shinkansen:yamagata` 山形新幹線（新幹線）: 3駅
- `tohoku:aterazawa` 左沢線（山形支社）: 3駅
- `tohoku:banetsu_east` 磐越東線（仙台支社）: 4駅
- `tohoku:banetsu_west` 磐越西線（会津側）: 7駅
- `tohoku:gono` 五能線（秋田支社）: 7駅
- `tohoku:hachinohe` 八戸線（盛岡支社）: 3駅
- `tohoku:hanawa` 花輪線（盛岡支社）: 4駅
- `tohoku:ishinomaki` 石巻線（仙台支社）: 4駅
- `tohoku:joban` 常磐線（仙台支社）: 6駅
- `tohoku:kamaishi` 釜石線（盛岡支社）: 3駅
- `tohoku:kesennuma` 気仙沼線（仙台支社）: 4駅
- `tohoku:kesennuma_brt` 気仙沼線ＢＲＴ（BRT）: 5駅
- `tohoku:kitakami` 北上線（盛岡支社）: 3駅
- `tohoku:ofunato` 大船渡線（盛岡支社）: 3駅
- `tohoku:ofunato_brt` 大船渡線ＢＲＴ（BRT）: 3駅
- `tohoku:oga` 男鹿線（秋田支社）: 3駅
- `tohoku:omminato` 大湊線（盛岡支社）: 3駅
- `tohoku:ou_main_aomori_akita` 奥羽本線（青森・秋田）: 5駅
- `tohoku:ou_main_yamagata` 奥羽本線（山形線）: 8駅
- `tohoku:rikuu_east` 陸羽東線（仙台支社）: 4駅
- `tohoku:rikuu_west` 陸羽西線（山形支社）: 2駅
- `tohoku:senseki` 仙石線（仙台支社）: 6駅
- `tohoku:senseki_tohoku` 仙石東北ライン（仙台支社）: 4駅
- `tohoku:senzan` 仙山線（仙台支社）: 5駅
- `tohoku:suigun` 水郡線（水戸支社）: 3駅
- `tohoku:tadami` 只見線（東北本部）: 6駅
- `tohoku:tazawako` 田沢湖線（秋田支社）: 5駅
- `tohoku:tohoku_main` 東北本線（盛岡支社）: 7駅
- `tohoku:tsugaru` 津軽線（盛岡支社）: 3駅
- `tohoku:uetsu_northern` 羽越本線（秋田・酒田側）: 4駅
- `tohoku:yamada` 山田線（盛岡支社）: 3駅
- `tohoku:yonesaka` 米坂線（山形支社）: 4駅
===== FILE: route_icons\ico_rosen_ja.svg =====
﻿<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 106 106"><defs><style>.cls-1{fill:#fff;}.cls-2{fill:#00ac84;}.cls-3{fill:#231815;}</style></defs><title>アセット 1</title><g id="レイヤー_2" data-name="レイヤー 2"><g id="レイヤー_1-2" data-name="レイヤー 1"><path class="cls-1" d="M95.4,0A10.54,10.54,0,0,1,106,10.6V95.4A10.54,10.54,0,0,1,95.4,106H10.6A10.54,10.54,0,0,1,0,95.4V10.6A10.54,10.54,0,0,1,10.6,0H95.4"/><rect class="cls-1" x="10.6" y="10.6" width="84.8" height="84.8"/><path class="cls-2" d="M95.4,95.4H10.6V10.6H95.4ZM95.4,0H10.6A10.54,10.54,0,0,0,0,10.6V95.4A10.54,10.54,0,0,0,10.6,106H95.4A10.54,10.54,0,0,0,106,95.4V10.6A10.54,10.54,0,0,0,95.4,0"/><path class="cls-3" d="M17.1,67.9a11.69,11.69,0,0,0,4.5.8c6.1,0,6.1-4.9,6.1-8.3V29.1h9.4V65c0,5-3.2,12-12.9,12a25.39,25.39,0,0,1-7.2-.9V67.9Z"/><path class="cls-3" d="M60.7,29.1H71.3l18.4,47H79.3l-4-10.8H56.2L52.1,76.1H42.3Zm5.2,9.5h-.1L59,58H72.7Z"/></g></g></svg>
===== FILE: route_icons\ico_rosen_jb.svg =====
﻿<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 106 106"><defs><style>.cls-1{fill:#fff;}.cls-2{fill:#ffe500;}.cls-3{fill:#231815;}</style></defs><title>アセット 1</title><g id="レイヤー_2" data-name="レイヤー 2"><g id="レイヤー_1-2" data-name="レイヤー 1"><path class="cls-1" d="M95.4,0A10.54,10.54,0,0,1,106,10.6V95.4A10.54,10.54,0,0,1,95.4,106H10.6A10.54,10.54,0,0,1,0,95.4V10.6A10.54,10.54,0,0,1,10.6,0H95.4"/><rect class="cls-1" x="10.6" y="10.6" width="84.8" height="84.8"/><path class="cls-2" d="M95.4,95.4H10.6V10.6H95.4ZM95.4,0H10.6A10.54,10.54,0,0,0,0,10.6V95.4A10.54,10.54,0,0,0,10.6,106H95.4A10.54,10.54,0,0,0,106,95.4V10.6A10.54,10.54,0,0,0,95.4,0"/><path class="cls-3" d="M20.8,67.9a11.69,11.69,0,0,0,4.5.8c6.1,0,6.1-4.9,6.1-8.3V29.1h9.4V65c0,5-3.2,12-12.9,12a25.39,25.39,0,0,1-7.2-.9V67.9Z"/><path class="cls-3" d="M51,29.1H67.4c6.1,0,15.2,1.7,15.2,12.1,0,5.6-3.8,9.5-9.4,10.5v.1c6.4.6,10.8,4.9,10.8,10.7,0,11.8-10.6,13.6-16.6,13.6H51Zm9.4,19h3.8c4,0,8.9-.9,8.9-5.7,0-5.5-4.8-5.9-9.1-5.9H60.4Zm0,20.6h4.4c4.4,0,9.7-1.1,9.7-6.5,0-6.1-5-7.1-9.7-7.1H60.4Z"/></g></g></svg>
===== FILE: route_icons\ico_rosen_jc.svg =====
﻿<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 106 106"><defs><style>.cls-1{fill:#fff;}.cls-2{fill:#eb5c01;}.cls-3{fill:#231815;}</style></defs><title>アセット jc</title><g id="レイヤー_2" data-name="レイヤー 2"><g id="レイヤー_1-2" data-name="レイヤー 1"><path class="cls-1" d="M95.4,0A10.54,10.54,0,0,1,106,10.6V95.4A10.54,10.54,0,0,1,95.4,106H10.6A10.54,10.54,0,0,1,0,95.4V10.6A10.54,10.54,0,0,1,10.6,0H95.4"/><rect class="cls-1" x="10.6" y="10.6" width="84.8" height="84.8"/><path class="cls-2" d="M95.4,95.4H10.6V10.6H95.4ZM95.4,0H10.6A10.54,10.54,0,0,0,0,10.6V95.4A10.54,10.54,0,0,0,10.6,106H95.4A10.54,10.54,0,0,0,106,95.4V10.6A10.54,10.54,0,0,0,95.4,0"/><path class="cls-3" d="M20.8,67.9a11.69,11.69,0,0,0,4.5.8c6.1,0,6.1-4.9,6.1-8.3V29.1h9.4V65c0,5-3.2,12-12.9,12a25.39,25.39,0,0,1-7.2-.9V67.9Z"/><path class="cls-3" d="M85.2,75.5A47.61,47.61,0,0,1,74.5,77c-15.2,0-25.8-7.6-25.8-23.5,0-16.1,9.8-25.1,25.8-25.1a31.7,31.7,0,0,1,10.6,1.9l-.7,7.9a19.71,19.71,0,0,0-10.2-2.5c-9.7,0-15.8,7.4-15.8,17s5.9,16.8,16,16.8c3.7,0,8.1-.8,10.3-2Z"/></g></g></svg>
===== FILE: route_icons\ico_rosen_je.svg =====
﻿<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 106 106"><defs><style>.cls-1{fill:#fff;}.cls-2{fill:#cf1225;}.cls-3{fill:#231815;}</style></defs><title>アセット je</title><g id="レイヤー_2" data-name="レイヤー 2"><g id="レイヤー_1-2" data-name="レイヤー 1"><path class="cls-1" d="M95.4,0A10.54,10.54,0,0,1,106,10.6V95.4A10.54,10.54,0,0,1,95.4,106H10.6A10.54,10.54,0,0,1,0,95.4V10.6A10.54,10.54,0,0,1,10.6,0H95.4"/><rect class="cls-1" x="10.6" y="10.6" width="84.8" height="84.8"/><path class="cls-2" d="M95.4,95.4H10.6V10.6H95.4ZM95.4,0H10.6A10.54,10.54,0,0,0,0,10.6V95.4A10.54,10.54,0,0,0,10.6,106H95.4A10.54,10.54,0,0,0,106,95.4V10.6A10.54,10.54,0,0,0,95.4,0"/><path class="cls-3" d="M22.7,67.9a11.69,11.69,0,0,0,4.5.8c6.1,0,6.1-4.9,6.1-8.3V29.1h9.4V65c0,5-3.2,12-12.9,12a25.39,25.39,0,0,1-7.2-.9V67.9Z"/><polygon class="cls-3" points="52.8 29.1 80.6 29.1 80.6 36.5 62.3 36.5 62.3 48.1 79 48.1 79 55.5 62.3 55.5 62.3 68.7 80.7 68.7 80.7 76.1 52.8 76.1 52.8 29.1"/></g></g></svg>
===== FILE: route_icons\ico_rosen_jh.svg =====
﻿<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 106 106"><defs><style>.cls-1{fill:#fff;}.cls-2{fill:#85c023;}.cls-3{fill:#231815;}</style></defs><title>アセット jh</title><g id="レイヤー_2" data-name="レイヤー 2"><g id="レイヤー_1-2" data-name="レイヤー 1"><path class="cls-1" d="M95.4,0A10.54,10.54,0,0,1,106,10.6V95.4A10.54,10.54,0,0,1,95.4,106H10.6A10.54,10.54,0,0,1,0,95.4V10.6A10.54,10.54,0,0,1,10.6,0H95.4"/><rect class="cls-1" x="10.6" y="10.6" width="84.8" height="84.8"/><path class="cls-2" d="M95.4,95.4H10.6V10.6H95.4ZM95.4,0H10.6A10.54,10.54,0,0,0,0,10.6V95.4A10.54,10.54,0,0,0,10.6,106H95.4A10.54,10.54,0,0,0,106,95.4V10.6A10.54,10.54,0,0,0,95.4,0"/><path class="cls-3" d="M17.1,67.9a11.69,11.69,0,0,0,4.5.8c6.1,0,6.1-4.9,6.1-8.3V29.1h9.4V65c0,5-3.2,12-12.9,12a25.39,25.39,0,0,1-7.2-.9V67.9Z"/><polygon class="cls-3" points="47.2 29.1 56.7 29.1 56.7 48.1 75.5 48.1 75.5 29.1 85 29.1 85 76.1 75.5 76.1 75.5 55.5 56.7 55.5 56.7 76.1 47.2 76.1 47.2 29.1"/></g></g></svg>
===== FILE: route_icons\ico_rosen_ji.svg =====
﻿<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 106 106"><defs><style>.cls-1{fill:#fff;}.cls-2{fill:#ffe500;}.cls-3{fill:#231815;}</style></defs><title>アセット ji</title><g id="レイヤー_2" data-name="レイヤー 2"><g id="レイヤー_1-2" data-name="レイヤー 1"><path class="cls-1" d="M95.4,0A10.54,10.54,0,0,1,106,10.6V95.4A10.54,10.54,0,0,1,95.4,106H10.6A10.54,10.54,0,0,1,0,95.4V10.6A10.54,10.54,0,0,1,10.6,0H95.4"/><rect class="cls-1" x="10.6" y="10.6" width="84.8" height="84.8"/><path class="cls-2" d="M95.4,95.4H10.6V10.6H95.4ZM95.4,0H10.6A10.54,10.54,0,0,0,0,10.6V95.4A10.54,10.54,0,0,0,10.6,106H95.4A10.54,10.54,0,0,0,106,95.4V10.6A10.54,10.54,0,0,0,95.4,0"/><path class="cls-3" d="M28.7,67.9a11.69,11.69,0,0,0,4.5.8c6.1,0,6.1-4.9,6.1-8.3V29.1h9.4V65c0,5-3.2,12-12.9,12a25.39,25.39,0,0,1-7.2-.9V67.9Z"/><rect class="cls-3" x="64.7" y="29.1" width="9.4" height="47"/></g></g></svg>
===== FILE: route_icons\ico_rosen_jj.svg =====
﻿<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 106 106"><defs><style>.cls-1{fill:#fff;}.cls-2{fill:#00c18a;}.cls-3{fill:#231815;}</style></defs><title>アセット 1</title><g id="レイヤー_2" data-name="レイヤー 2"><g id="レイヤー_1-2" data-name="レイヤー 1"><path class="cls-1" d="M95.4,0A10.54,10.54,0,0,1,106,10.6V95.4A10.54,10.54,0,0,1,95.4,106H10.6A10.54,10.54,0,0,1,0,95.4V10.6A10.54,10.54,0,0,1,10.6,0H95.4"/><rect class="cls-1" x="10.6" y="10.6" width="84.8" height="84.8"/><path class="cls-2" d="M95.4,95.4H10.6V10.6H95.4ZM95.4,0H10.6A10.54,10.54,0,0,0,0,10.6V95.4A10.54,10.54,0,0,0,10.6,106H95.4A10.54,10.54,0,0,0,106,95.4V10.6A10.54,10.54,0,0,0,95.4,0"/><path class="cls-3" d="M24.9,67.9a11.69,11.69,0,0,0,4.5.8c6.1,0,6.1-4.9,6.1-8.3V29.1H45V65c0,5-3.2,12-12.9,12a25.39,25.39,0,0,1-7.2-.9Z"/><path class="cls-3" d="M57.8,67.9a11.69,11.69,0,0,0,4.5.8c6.1,0,6.1-4.9,6.1-8.3V29.1h9.4V65c0,5-3.2,12-12.9,12a25.39,25.39,0,0,1-7.2-.9V67.9Z"/></g></g></svg>
===== FILE: route_icons\ico_rosen_jk.svg =====
﻿<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 106 106"><defs><style>.cls-1{fill:#fff;}.cls-2{fill:#00a7e3;}.cls-3{fill:#231815;}</style></defs><title>jk</title><g id="レイヤー_2" data-name="レイヤー 2"><g id="レイヤー_1-2" data-name="レイヤー 1"><path class="cls-1" d="M95.4,0A10.54,10.54,0,0,1,106,10.6V95.4A10.54,10.54,0,0,1,95.4,106H10.6A10.54,10.54,0,0,1,0,95.4V10.6A10.54,10.54,0,0,1,10.6,0H95.4"/><rect class="cls-1" x="10.6" y="10.6" width="84.8" height="84.8"/><path class="cls-2" d="M95.4,95.4H10.6V10.6H95.4ZM95.4,0H10.6A10.54,10.54,0,0,0,0,10.6V95.4A10.54,10.54,0,0,0,10.6,106H95.4A10.54,10.54,0,0,0,106,95.4V10.6A10.54,10.54,0,0,0,95.4,0"/><path class="cls-3" d="M18.9,67.9a11.69,11.69,0,0,0,4.5.8c6.1,0,6.1-4.9,6.1-8.3V29.1H39V65c0,5-3.2,12-12.9,12a25.39,25.39,0,0,1-7.2-.9Z"/><polygon class="cls-3" points="49.1 29.1 58.5 29.1 58.5 49.3 75.5 29.1 87.1 29.1 67.7 51.3 87.9 76.1 75.6 76.1 58.7 54.3 58.5 54.3 58.5 76.1 49.1 76.1 49.1 29.1"/></g></g></svg>
===== FILE: route_icons\ico_rosen_jl.svg =====
﻿<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 106 106"><defs><style>.cls-1{fill:#fff;}.cls-2{fill:#9e9e9f;}.cls-3{fill:#231815;}</style></defs><title>jl</title><g id="レイヤー_2" data-name="レイヤー 2"><g id="レイヤー_1-2" data-name="レイヤー 1"><path class="cls-1" d="M95.4,0A10.54,10.54,0,0,1,106,10.6V95.4A10.54,10.54,0,0,1,95.4,106H10.6A10.54,10.54,0,0,1,0,95.4V10.6A10.54,10.54,0,0,1,10.6,0H95.4"/><rect class="cls-1" x="10.6" y="10.6" width="84.8" height="84.8"/><path class="cls-2" d="M95.4,95.4H10.6V10.6H95.4ZM95.4,0H10.6A10.54,10.54,0,0,0,0,10.6V95.4A10.54,10.54,0,0,0,10.6,106H95.4A10.54,10.54,0,0,0,106,95.4V10.6A10.54,10.54,0,0,0,95.4,0"/><path class="cls-3" d="M24.6,67.9a11.69,11.69,0,0,0,4.5.8c6.1,0,6.1-4.9,6.1-8.3V29.1h9.4V65c0,5-3.2,12-12.9,12a25.39,25.39,0,0,1-7.2-.9V67.9Z"/><polygon class="cls-3" points="54.7 29.1 64.1 29.1 64.1 68.7 82.4 68.7 82.4 76.1 54.7 76.1 54.7 29.1"/></g></g></svg>
===== FILE: route_icons\ico_rosen_jm.svg =====
﻿<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 106 106"><defs><style>.cls-1{fill:#fff;}.cls-2{fill:#eb5c01;}.cls-3{fill:#231815;}</style></defs><title>jm</title><g id="レイヤー_2" data-name="レイヤー 2"><g id="レイヤー_1-2" data-name="レイヤー 1"><path class="cls-1" d="M95.4,0A10.54,10.54,0,0,1,106,10.6V95.4A10.54,10.54,0,0,1,95.4,106H10.6A10.54,10.54,0,0,1,0,95.4V10.6A10.54,10.54,0,0,1,10.6,0H95.4"/><rect class="cls-1" x="10.6" y="10.6" width="84.8" height="84.8"/><path class="cls-2" d="M95.4,95.4H10.6V10.6H95.4ZM95.4,0H10.6A10.54,10.54,0,0,0,0,10.6V95.4A10.54,10.54,0,0,0,10.6,106H95.4A10.54,10.54,0,0,0,106,95.4V10.6A10.54,10.54,0,0,0,95.4,0"/><path class="cls-3" d="M13.8,67.9a11.69,11.69,0,0,0,4.5.8c6.1,0,6.1-4.9,6.1-8.3V29.1h9.4V65c0,5-3.2,12-12.9,12a25.39,25.39,0,0,1-7.2-.9V67.9Z"/><polygon class="cls-3" points="38.2 29.1 53.3 29.1 64.5 64.8 64.6 64.8 75.8 29.1 90.9 29.1 90.9 76.1 81.9 76.1 81.9 37.4 81.8 37.4 69.1 76.1 60.1 76.1 47.4 37.4 47.3 37.5 47.3 76.1 38.2 76.1 38.2 29.1"/></g></g></svg>
===== FILE: route_icons\ico_rosen_jn.svg =====
﻿<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 106 106"><defs><style>.cls-1{fill:#fff;}.cls-2{fill:#ffe400;}.cls-3{fill:#231815;}</style></defs><title>jn</title><g id="レイヤー_2" data-name="レイヤー 2"><g id="レイヤー_1-2" data-name="レイヤー 1"><path class="cls-1" d="M95.4,0A10.54,10.54,0,0,1,106,10.6V95.4A10.54,10.54,0,0,1,95.4,106H10.6A10.54,10.54,0,0,1,0,95.4V10.6A10.54,10.54,0,0,1,10.6,0H95.4"/><rect class="cls-1" x="10.6" y="10.6" width="84.8" height="84.8"/><path class="cls-2" d="M95.4,95.4H10.6V10.6H95.4ZM95.4,0H10.6A10.54,10.54,0,0,0,0,10.6V95.4A10.54,10.54,0,0,0,10.6,106H95.4A10.54,10.54,0,0,0,106,95.4V10.6A10.54,10.54,0,0,0,95.4,0"/><path class="cls-3" d="M17.1,67.9a11.69,11.69,0,0,0,4.5.8c6.1,0,6.1-4.9,6.1-8.3V29.1h9.4V65c0,5-3.2,12-12.9,12a25.39,25.39,0,0,1-7.2-.9V67.9Z"/><polygon class="cls-3" points="46.8 29.1 58.4 29.1 76.3 64.3 76.4 64.3 76.4 29.1 85.4 29.1 85.4 76.1 73.9 76.1 55.9 41 55.8 41 55.8 76.1 46.8 76.1 46.8 29.1"/></g></g></svg>
===== FILE: route_icons\ico_rosen_jo.svg =====
﻿<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 106 106"><defs><style>.cls-1{fill:#fff;}.cls-2{fill:#0074be;}.cls-3{fill:#231815;}</style></defs><title>jo</title><g id="レイヤー_2" data-name="レイヤー 2"><g id="レイヤー_1-2" data-name="レイヤー 1"><rect class="cls-1" x="10.6" y="10.6" width="84.8" height="84.8"/><path class="cls-2" d="M95.4,95.4H10.6V10.6H95.4ZM95.4,0H10.6A10.54,10.54,0,0,0,0,10.6V95.4A10.54,10.54,0,0,0,10.6,106H95.4A10.54,10.54,0,0,0,106,95.4V10.6A10.54,10.54,0,0,0,95.4,0"/><path class="cls-3" d="M15.2,67.9a11.69,11.69,0,0,0,4.5.8c6.1,0,6.1-4.9,6.1-8.3V29.1h9.4V65c0,5-3.2,12-12.9,12a25.39,25.39,0,0,1-7.2-.9V67.9Z"/><path class="cls-3" d="M66.1,28.3c14.8,0,23,10,23,24.2s-8.2,24.4-23,24.4c-15.1,0-23-10-23-24.4s8-24.2,23-24.2m0,41.2c9.6,0,13.2-8.6,13.2-17S75.5,35.7,66.1,35.7,52.9,44.2,52.9,52.5c0,8.5,3.6,17,13.2,17"/></g></g></svg>
===== FILE: route_icons\ico_rosen_js.svg =====
﻿<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 106 106"><defs><style>.cls-1{fill:#fff;}.cls-2{fill:#de0515;}.cls-3{fill:#231815;}</style></defs><title>js</title><g id="レイヤー_2" data-name="レイヤー 2"><g id="レイヤー_1-2" data-name="レイヤー 1"><path class="cls-1" d="M95.4,0A10.54,10.54,0,0,1,106,10.6V95.4A10.54,10.54,0,0,1,95.4,106H10.6A10.54,10.54,0,0,1,0,95.4V10.6A10.54,10.54,0,0,1,10.6,0H95.4"/><rect class="cls-1" x="10.6" y="10.6" width="84.8" height="84.8"/><path class="cls-2" d="M95.4,95.4H10.6V10.6H95.4ZM95.4,0H10.6A10.54,10.54,0,0,0,0,10.6V95.4A10.54,10.54,0,0,0,10.6,106H95.4A10.54,10.54,0,0,0,106,95.4V10.6A10.54,10.54,0,0,0,95.4,0"/><path class="cls-3" d="M22.7,67.9a11.69,11.69,0,0,0,4.5.8c6.1,0,6.1-4.9,6.1-8.3V29.1h9.4V65c0,5-3.2,12-12.9,12a25.39,25.39,0,0,1-7.2-.9V67.9Z"/><path class="cls-3" d="M78.1,37.8a24.28,24.28,0,0,0-9.6-2c-3.2,0-7.4,1.4-7.4,6.5,0,8.1,20.6,4.7,20.6,20.5C81.7,73.1,73.5,77,64.1,77c-5.1,0-7.4-.7-12.1-1.8l.9-8.5a21.9,21.9,0,0,0,10.6,2.9c3.6,0,8.3-1.8,8.3-6.1,0-9-20.6-5.3-20.6-20.8,0-10.5,8.2-14.3,16.4-14.3a33.73,33.73,0,0,1,11.2,1.7Z"/></g></g></svg>
===== FILE: route_icons\ico_rosen_jt.svg =====
﻿<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 106 106"><defs><style>.cls-1{fill:#fff;}.cls-2{fill:#ff9845;}.cls-3{fill:#231815;}</style></defs><title>jt</title><g id="レイヤー_2" data-name="レイヤー 2"><g id="レイヤー_1-2" data-name="レイヤー 1"><path class="cls-1" d="M95.4,0A10.54,10.54,0,0,1,106,10.6V95.4A10.54,10.54,0,0,1,95.4,106H10.6A10.54,10.54,0,0,1,0,95.4V10.6A10.54,10.54,0,0,1,10.6,0H95.4"/><rect class="cls-1" x="10.6" y="10.6" width="84.8" height="84.8"/><path class="cls-2" d="M95.4,95.4H10.6V10.6H95.4ZM95.4,0H10.6A10.54,10.54,0,0,0,0,10.6V95.4A10.54,10.54,0,0,0,10.6,106H95.4A10.54,10.54,0,0,0,106,95.4V10.6A10.54,10.54,0,0,0,95.4,0"/><path class="cls-3" d="M22.7,67.9a11.69,11.69,0,0,0,4.5.8c6.1,0,6.1-4.9,6.1-8.3V29.1h9.4V65c0,5-3.2,12-12.9,12a25.39,25.39,0,0,1-7.2-.9V67.9Z"/><polygon class="cls-3" points="61.4 36.5 47.9 36.5 47.9 29.1 84.3 29.1 84.3 36.5 70.8 36.5 70.8 76.1 61.4 76.1 61.4 36.5"/></g></g></svg>
===== FILE: route_icons\ico_rosen_ju.svg =====
﻿<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 106 106"><defs><style>.cls-1{fill:#fff;}.cls-2{fill:#ff9845;}.cls-3{fill:#231815;}</style></defs><title>ju</title><g id="レイヤー_2" data-name="レイヤー 2"><g id="レイヤー_1-2" data-name="レイヤー 1"><path class="cls-1" d="M95.4,0A10.54,10.54,0,0,1,106,10.6V95.4A10.54,10.54,0,0,1,95.4,106H10.6A10.54,10.54,0,0,1,0,95.4V10.6A10.54,10.54,0,0,1,10.6,0H95.4"/><rect class="cls-1" x="10.6" y="10.6" width="84.8" height="84.8"/><path class="cls-2" d="M95.4,95.4H10.6V10.6H95.4ZM95.4,0H10.6A10.54,10.54,0,0,0,0,10.6V95.4A10.54,10.54,0,0,0,10.6,106H95.4A10.54,10.54,0,0,0,106,95.4V10.6A10.54,10.54,0,0,0,95.4,0"/><path class="cls-3" d="M17.1,67.9a11.69,11.69,0,0,0,4.5.8c6.1,0,6.1-4.9,6.1-8.3V29.1h9.4V65c0,5-3.2,12-12.9,12a25.39,25.39,0,0,1-7.2-.9V67.9Z"/><path class="cls-3" d="M46.9,29.1h9.4V56.2c0,8,2.6,13.3,9.8,13.3s9.8-5.3,9.8-13.3V29.1h9.4v30c0,12.6-7.1,17.8-19.2,17.8S46.9,71.7,46.9,59.1Z"/></g></g></svg>
===== FILE: route_icons\ico_rosen_jy.svg =====
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 106 106"><defs><style>.cls-1{fill:#fff;}.cls-2{fill:#85c023;}.cls-3{fill:#231815;}</style></defs><title>jy</title><g id="レイヤー_2" data-name="レイヤー 2"><g id="レイヤー_1-2" data-name="レイヤー 1"><path class="cls-1" d="M95.4,0A10.54,10.54,0,0,1,106,10.6V95.4A10.54,10.54,0,0,1,95.4,106H10.6A10.54,10.54,0,0,1,0,95.4V10.6A10.54,10.54,0,0,1,10.6,0H95.4"/><rect class="cls-1" x="10.6" y="10.6" width="84.8" height="84.8"/><path class="cls-2" d="M95.4,95.4H10.6V10.6H95.4ZM95.4,0H10.6A10.54,10.54,0,0,0,0,10.6V95.4A10.54,10.54,0,0,0,10.6,106H95.4A10.54,10.54,0,0,0,106,95.4V10.6A10.54,10.54,0,0,0,95.4,0"/><path class="cls-3" d="M18.9,67.9a11.69,11.69,0,0,0,4.5.8c6.1,0,6.1-4.9,6.1-8.3V29.1H39V65c0,5-3.2,12-12.9,12a25.39,25.39,0,0,1-7.2-.9Z"/><polygon class="cls-3" points="61.6 57.6 44.4 29.1 55.4 29.1 66.5 48.9 77.9 29.1 87.8 29.1 71 57.6 71 76.1 61.6 76.1 61.6 57.6"/></g></g></svg>
===== FILE: route_icons\ico_rosen_mo.svg =====
<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 198.42 198.43">
  <defs>
    <style>
      .cls-1 {
        fill: #fff;
      }

      .cls-2 {
        fill: #003686;
      }

      .cls-3 {
        fill: #231815;
      }
    </style>
  </defs>
  <g>
    <path class="cls-2" d="M178.58,0H19.84C8.88,0,0,8.89,0,19.85v158.74c0,10.96,8.88,19.84,19.84,19.84h158.74c10.97,0,19.85-8.88,19.85-19.84V19.85c0-10.96-8.88-19.85-19.85-19.85"/>
    <rect class="cls-1" x="19.84" y="19.85" width="158.74" height="158.74"/>
    <g>
      <path class="cls-3" d="M28.86,64.08h23.44l11.84,46.4h.16l12.4-46.4h22.56v69.8h-14.56l.24-53.6h-.16l-14.24,53.6h-13.68l-13.6-53.6h-.16l.32,53.6h-14.56v-69.8Z"/>
      <path class="cls-3" d="M139.41,62.88c21.85,0,33.25,13.7,33.25,36.1s-11.59,36.1-33.25,36.1-33.25-13.9-33.25-36.1,11.4-36.1,33.25-36.1ZM139.41,121.29c10.74,0,15.01-10.8,15.01-22.3,0-12.1-4.28-22.3-15.01-22.3s-15.01,10.2-15.01,22.3,4.28,22.3,15.01,22.3Z"/>
    </g>
  </g>
</svg>
===== FILE: sample_notices.js =====
// 解析検証用サンプル運行情報
window.sampleNotices = [
  "湘南新宿ラインは、高崎線内での架線に支障物の影響で、高崎線から東海道線の一部列車に遅れがでています。",
  "高崎線は、行田駅での架線に支障物の影響で、籠原～東京駅間の上り線の一部列車に遅れがでています。",
  "東北本線は、強風が見込まれるため、仙台～小牛田駅間の上下線で一部列車が運休となります。代行輸送は行いません。今後の気象状況や運行情報にご注意ください。",
  "東北本線は、強風の影響で、仙台～一ノ関駅間の上下線の一部列車に遅れがでています。",
  "磐越西線は、強風が見込まれるため、郡山～会津若松駅間の上下線で一部列車が運休となります。代行輸送は行いません。今後の気象状況や運行情報にご注意ください。",
  "快速「あいづ１号・２号・３号・４号」は、強風が見込まれるため、全区間で運休となります。代行輸送は行いません。今後の気象情報や運行情報にご注意ください。",
  "東北新幹線「はやぶさ２１号」は、強風の影響で、遅れがでています。",
  "秋田新幹線「こまち２１号」は、強風の影響で、遅れがでています。"
];
===== FILE: SPEC.md =====
# Railway Status Map 仕様書

## 1. 目的
- JR東日本エリア中心の運行情報文をローカル環境で解析し、路線カードに反映する。
- `file://` で動作し、Webサーバや外部CDNに依存しない。
- 駅情報（駅名かな・乗換）を右カラムで確認できる運用画面を提供する。

## 2. 実行環境
- 想定ブラウザ: Microsoft Edge
- 配置: 単一フォルダ配下で静的ファイルをそのまま開く
- 外部通信: なし

## 3. ファイル構成
```text
Railway_status_map/
  .gitattributes
  README.md
  SPEC.md
  railway_status_map.html        # 画面HTML/CSS、script読込順
  railway_lines.js               # 解析・状態管理・描画ロジック本体
  sample_notices.js              # サンプル自然文
  data_kanto.js                  # 路線マスタ(関東)
  data_tohoku.js                 # 路線マスタ(東北)
  data_shinetsu.js               # 路線マスタ(信越)
  data_limited.js                # 在来線特急マスタ
  data_shinkansen.js             # 新幹線マスタ
  station_metadata.js            # 駅メタデータ統合ローダー
  route_icons/                   # 路線記号SVGアイコン
    ico_rosen_*.svg
  station_metadata/
    lines/                       # 路線別チャンク（優先）
      kanto_tokaido.js
      kanto_keihin_tohoku.js
      kanto_yokosuka.js
      kanto_nambu.js
      kanto_yokohama.js
      kanto_ito.js
      kanto_sagami.js
      kanto_tsurumi.js
      kanto_utsunomiya.js
      kanto_takasaki.js
      kanto_chuo_rapid.js
      kanto_chuo_sobu_local.js
      kanto_chuo_main.js
      kanto_itsukaichi.js
      kanto_ome.js
      kanto_koumi.js
      kanto_saikyo.js
      kanto_kawagoe.js
      kanto_musashino.js
      kanto_joetsu.js
      kanto_shinetsu_main.js
      kanto_agatsuma.js
      kanto_karasuyama.js
      kanto_hachiko.js
      kanto_nikko.js
      kanto_ryomo.js
      kanto_joban.js
      kanto_joban_rapid.js
      kanto_joban_local.js
      kanto_suigun.js
      kanto_mito.js
      kanto_sobu_rapid.js
      kanto_sobu_main.js
      kanto_keiyo.js
      kanto_uchibo.js
      kanto_kashima.js
      kanto_kururi.js
      kanto_sotobo.js
      kanto_togane.js
      kanto_narita.js
      kanto_monorail.js
      tohoku_tohoku_main.js
      tohoku_hachinohe.js
      tohoku_ou_main_aomori_akita.js
      tohoku_tsugaru.js
      tohoku_hanawa.js
      tohoku_omminato.js
      tohoku_kitakami.js
      tohoku_kamaishi.js
      tohoku_tazawako.js
      tohoku_senzan.js
      tohoku_senseki.js
      tohoku_senseki_tohoku.js
      tohoku_ishinomaki.js
      tohoku_kesennuma.js
      tohoku_kesennuma_brt.js
      tohoku_ofunato.js
      tohoku_ofunato_brt.js
      tohoku_yamada.js
      tohoku_gono.js
      tohoku_oga.js
      tohoku_uetsu_northern.js
      tohoku_rikuu_east.js
      tohoku_rikuu_west.js
      tohoku_yonesaka.js
      tohoku_banetsu_west.js
      tohoku_banetsu_east.js
      tohoku_aterazawa.js
      tohoku_tadami.js
      tohoku_suigun.js
      tohoku_joban.js
      shinetsu_uetsu.js
      shinetsu_shinetsu_main.js
      shinetsu_joetsu.js
      shinetsu_shinonoi.js
      shinetsu_koshinetsu_chuo_main.js
      shinetsu_hakushin.js
      shinetsu_banetsu_west.js
      shinetsu_iiyama.js
      shinetsu_echigo.js
      shinetsu_oito.js
      shinetsu_koumi.js
      shinetsu_tadami.js
      shinetsu_yahiko.js
      shinetsu_yonesaka.js
      shinetsu_gono.js
    group_direct_service.js      # 方面/サービス単位（移行中）
    line_yamanote.js
    line_chuo_rapid.js
    line_sobu_joban.js
    line_tohoku_shinetsu.js
```

## 4. UI仕様
- 3カラム構成
- 左: 自然文入力と手動補助設定
- 中央: 路線カード一覧
- 右: 駅データ詳細（クリック選択駅の情報）
- レスポンシブ
- 幅が狭い場合は右カラムを下段へ移動

## 5. 路線カード表示仕様
- 路線ごとに状態（平常/遅延/見合わせ/運休）を保持
- 区間・方向・原因・再開見込みを表示
- 駅列は横スクロール可
- 乗換データがある駅は枠色変更+右上ドットで強調
- 駅クリックで右カラム詳細を更新

## 6. 駅詳細パネル仕様
- 表示項目
- 駅名
- 所属（エリア・路線・系統scope）
- 駅名かな
- 乗換一覧（事業者 / 路線 / 必要時駅名）
- 選択状態は `localStorage` (`selectedStationV1`) に保存

## 7. 解析仕様（自然文）
- 主な抽出項目
- 路線
- 状態 `normal|delay|suspend|stop`
- 方向 `both|up|down|unknown`
- 区間（`A〜B` 複数可）
- 原因
- 再開見込み

### 区間解釈の補正ルール
- `A〜B駅間の上下線で運転を見合わせ` は区間見合わせとして扱う。
- `A〜B駅間での〜の影響で、上下線で運転を見合わせ` は原因箇所文脈と見なし、全線見合わせ扱いに補正する。
- 見合わせ/運休で区間が空の場合は、路線図の駅間セグメントを全線アクティブ表示する。

## 8. データモデル
- 路線キー: `area:line_key`
- 路線レコード
- `area`, `lineName`, `lineNameKana`, `scope`, `stations[]`
- 駅レコード
- `id`, `name`, `nameKana`, `interchanges[]`
- 乗換レコード
- `toOperator`, `toLine`, `toStationName`

## 9. 駅メタデータ分割方針
- 基本方針: **路線別ファイルを正** とする（`station_metadata/lines/*.js`）。
- `station_metadata/*.js` で分割定義し、`window.stationMetadataChunks` に追加する。
- `station_metadata.js` で全チャンクを統合し `window.stationMetadata` を生成する。
- 同一駅が複数ファイルに出る場合
- `nameKana` は後勝ち
- `interchanges` は重複除去してマージ
- 方面別/サービス別ファイルは移行期間中の互換レイヤとして利用し、最終的には路線別へ寄せる。
- 同一路線が複数方面に含まれるケースは、路線別ファイル1つを参照する運用で重複定義を避ける。
- JR東日本サイト上で支社単位に分割される路線は、同一路線ファイル内で `scope` を意識した追記、または将来的に `lines/<line>__<scope>.js` 分割を許容する。

## 10. 今後の拡充方針
- 駅メタデータはユーザー要求の単位（方面/路線）で分割を整理する。
- 優先方面: 山手線 / 直通サービス / 東海道方面 / 関東東北・高崎方面 / 中央方面 / 総武方面 / 東北方面
- 追加時は「駅名かな」と「主要乗換」をセットで登録する。
- 運用上の必須条件: **運行情報対象路線は全駅を登録する**（主要駅のみ定義は禁止）。

## 10.1 全駅化チェック運用
- 全駅マスタは `station_master/full_line_stations.json` を正として管理する（`station_master/full_line_stations.sample.json` をテンプレートに作成）。
- 形式: キーは `area:line_key`、値は駅名配列（路線図の表示順）。
- 判定コマンド: `node tools/check_station_completeness.js`
- レポート出力: `reports/station_completeness.md`
- 判定基準
- マスタ未登録路線が 0
- 現行未登録路線が 0
- 駅数不一致が 0
- 駅順不一致が 0

## 11. 路線記号アイコン運用
- 路線記号は `railway_lines.js` の `ROUTE_SYMBOL_BY_LINE_NAME` で路線名に紐付ける。
- アイコンファイルは `route_icons/ico_rosen_<symbol小文字>.svg` 命名で配置する。
- アイコン表示対応は `railway_lines.js` の `ROUTE_ICON_BY_SYMBOL` に追加する。
- アイコン未登録の記号はフォールバックとして色付き四角バッジ表示になる。
- 実SVG差し替え時は同名ファイルを上書きすれば表示が更新される。

## 12. 既知の注意点
- `README.md` は現状との差分が残っている箇所があるため、運用時は本 `SPEC.md` を正とする。


===== FILE: station_master\full_line_stations.sample.json =====
{
  "kanto:yamanote": [
    "東京",
    "有楽町",
    "新橋"
  ],
  "kanto:tokaido": [
    "東京",
    "新橋",
    "品川"
  ]
}

===== FILE: station_metadata.js =====
// 駅メタデータ統合ローダー
// 各ファイルは window.stationMetadataChunks に駅名キーで追加する。
(function () {
  const chunks = window.stationMetadataChunks || {};
  const base = window.stationMetadata || {};
  const merged = {};

  function mergeInterchanges(primary, secondary) {
    const out = [];
    const seen = {};

    function pushAll(list) {
      (Array.isArray(list) ? list : []).forEach(function (it) {
        const item = {
          toOperator: String((it && it.toOperator) || ""),
          toLine: String((it && it.toLine) || ""),
          toStationName: String((it && it.toStationName) || "")
        };
        const key = [item.toOperator, item.toLine, item.toStationName].join("|");
        if (!key || seen[key]) {
          return;
        }
        seen[key] = true;
        out.push(item);
      });
    }

    pushAll(primary);
    pushAll(secondary);
    return out;
  }

  function mergeStation(name, src) {
    const current = merged[name] || {};
    merged[name] = {
      nameKana: String((src && src.nameKana) || current.nameKana || ""),
      interchanges: mergeInterchanges(
        current.interchanges || [],
        (src && src.interchanges) || []
      )
    };
  }

  Object.keys(base).forEach(function (name) {
    mergeStation(name, base[name]);
  });

  Object.keys(chunks).forEach(function (name) {
    mergeStation(name, chunks[name]);
  });

  window.stationMetadata = merged;
})();
===== FILE: station_metadata\group_direct_service.js =====
// 直通サービス系メタデータ（上野東京ライン / 湘南新宿ライン / 相鉄線直通列車）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "雀宮": {
    nameKana: "すずめのみや"
  },
  "石橋": {
    nameKana: "いしばし"
  },
  "自治医大": {
    nameKana: "じちいだい"
  },
  "小金井": {
    nameKana: "こがねい"
  },
  "久喜": {
    nameKana: "くき",
    interchanges: [
      { toOperator: "東武鉄道", toLine: "伊勢崎線" }
    ]
  },
  "小山": {
    nameKana: "おやま",
    interchanges: [
      { toOperator: "JR東日本", toLine: "東北新幹線" },
      { toOperator: "JR東日本", toLine: "両毛線" },
      { toOperator: "JR東日本", toLine: "水戸線" }
    ]
  },
  "間々田": {
    nameKana: "ままだ"
  },
  "野木": {
    nameKana: "のぎ"
  },
  "古河": {
    nameKana: "こが"
  },
  "栗橋": {
    nameKana: "くりはし",
    interchanges: [
      { toOperator: "東武鉄道", toLine: "日光線" }
    ]
  },
  "東鷲宮": {
    nameKana: "ひがしわしのみや"
  },
  "新白岡": {
    nameKana: "しんしらおか"
  },
  "白岡": {
    nameKana: "しらおか"
  },
  "蓮田": {
    nameKana: "はすだ"
  },
  "東大宮": {
    nameKana: "ひがしおおみや"
  },
  "土呂": {
    nameKana: "とろ"
  },
  "宇都宮": {
    nameKana: "うつのみや",
    interchanges: [
      { toOperator: "JR東日本", toLine: "東北新幹線" },
      { toOperator: "JR東日本", toLine: "日光線" }
    ]
  },
  "さいたま新都心": {
    nameKana: "さいたましんとしん",
    interchanges: [
      { toOperator: "JR東日本", toLine: "京浜東北線" }
    ]
  },
  "浦和": {
    nameKana: "うらわ",
    interchanges: [
      { toOperator: "JR東日本", toLine: "京浜東北線" },
      { toOperator: "JR東日本", toLine: "湘南新宿ライン" }
    ]
  },
  "赤羽": {
    nameKana: "あかばね",
    interchanges: [
      { toOperator: "JR東日本", toLine: "京浜東北線" },
      { toOperator: "JR東日本", toLine: "埼京線" }
    ]
  },
  "尾久": {
    nameKana: "おく"
  },
  "池袋": {
    nameKana: "いけぶくろ",
    interchanges: [
      { toOperator: "JR東日本", toLine: "山手線" },
      { toOperator: "JR東日本", toLine: "埼京線" },
      { toOperator: "東武鉄道", toLine: "東上線" },
      { toOperator: "西武鉄道", toLine: "池袋線" },
      { toOperator: "東京メトロ", toLine: "丸ノ内線" },
      { toOperator: "東京メトロ", toLine: "有楽町線" },
      { toOperator: "東京メトロ", toLine: "副都心線" }
    ]
  },
  "新宿": {
    nameKana: "しんじゅく",
    interchanges: [
      { toOperator: "JR東日本", toLine: "中央線" },
      { toOperator: "JR東日本", toLine: "中央総武緩行線" },
      { toOperator: "JR東日本", toLine: "山手線" },
      { toOperator: "JR東日本", toLine: "埼京線" },
      { toOperator: "京王電鉄", toLine: "京王線" },
      { toOperator: "小田急電鉄", toLine: "小田原線" },
      { toOperator: "西武鉄道", toLine: "新宿線" },
      { toOperator: "東京メトロ", toLine: "丸ノ内線" },
      { toOperator: "都営地下鉄", toLine: "新宿線" },
      { toOperator: "都営地下鉄", toLine: "大江戸線" }
    ]
  },
  "渋谷": {
    nameKana: "しぶや",
    interchanges: [
      { toOperator: "JR東日本", toLine: "山手線" },
      { toOperator: "JR東日本", toLine: "埼京線" },
      { toOperator: "東急電鉄", toLine: "東横線" },
      { toOperator: "東急電鉄", toLine: "田園都市線" },
      { toOperator: "京王電鉄", toLine: "井の頭線" },
      { toOperator: "東京メトロ", toLine: "銀座線" },
      { toOperator: "東京メトロ", toLine: "半蔵門線" },
      { toOperator: "東京メトロ", toLine: "副都心線" }
    ]
  },
  "恵比寿": {
    nameKana: "えびす",
    interchanges: [
      { toOperator: "JR東日本", toLine: "山手線" },
      { toOperator: "東京メトロ", toLine: "日比谷線" }
    ]
  },
  "大崎": {
    nameKana: "おおさき",
    interchanges: [
      { toOperator: "JR東日本", toLine: "山手線" },
      { toOperator: "JR東日本", toLine: "埼京線" },
      { toOperator: "東京臨海高速鉄道", toLine: "りんかい線" }
    ]
  },
  "西大井": {
    nameKana: "にしおおい"
  },
  "武蔵小杉": {
    nameKana: "むさしこすぎ",
    interchanges: [
      { toOperator: "JR東日本", toLine: "南武線" },
      { toOperator: "JR東日本", toLine: "横須賀線" },
      { toOperator: "東急", toLine: "東横線" },
      { toOperator: "東急", toLine: "目黒線" }
    ]
  },
  "新川崎": {
    nameKana: "しんかわさき"
  },
  "横浜": {
    nameKana: "よこはま",
    interchanges: [
      { toOperator: "JR東日本", toLine: "京浜東北線" },
      { toOperator: "JR東日本", toLine: "根岸線" },
      { toOperator: "JR東日本", toLine: "横須賀線" },
      { toOperator: "京急", toLine: "本線" },
      { toOperator: "相鉄", toLine: "本線" },
      { toOperator: "東急", toLine: "東横線" },
      { toOperator: "横浜高速鉄道", toLine: "みなとみらい線" },
      { toOperator: "横浜市交通局", toLine: "ブルーライン" }
    ]
  },
  "上野": {
    nameKana: "うえの",
    interchanges: [
      { toOperator: "JR東日本", toLine: "山手線" },
      { toOperator: "JR東日本", toLine: "京浜東北線" },
      { toOperator: "JR東日本", toLine: "常磐線" },
      { toOperator: "JR東日本", toLine: "高崎線" },
      { toOperator: "JR東日本", toLine: "新幹線各線" },
      { toOperator: "東京メトロ", toLine: "銀座線" },
      { toOperator: "東京メトロ", toLine: "日比谷線" }
    ]
  },
  "東京": {
    nameKana: "とうきょう",
    interchanges: [
      { toOperator: "JR東日本", toLine: "山手線" },
      { toOperator: "JR東日本", toLine: "中央線" },
      { toOperator: "JR東日本", toLine: "京葉線" },
      { toOperator: "JR東日本", toLine: "横須賀線" },
      { toOperator: "JR東日本", toLine: "ほか" },
      { toOperator: "東京メトロ", toLine: "丸ノ内線" }
    ]
  },
  "新橋": {
    nameKana: "しんばし",
    interchanges: [
      { toOperator: "JR東日本", toLine: "山手線" },
      { toOperator: "JR東日本", toLine: "横須賀線" },
      { toOperator: "東京メトロ", toLine: "銀座線" },
      { toOperator: "都営地下鉄", toLine: "浅草線" }
    ]
  },
  "品川": {
    nameKana: "しながわ",
    interchanges: [
      { toOperator: "JR東日本", toLine: "山手線" },
      { toOperator: "JR東日本", toLine: "京浜東北線" },
      { toOperator: "JR東日本", toLine: "横須賀線" },
      { toOperator: "JR東日本", toLine: "東海道新幹線" },
      { toOperator: "京浜急行電鉄", toLine: "本線" }
    ]
  },
  "川崎": {
    nameKana: "かわさき",
    interchanges: [
      { toOperator: "JR東日本", toLine: "京浜東北線" },
      { toOperator: "JR東日本", toLine: "南武線" }
    ]
  },
  "保土ケ谷": {
    nameKana: "ほどがや"
  },
  "東戸塚": {
    nameKana: "ひがしとつか"
  },
  "戸塚": {
    nameKana: "とつか",
    interchanges: [
      { toOperator: "JR東日本", toLine: "横須賀線" },
      { toOperator: "横浜市営地下鉄", toLine: "ブルーライン" }
    ]
  },
  "大船": {
    nameKana: "おおふな",
    interchanges: [
      { toOperator: "JR東日本", toLine: "東海道線" },
      { toOperator: "JR東日本", toLine: "根岸線" }
    ]
  },
  "北鎌倉": {
    nameKana: "きたかまくら"
  },
  "桶川": {
    nameKana: "おけがわ"
  },
  "高崎": {
    nameKana: "たかさき",
    interchanges: [
      { toOperator: "JR東日本", toLine: "上越新幹線" },
      { toOperator: "JR東日本", toLine: "北陸新幹線" },
      { toOperator: "JR東日本", toLine: "上越線" },
      { toOperator: "JR東日本", toLine: "信越本線" },
      { toOperator: "JR東日本", toLine: "八高線" },
      { toOperator: "上信電鉄", toLine: "上信線" }
    ]
  },
  "倉賀野": {
    nameKana: "くらがの",
    interchanges: [
      { toOperator: "JR東日本", toLine: "八高線" }
    ]
  },
  "新町": {
    nameKana: "しんまち"
  },
  "神保原": {
    nameKana: "じんぼはら"
  },
  "本庄": {
    nameKana: "ほんじょう"
  },
  "岡部": {
    nameKana: "おかべ"
  },
  "深谷": {
    nameKana: "ふかや"
  },
  "籠原": {
    nameKana: "かごはら",
    interchanges: [
      { toOperator: "JR東日本", toLine: "折返し列車多数" }
    ]
  },
  "熊谷": {
    nameKana: "くまがや",
    interchanges: [
      { toOperator: "JR東日本", toLine: "上越新幹線" },
      { toOperator: "秩父鉄道", toLine: "秩父本線" }
    ]
  },
  "行田": {
    nameKana: "ぎょうだ"
  },
  "吹上": {
    nameKana: "ふきあげ"
  },
  "北鴻巣": {
    nameKana: "きたこうのす"
  },
  "鴻巣": {
    nameKana: "こうのす"
  },
  "北本": {
    nameKana: "きたもと"
  },
  "北上尾": {
    nameKana: "きたあげお"
  },
  "上尾": {
    nameKana: "あげお"
  },
  "宮原": {
    nameKana: "みやはら"
  },
  "大宮": {
    nameKana: "おおみや",
    interchanges: [
      { toOperator: "JR東日本", toLine: "京浜東北線" },
      { toOperator: "JR東日本", toLine: "宇都宮線" },
      { toOperator: "JR東日本", toLine: "川越線" },
      { toOperator: "JR東日本", toLine: "埼京線" },
      { toOperator: "JR東日本", toLine: "武蔵野線", toStationName: "近接" },
      { toOperator: "東武鉄道", toLine: "野田線", toStationName: "東武アーバンパークライン" },
      { toOperator: "埼玉新都市交通", toLine: "伊奈線", toStationName: "ニューシャトル" }
    ]
  },
  "鎌倉": {
    nameKana: "かまくら",
    interchanges: [
      { toOperator: "江ノ島電鉄", toLine: "江ノ島電鉄線" }
    ]
  },
  "逗子": {
    nameKana: "ずし",
    interchanges: []
  },
  "藤沢": {
    nameKana: "ふじさわ",
    interchanges: [
      { toOperator: "小田急", toLine: "江ノ島線" },
      { toOperator: "江ノ島電鉄", toLine: "江ノ島電鉄線" }
    ]
  },
  "辻堂": {
    nameKana: "つじどう"
  },
  "茅ケ崎": {
    nameKana: "ちがさき",
    interchanges: [
      { toOperator: "JR東日本", toLine: "相模線" }
    ]
  },
  "平塚": {
    nameKana: "ひらつか"
  },
  "大磯": {
    nameKana: "おおいそ"
  },
  "二宮": {
    nameKana: "にのみや"
  },
  "国府津": {
    nameKana: "こうづ",
    interchanges: [
      { toOperator: "JR東日本", toLine: "御殿場線" }
    ]
  },
  "鴨宮": {
    nameKana: "かもみや"
  },
  "小田原": {
    nameKana: "おだわら",
    interchanges: [
      { toOperator: "JR東日本", toLine: "東海道新幹線" },
      { toOperator: "JR東日本", toLine: "御殿場線" },
      { toOperator: "小田急", toLine: "小田原線" },
      { toOperator: "箱根登山鉄道", toLine: "鉄道線" },
      { toOperator: "伊豆箱根鉄道", toLine: "大雄山線" }
    ]
  },
  "熱海": {
    nameKana: "あたみ",
    interchanges: [
      { toOperator: "JR東日本", toLine: "伊東線" },
      { toOperator: "JR東海", toLine: "東海道新幹線" }
    ]
  }
});
===== FILE: station_metadata\line_chuo_rapid.js =====
// 中央線快速電車系メタデータ
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "御茶ノ水": {
    nameKana: "おちゃのみず",
    interchanges: [
      { toOperator: "東京メトロ", toLine: "丸ノ内線" }
    ]
  },
  "四ツ谷": {
    nameKana: "よつや",
    interchanges: [
      { toOperator: "東京メトロ", toLine: "丸ノ内線" },
      { toOperator: "東京メトロ", toLine: "南北線" }
    ]
  },
  "中野": {
    nameKana: "なかの",
    interchanges: [
      { toOperator: "東京メトロ", toLine: "東西線" }
    ]
  },
  "立川": {
    nameKana: "たちかわ",
    interchanges: [
      { toOperator: "多摩都市モノレール", toLine: "多摩都市モノレール線" }
    ]
  },
  "八王子": {
    nameKana: "はちおうじ",
    interchanges: [
      { toOperator: "京王", toLine: "京王線", toStationName: "京王八王子" }
    ]
  }
});
===== FILE: station_metadata\line_sobu_joban.js =====
// 総武・常磐系メタデータ
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "北千住": {
    nameKana: "きたせんじゅ",
    interchanges: [
      { toOperator: "東京メトロ", toLine: "千代田線" },
      { toOperator: "東京メトロ", toLine: "日比谷線" },
      { toOperator: "東武", toLine: "伊勢崎線" },
      { toOperator: "首都圏新都市鉄道", toLine: "つくばエクスプレス" }
    ]
  },
  "松戸": {
    nameKana: "まつど",
    interchanges: [
      { toOperator: "新京成", toLine: "新京成線" }
    ]
  },
  "柏": {
    nameKana: "かしわ",
    interchanges: [
      { toOperator: "東武", toLine: "野田線" }
    ]
  },
  "錦糸町": {
    nameKana: "きんしちょう",
    interchanges: [
      { toOperator: "東京メトロ", toLine: "半蔵門線" }
    ]
  },
  "西船橋": {
    nameKana: "にしふなばし",
    interchanges: [
      { toOperator: "東京メトロ", toLine: "東西線" },
      { toOperator: "東葉高速鉄道", toLine: "東葉高速線" }
    ]
  },
  "船橋": {
    nameKana: "ふなばし",
    interchanges: [
      { toOperator: "東武", toLine: "野田線" },
      { toOperator: "京成", toLine: "本線", toStationName: "京成船橋" }
    ]
  },
  "津田沼": {
    nameKana: "つだぬま",
    interchanges: [
      { toOperator: "新京成", toLine: "新京成線", toStationName: "新津田沼" }
    ]
  },
  "千葉": {
    nameKana: "ちば",
    interchanges: [
      { toOperator: "千葉都市モノレール", toLine: "1号線" },
      { toOperator: "千葉都市モノレール", toLine: "2号線" }
    ]
  }
});
===== FILE: station_metadata\line_tohoku_shinetsu.js =====
// 東北・信越系メタデータ
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "仙台": {
    nameKana: "せんだい",
    interchanges: [
      { toOperator: "仙台市地下鉄", toLine: "南北線" },
      { toOperator: "仙台市地下鉄", toLine: "東西線" }
    ]
  },
  "盛岡": {
    nameKana: "もりおか",
    interchanges: [
      { toOperator: "IGRいわて銀河鉄道", toLine: "いわて銀河鉄道線" }
    ]
  },
  "新潟": {
    nameKana: "にいがた"
  },
  "長野": {
    nameKana: "ながの",
    interchanges: [
      { toOperator: "長野電鉄", toLine: "長野線" }
    ]
  }
});
===== FILE: station_metadata\line_yamanote.js =====
// 山手線系メタデータ
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "東京": { nameKana: "とうきょう", interchanges: [{ toOperator: "JR東日本", toLine: "各線" }, { toOperator: "東京メトロ", toLine: "丸ノ内線" }] },
  "有楽町": { nameKana: "ゆうらくちょう", interchanges: [{ toOperator: "東京メトロ", toLine: "有楽町線" }, { toOperator: "東京メトロ", toLine: "日比谷線" }] },
  "新橋": { nameKana: "しんばし", interchanges: [{ toOperator: "JR東日本", toLine: "東海道線" }, { toOperator: "JR東日本", toLine: "横須賀線" }, { toOperator: "東京メトロ", toLine: "銀座線" }, { toOperator: "都営", toLine: "浅草線" }] },
  "浜松町": { nameKana: "はままつちょう", interchanges: [{ toOperator: "東京モノレール", toLine: "東京モノレール線" }] },
  "田町": { nameKana: "たまち", interchanges: [{ toOperator: "都営", toLine: "浅草線", toStationName: "三田駅" }] },
  "高輪ゲートウェイ": { nameKana: "たかなわげーとうぇい" },
  "品川": { nameKana: "しながわ", interchanges: [{ toOperator: "JR東日本", toLine: "東海道線" }, { toOperator: "JR東日本", toLine: "横須賀線" }, { toOperator: "JR東日本", toLine: "京浜東北線" }, { toOperator: "京急", toLine: "本線" }] },
  "大崎": { nameKana: "おおさき", interchanges: [{ toOperator: "JR東日本", toLine: "埼京線" }, { toOperator: "JR東日本", toLine: "湘南新宿ライン" }, { toOperator: "東京臨海高速鉄道", toLine: "りんかい線" }] },
  "五反田": { nameKana: "ごたんだ", interchanges: [{ toOperator: "東急", toLine: "池上線" }, { toOperator: "都営", toLine: "浅草線" }] },
  "目黒": { nameKana: "めぐろ", interchanges: [{ toOperator: "東急", toLine: "目黒線" }, { toOperator: "東京メトロ", toLine: "南北線" }, { toOperator: "都営", toLine: "三田線" }] },
  "恵比寿": { nameKana: "えびす", interchanges: [{ toOperator: "JR東日本", toLine: "湘南新宿ライン" }, { toOperator: "東京メトロ", toLine: "日比谷線" }] },
  "渋谷": { nameKana: "しぶや", interchanges: [{ toOperator: "JR東日本", toLine: "埼京線" }, { toOperator: "JR東日本", toLine: "湘南新宿ライン" }, { toOperator: "東急", toLine: "東横線ほか多数" }] },
  "原宿": { nameKana: "はらじゅく", interchanges: [{ toOperator: "東京メトロ", toLine: "千代田線", toStationName: "明治神宮前" }, { toOperator: "東京メトロ", toLine: "副都心線", toStationName: "明治神宮前" }] },
  "代々木": { nameKana: "よよぎ", interchanges: [{ toOperator: "JR東日本", toLine: "中央・総武緩行線" }, { toOperator: "都営", toLine: "大江戸線" }] },
  "新宿": { nameKana: "しんじゅく", interchanges: [{ toOperator: "JR東日本", toLine: "中央線" }, { toOperator: "JR東日本", toLine: "埼京線ほか" }, { toOperator: "京王電鉄", toLine: "京王線" }, { toOperator: "小田急電鉄", toLine: "小田原線" }, { toOperator: "東京メトロ", toLine: "地下鉄多数" }] },
  "新大久保": { nameKana: "しんおおくぼ" },
  "高田馬場": { nameKana: "たかだのばば", interchanges: [{ toOperator: "西武鉄道", toLine: "新宿線" }, { toOperator: "東京メトロ", toLine: "東西線" }] },
  "目白": { nameKana: "めじろ" },
  "池袋": { nameKana: "いけぶくろ", interchanges: [{ toOperator: "東武鉄道", toLine: "東上線" }, { toOperator: "西武鉄道", toLine: "池袋線" }, { toOperator: "東京メトロ", toLine: "各線" }] },
  "大塚": { nameKana: "おおつか", interchanges: [{ toOperator: "都電荒川線", toLine: "東京さくらトラム" }] },
  "巣鴨": { nameKana: "すがも", interchanges: [{ toOperator: "都営", toLine: "三田線" }] },
  "駒込": { nameKana: "こまごめ", interchanges: [{ toOperator: "東京メトロ", toLine: "南北線" }] },
  "田端": { nameKana: "たばた", interchanges: [{ toOperator: "JR東日本", toLine: "京浜東北線" }] },
  "西日暮里": { nameKana: "にしにっぽり", interchanges: [{ toOperator: "京成電鉄", toLine: "本線" }, { toOperator: "東京メトロ", toLine: "千代田線" }] },
  "日暮里": { nameKana: "にっぽり", interchanges: [{ toOperator: "京成電鉄", toLine: "本線" }, { toOperator: "日暮里・舎人ライナー", toLine: "日暮里・舎人ライナー" }] },
  "鶯谷": { nameKana: "うぐいすだに" },
  "上野": { nameKana: "うえの", interchanges: [{ toOperator: "JR東日本", toLine: "高崎線" }, { toOperator: "JR東日本", toLine: "宇都宮線ほか" }, { toOperator: "東京メトロ", toLine: "銀座線" }, { toOperator: "東京メトロ", toLine: "日比谷線" }] },
  "御徒町": { nameKana: "おかちまち", interchanges: [{ toOperator: "東京メトロ", toLine: "銀座線", toStationName: "上野広小路" }, { toOperator: "他路線", toLine: "ほか" }] },
  "秋葉原": { nameKana: "あきはばら", interchanges: [{ toOperator: "JR東日本", toLine: "総武線" }, { toOperator: "東京メトロ", toLine: "日比谷線" }, { toOperator: "つくばエクスプレス", toLine: "つくばエクスプレス" }] },
  "神田": { nameKana: "かんだ", interchanges: [{ toOperator: "JR東日本", toLine: "中央線" }, { toOperator: "JR東日本", toLine: "京浜東北線" }, { toOperator: "東京メトロ", toLine: "銀座線" }] }
});

===== FILE: station_metadata\lines\kanto_agatsuma.js =====
// 路線別メタデータ: 吾妻線（関東）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "渋川": { nameKana: "しぶかわ" },
  "中之条": { nameKana: "なかのじょう" },
  "長野原草津口": { nameKana: "ながのはらくさつぐち" },
  "万座・鹿沢口": { nameKana: "まんざ・かざわぐち" },
  "大前": { nameKana: "おおまえ" }
});
===== FILE: station_metadata\lines\kanto_chuo_main.js =====
// 路線別メタデータ: 中央本線（関東）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "新宿": { nameKana: "しんじゅく", interchanges: [{ toOperator: "東京メトロ", toLine: "丸ノ内線" }, { toOperator: "都営", toLine: "新宿線" }, { toOperator: "都営", toLine: "大江戸線" }, { toOperator: "小田急", toLine: "小田原線" }, { toOperator: "京王", toLine: "京王線" }] },
  "立川": { nameKana: "たちかわ", interchanges: [{ toOperator: "多摩都市モノレール", toLine: "多摩都市モノレール線" }] },
  "八王子": { nameKana: "はちおうじ", interchanges: [{ toOperator: "京王", toLine: "京王線", toStationName: "京王八王子" }] },
  "高尾": { nameKana: "たかお", interchanges: [{ toOperator: "京王", toLine: "高尾線" }] },
  "大月": { nameKana: "おおつき", interchanges: [{ toOperator: "富士急行", toLine: "大月線" }] },
  "甲府": { nameKana: "こうふ" }
});
===== FILE: station_metadata\lines\kanto_chuo_rapid.js =====
// 路線別メタデータ: 中央線快速電車（関東）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "東京": { nameKana: "とうきょう", interchanges: [{ toOperator: "東京メトロ", toLine: "丸ノ内線" }] },
  "神田": { nameKana: "かんだ", interchanges: [{ toOperator: "東京メトロ", toLine: "銀座線" }] },
  "御茶ノ水": { nameKana: "おちゃのみず", interchanges: [{ toOperator: "東京メトロ", toLine: "丸ノ内線" }] },
  "四ツ谷": { nameKana: "よつや", interchanges: [{ toOperator: "東京メトロ", toLine: "丸ノ内線" }, { toOperator: "東京メトロ", toLine: "南北線" }] },
  "新宿": { nameKana: "しんじゅく", interchanges: [{ toOperator: "東京メトロ", toLine: "丸ノ内線" }, { toOperator: "都営", toLine: "新宿線" }, { toOperator: "都営", toLine: "大江戸線" }, { toOperator: "小田急", toLine: "小田原線" }, { toOperator: "京王", toLine: "京王線" }] },
  "中野": { nameKana: "なかの", interchanges: [{ toOperator: "東京メトロ", toLine: "東西線" }] },
  "荻窪": { nameKana: "おぎくぼ", interchanges: [{ toOperator: "東京メトロ", toLine: "丸ノ内線" }] },
  "吉祥寺": { nameKana: "きちじょうじ", interchanges: [{ toOperator: "京王", toLine: "井の頭線" }] },
  "三鷹": { nameKana: "みたか" },
  "国分寺": { nameKana: "こくぶんじ", interchanges: [{ toOperator: "西武", toLine: "国分寺線" }, { toOperator: "西武", toLine: "多摩湖線" }] },
  "立川": { nameKana: "たちかわ", interchanges: [{ toOperator: "多摩都市モノレール", toLine: "多摩都市モノレール線" }] },
  "八王子": { nameKana: "はちおうじ", interchanges: [{ toOperator: "京王", toLine: "京王線", toStationName: "京王八王子" }] },
  "西八王子": { nameKana: "にしはちおうじ" },
  "高尾": { nameKana: "たかお", interchanges: [{ toOperator: "京王", toLine: "高尾線" }] }
});
===== FILE: station_metadata\lines\kanto_chuo_sobu_local.js =====
// 路線別メタデータ: 中央・総武各駅停車（関東）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "三鷹": { nameKana: "みたか" },
  "中野": { nameKana: "なかの", interchanges: [{ toOperator: "東京メトロ", toLine: "東西線" }] },
  "新宿": { nameKana: "しんじゅく", interchanges: [{ toOperator: "東京メトロ", toLine: "丸ノ内線" }, { toOperator: "都営", toLine: "新宿線" }, { toOperator: "都営", toLine: "大江戸線" }, { toOperator: "小田急", toLine: "小田原線" }, { toOperator: "京王", toLine: "京王線" }] },
  "四ツ谷": { nameKana: "よつや", interchanges: [{ toOperator: "東京メトロ", toLine: "丸ノ内線" }, { toOperator: "東京メトロ", toLine: "南北線" }] },
  "御茶ノ水": { nameKana: "おちゃのみず", interchanges: [{ toOperator: "東京メトロ", toLine: "丸ノ内線" }] },
  "秋葉原": { nameKana: "あきはばら", interchanges: [{ toOperator: "東京メトロ", toLine: "日比谷線" }, { toOperator: "つくばエクスプレス", toLine: "常磐新線" }] },
  "錦糸町": { nameKana: "きんしちょう", interchanges: [{ toOperator: "東京メトロ", toLine: "半蔵門線" }] },
  "亀戸": { nameKana: "かめいど", interchanges: [{ toOperator: "東武", toLine: "亀戸線" }] },
  "平井": { nameKana: "ひらい" },
  "新小岩": { nameKana: "しんこいわ" },
  "小岩": { nameKana: "こいわ" },
  "市川": { nameKana: "いちかわ" },
  "本八幡": { nameKana: "もとやわた", interchanges: [{ toOperator: "都営", toLine: "新宿線" }, { toOperator: "京成", toLine: "本線", toStationName: "京成八幡" }] },
  "下総中山": { nameKana: "しもうさなかやま" },
  "西船橋": { nameKana: "にしふなばし", interchanges: [{ toOperator: "東京メトロ", toLine: "東西線" }, { toOperator: "東葉高速鉄道", toLine: "東葉高速線" }] }
});
===== FILE: station_metadata\lines\kanto_hachiko.js =====
// 路線別メタデータ: 八高線（関東）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "八王子": { nameKana: "はちおうじ", interchanges: [{ toOperator: "京王", toLine: "京王線", toStationName: "京王八王子" }] },
  "拝島": { nameKana: "はいじま", interchanges: [{ toOperator: "西武", toLine: "拝島線" }] },
  "高麗川": { nameKana: "こまがわ" },
  "寄居": { nameKana: "よりい", interchanges: [{ toOperator: "東武", toLine: "東上線" }, { toOperator: "秩父鉄道", toLine: "秩父本線" }] },
  "高崎": { nameKana: "たかさき", interchanges: [{ toOperator: "上信電鉄", toLine: "上信線" }] }
});
===== FILE: station_metadata\lines\kanto_ito.js =====
// 路線別メタデータ: 伊東線（関東）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "熱海": {"nameKana":"あたみ"},
  "来宮": {"nameKana":"きのみや"},
  "伊豆多賀": {"nameKana":"いずたが"},
  "網代": {"nameKana":"あじろ"},
  "宇佐美": {"nameKana":"うさみ"},
  "伊東": {"nameKana":"いとう"}
});
===== FILE: station_metadata\lines\kanto_itsukaichi.js =====
// 路線別メタデータ: 五日市線（関東）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "拝島": { nameKana: "はいじま", interchanges: [{ toOperator: "西武", toLine: "拝島線" }] },
  "武蔵五日市": { nameKana: "むさしいつかいち" }
});
===== FILE: station_metadata\lines\kanto_joban_local.js =====
// 路線別メタデータ: 常磐線各駅停車（関東）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "綾瀬": { nameKana: "あやせ", interchanges: [{ toOperator: "東京メトロ", toLine: "千代田線" }] },
  "亀有": { nameKana: "かめあり" },
  "金町": { nameKana: "かなまち", interchanges: [{ toOperator: "京成", toLine: "金町線", toStationName: "京成金町" }] },
  "松戸": { nameKana: "まつど", interchanges: [{ toOperator: "新京成", toLine: "新京成線" }] },
  "北松戸": { nameKana: "きたまつど" },
  "馬橋": { nameKana: "まばし", interchanges: [{ toOperator: "流鉄", toLine: "流山線" }] },
  "新松戸": { nameKana: "しんまつど", interchanges: [{ toOperator: "流鉄", toLine: "流山線" }] },
  "北小金": { nameKana: "きたこがね" },
  "南柏": { nameKana: "みなみかしわ" },
  "柏": { nameKana: "かしわ", interchanges: [{ toOperator: "東武", toLine: "野田線" }] },
  "北柏": { nameKana: "きたかしわ" },
  "我孫子": { nameKana: "あびこ" },
  "天王台": { nameKana: "てんのうだい" },
  "取手": { nameKana: "とりで", interchanges: [{ toOperator: "関東鉄道", toLine: "常総線" }] }
});
===== FILE: station_metadata\lines\kanto_joban_rapid.js =====
// 路線別メタデータ: 常磐線快速電車（関東）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "品川": { nameKana: "しながわ", interchanges: [{ toOperator: "京急", toLine: "本線" }] },
  "新橋": { nameKana: "しんばし", interchanges: [{ toOperator: "都営", toLine: "浅草線" }, { toOperator: "東京メトロ", toLine: "銀座線" }, { toOperator: "ゆりかもめ", toLine: "東京臨海新交通臨海線" }] },
  "東京": { nameKana: "とうきょう", interchanges: [{ toOperator: "東京メトロ", toLine: "丸ノ内線" }] },
  "上野": { nameKana: "うえの", interchanges: [{ toOperator: "東京メトロ", toLine: "銀座線" }, { toOperator: "東京メトロ", toLine: "日比谷線" }] },
  "日暮里": { nameKana: "にっぽり", interchanges: [{ toOperator: "京成", toLine: "本線" }] },
  "北千住": { nameKana: "きたせんじゅ", interchanges: [{ toOperator: "東京メトロ", toLine: "千代田線" }, { toOperator: "東京メトロ", toLine: "日比谷線" }, { toOperator: "東武", toLine: "伊勢崎線" }, { toOperator: "首都圏新都市鉄道", toLine: "つくばエクスプレス" }] },
  "松戸": { nameKana: "まつど", interchanges: [{ toOperator: "新京成", toLine: "新京成線" }] },
  "柏": { nameKana: "かしわ", interchanges: [{ toOperator: "東武", toLine: "野田線" }] },
  "我孫子": { nameKana: "あびこ" },
  "取手": { nameKana: "とりで", interchanges: [{ toOperator: "関東鉄道", toLine: "常総線" }] }
});
===== FILE: station_metadata\lines\kanto_joban.js =====
// 路線別メタデータ: 常磐線（関東）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "上野": { nameKana: "うえの", interchanges: [{ toOperator: "東京メトロ", toLine: "銀座線" }, { toOperator: "東京メトロ", toLine: "日比谷線" }] },
  "日暮里": { nameKana: "にっぽり", interchanges: [{ toOperator: "京成", toLine: "本線" }] },
  "三河島": { nameKana: "みかわしま" },
  "南千住": { nameKana: "みなみせんじゅ", interchanges: [{ toOperator: "東京メトロ", toLine: "日比谷線" }, { toOperator: "首都圏新都市鉄道", toLine: "つくばエクスプレス" }] },
  "北千住": { nameKana: "きたせんじゅ", interchanges: [{ toOperator: "東京メトロ", toLine: "千代田線" }, { toOperator: "東京メトロ", toLine: "日比谷線" }, { toOperator: "東武", toLine: "伊勢崎線" }, { toOperator: "首都圏新都市鉄道", toLine: "つくばエクスプレス" }] },
  "松戸": { nameKana: "まつど", interchanges: [{ toOperator: "新京成", toLine: "新京成線" }] },
  "柏": { nameKana: "かしわ", interchanges: [{ toOperator: "東武", toLine: "野田線" }] },
  "我孫子": { nameKana: "あびこ" },
  "取手": { nameKana: "とりで", interchanges: [{ toOperator: "関東鉄道", toLine: "常総線" }] },
  "藤代": { nameKana: "ふじしろ" },
  "龍ケ崎市": { nameKana: "りゅうがさきし" },
  "牛久": { nameKana: "うしく" },
  "ひたち野うしく": { nameKana: "ひたちのうしく" },
  "荒川沖": { nameKana: "あらかわおき" },
  "土浦": { nameKana: "つちうら" },
  "石岡": { nameKana: "いしおか" },
  "友部": { nameKana: "ともべ" },
  "赤塚": { nameKana: "あかつか" },
  "水戸": { nameKana: "みと", interchanges: [{ toOperator: "鹿島臨海鉄道", toLine: "大洗鹿島線" }] }
});
===== FILE: station_metadata\lines\kanto_joetsu.js =====
// 路線別メタデータ: 上越線（関東）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "高崎": { nameKana: "たかさき", interchanges: [{ toOperator: "上信電鉄", toLine: "上信線" }] },
  "新前橋": { nameKana: "しんまえばし" },
  "渋川": { nameKana: "しぶかわ" },
  "沼田": { nameKana: "ぬまた" },
  "水上": { nameKana: "みなかみ" }
});
===== FILE: station_metadata\lines\kanto_karasuyama.js =====
// 路線別メタデータ: 烏山線（関東）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "宝積寺": { nameKana: "ほうしゃくじ" },
  "烏山": { nameKana: "からすやま" }
});
===== FILE: station_metadata\lines\kanto_kashima.js =====
// 路線別メタデータ: 鹿島線（関東）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "佐原": { nameKana: "さわら" },
  "十二橋": { nameKana: "じゅうにきょう" },
  "潮来": { nameKana: "いたこ" },
  "鹿島神宮": { nameKana: "かしまじんぐう", interchanges: [{ toOperator: "鹿島臨海鉄道", toLine: "大洗鹿島線" }] }
});
===== FILE: station_metadata\lines\kanto_kawagoe.js =====
// 路線別メタデータ: 川越線（関東）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "大宮": { nameKana: "おおみや", interchanges: [{ toOperator: "東武", toLine: "野田線" }, { toOperator: "埼玉新都市交通", toLine: "伊奈線" }] },
  "川越": { nameKana: "かわごえ", interchanges: [{ toOperator: "東武", toLine: "東上線" }, { toOperator: "西武", toLine: "新宿線", toStationName: "本川越" }] },
  "高麗川": { nameKana: "こまがわ" }
});
===== FILE: station_metadata\lines\kanto_keihin_tohoku.js =====
// 路線別メタデータ: 京浜東北線（関東）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "大宮": {"nameKana":"おおみや","interchanges":[{"toOperator":"東武","toLine":"野田線"},{"toOperator":"埼玉新都市交通","toLine":"伊奈線"}]},
  "さいたま新都心": {"nameKana":"さいたましんとしん"},
  "与野": {"nameKana":"よの"},
  "北浦和": {"nameKana":"きたうらわ"},
  "浦和": {"nameKana":"うらわ"},
  "南浦和": {"nameKana":"みなみうらわ"},
  "蕨": {"nameKana":"わらび"},
  "西川口": {"nameKana":"にしかわぐち"},
  "川口": {"nameKana":"かわぐち"},
  "赤羽": {"nameKana":"あかばね"},
  "東十条": {"nameKana":"ひがしじゅうじょう"},
  "王子": {"nameKana":"おうじ","interchanges":[{"toOperator":"東京メトロ","toLine":"南北線"},{"toOperator":"都電","toLine":"荒川線","toStationName":"王子駅前"}]},
  "上中里": {"nameKana":"かみなかざと"},
  "田端": {"nameKana":"たばた"},
  "西日暮里": {"nameKana":"にしにっぽり","interchanges":[{"toOperator":"東京メトロ","toLine":"千代田線"}]},
  "日暮里": {"nameKana":"にっぽり","interchanges":[{"toOperator":"京成","toLine":"本線"}]},
  "鶯谷": {"nameKana":"うぐいすだに"},
  "上野": {"nameKana":"うえの","interchanges":[{"toOperator":"東京メトロ","toLine":"銀座線"},{"toOperator":"東京メトロ","toLine":"日比谷線"}]},
  "御徒町": {"nameKana":"おかちまち","interchanges":[{"toOperator":"東京メトロ","toLine":"日比谷線","toStationName":"仲御徒町"}]},
  "秋葉原": {"nameKana":"あきはばら","interchanges":[{"toOperator":"東京メトロ","toLine":"日比谷線"},{"toOperator":"つくばエクスプレス","toLine":"常磐新線"}]},
  "神田": {"nameKana":"かんだ","interchanges":[{"toOperator":"東京メトロ","toLine":"銀座線"}]},
  "東京": {"nameKana":"とうきょう","interchanges":[{"toOperator":"東京メトロ","toLine":"丸ノ内線"}]},
  "有楽町": {"nameKana":"ゆうらくちょう","interchanges":[{"toOperator":"東京メトロ","toLine":"有楽町線"}]},
  "新橋": {"nameKana":"しんばし","interchanges":[{"toOperator":"都営","toLine":"浅草線"},{"toOperator":"東京メトロ","toLine":"銀座線"},{"toOperator":"ゆりかもめ","toLine":"東京臨海新交通臨海線"}]},
  "浜松町": {"nameKana":"はままつちょう","interchanges":[{"toOperator":"東京モノレール","toLine":"東京モノレール羽田空港線"},{"toOperator":"都営","toLine":"大江戸線","toStationName":"大門"},{"toOperator":"都営","toLine":"浅草線","toStationName":"大門"}]},
  "田町": {"nameKana":"たまち","interchanges":[{"toOperator":"都営","toLine":"浅草線","toStationName":"三田"},{"toOperator":"都営","toLine":"三田線","toStationName":"三田"}]},
  "高輪ゲートウェイ": {"nameKana":"たかなわげーとうぇい"},
  "品川": {"nameKana":"しながわ","interchanges":[{"toOperator":"京急","toLine":"本線"}]},
  "大井町": {"nameKana":"おおいまち","interchanges":[{"toOperator":"東急","toLine":"大井町線"},{"toOperator":"東京臨海高速鉄道","toLine":"りんかい線"}]},
  "大森": {"nameKana":"おおもり"},
  "蒲田": {"nameKana":"かまた","interchanges":[{"toOperator":"東急","toLine":"池上線"},{"toOperator":"東急","toLine":"多摩川線"}]},
  "川崎": {"nameKana":"かわさき","interchanges":[{"toOperator":"京急","toLine":"本線","toStationName":"京急川崎"}]},
  "鶴見": {"nameKana":"つるみ","interchanges":[{"toOperator":"京急","toLine":"本線","toStationName":"京急鶴見"}]},
  "新子安": {"nameKana":"しんこやす","interchanges":[{"toOperator":"京急","toLine":"本線","toStationName":"京急新子安"}]},
  "東神奈川": {"nameKana":"ひがしかながわ","interchanges":[{"toOperator":"京急","toLine":"本線","toStationName":"京急東神奈川"}]},
  "横浜": {"nameKana":"よこはま","interchanges":[{"toOperator":"東急","toLine":"東横線"},{"toOperator":"京急","toLine":"本線"},{"toOperator":"相鉄","toLine":"本線"},{"toOperator":"横浜市営地下鉄","toLine":"ブルーライン"},{"toOperator":"みなとみらい線","toLine":"みなとみらい線"}]},
  "桜木町": {"nameKana":"さくらぎちょう","interchanges":[{"toOperator":"横浜市営地下鉄","toLine":"ブルーライン"}]},
  "関内": {"nameKana":"かんない","interchanges":[{"toOperator":"横浜市営地下鉄","toLine":"ブルーライン"}]},
  "石川町": {"nameKana":"いしかわちょう"},
  "山手": {"nameKana":"やまて"},
  "根岸": {"nameKana":"ねぎし"},
  "磯子": {"nameKana":"いそご"},
  "新杉田": {"nameKana":"しんすぎた","interchanges":[{"toOperator":"横浜シーサイドライン","toLine":"金沢シーサイドライン"}]},
  "洋光台": {"nameKana":"ようこうだい"},
  "港南台": {"nameKana":"こうなんだい"},
  "本郷台": {"nameKana":"ほんごうだい"},
  "大船": {"nameKana":"おおふな","interchanges":[{"toOperator":"湘南モノレール","toLine":"江の島線"}]}
});
===== FILE: station_metadata\lines\kanto_keiyo.js =====
// 路線別メタデータ: 京葉線（関東）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "東京": { nameKana: "とうきょう", interchanges: [{ toOperator: "JR東日本", toLine: "山手線" }, { toOperator: "JR東日本", toLine: "中央線" }, { toOperator: "JR東日本", toLine: "東海道線" }, { toOperator: "JR東日本", toLine: "ほか多数" }, { toOperator: "東京メトロ", toLine: "丸ノ内線" }] },
  "八丁堀": { nameKana: "はっちょうぼり", interchanges: [{ toOperator: "東京メトロ", toLine: "日比谷線" }] },
  "越中島": { nameKana: "えっちゅうじま" },
  "潮見": { nameKana: "しおみ" },
  "新木場": { nameKana: "しんきば", interchanges: [{ toOperator: "東京メトロ", toLine: "有楽町線" }, { toOperator: "東京臨海高速鉄道", toLine: "りんかい線" }] },
  "葛西臨海公園": { nameKana: "かさいりんかいこうえん" },
  "舞浜": { nameKana: "まいはま", interchanges: [{ toOperator: "東京ディズニーリゾート", toLine: "最寄" }] },
  "新浦安": { nameKana: "しんうらやす" },
  "市川塩浜": { nameKana: "いちかわしおはま" },
  "西船橋": { nameKana: "にしふなばし", interchanges: [{ toOperator: "JR東日本", toLine: "武蔵野線" }, { toOperator: "JR東日本", toLine: "総武線（各駅停車）" }, { toOperator: "東京メトロ", toLine: "東西線" }, { toOperator: "東葉高速鉄道", toLine: "東葉高速線" }] },
  "二俣新町": { nameKana: "ふたまたしんまち" },
  "南船橋": { nameKana: "みなみふなばし", interchanges: [{ toOperator: "京葉線", toLine: "支線分岐" }] },
  "新習志野": { nameKana: "しんならしの" },
  "幕張豊砂": { nameKana: "まくはりとよすな" },
  "海浜幕張": { nameKana: "かいひんまくはり" },
  "検見川浜": { nameKana: "けみがわはま" },
  "稲毛海岸": { nameKana: "いなげかいがん" },
  "千葉みなと": { nameKana: "ちばみなと", interchanges: [{ toOperator: "千葉都市モノレール", toLine: "1号線" }] },
  "蘇我": { nameKana: "そが", interchanges: [{ toOperator: "JR東日本", toLine: "内房線" }, { toOperator: "JR東日本", toLine: "外房線" }] }
});
===== FILE: station_metadata\lines\kanto_koumi.js =====
// 路線別メタデータ: 小海線（関東）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "小淵沢": { nameKana: "こぶちざわ" },
  "野辺山": { nameKana: "のべやま" },
  "小諸": { nameKana: "こもろ" }
});
===== FILE: station_metadata\lines\kanto_kururi.js =====
// 路線別メタデータ: 久留里線（関東）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "木更津": { nameKana: "きさらづ" },
  "横田": { nameKana: "よこた" },
  "久留里": { nameKana: "くるり" },
  "上総亀山": { nameKana: "かずさかめやま" }
});
===== FILE: station_metadata\lines\kanto_mito.js =====
// 路線別メタデータ: 水戸線（関東）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "小山": { nameKana: "おやま" },
  "下館": { nameKana: "しもだて", interchanges: [{ toOperator: "真岡鐵道", toLine: "真岡線" }] },
  "友部": { nameKana: "ともべ" }
});
===== FILE: station_metadata\lines\kanto_monorail.js =====
// 路線別メタデータ: 東京モノレール線（関東）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "浜松町": {
    nameKana: "はままつちょう",
    interchanges: [
      { toOperator: "都営", toLine: "大江戸線", toStationName: "大門" },
      { toOperator: "都営", toLine: "浅草線", toStationName: "大門" },
      { toOperator: "JR東日本", toLine: "山手線" },
      { toOperator: "JR東日本", toLine: "京浜東北線" }
    ]
  },
  "天王洲アイル": {
    nameKana: "てんのうずあいる",
    interchanges: [
      { toOperator: "東京臨海高速鉄道", toLine: "りんかい線" }
    ]
  },
  "大井競馬場前": {
    nameKana: "おおいけいばじょうまえ"
  },
  "流通センター": {
    nameKana: "りゅうつうせんたー"
  },
  "羽田空港第1ターミナル": {
    nameKana: "はねだくうこうだいいちたーみなる"
  },
  "羽田空港第2ターミナル": {
    nameKana: "はねだくうこうだいにたーみなる"
  }
});
===== FILE: station_metadata\lines\kanto_musashino.js =====
// 路線別メタデータ: 武蔵野線（関東）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "府中本町": { nameKana: "ふちゅうほんまち", interchanges: [{ toOperator: "JR東日本", toLine: "南武線" }] },
  "北府中": { nameKana: "きたふちゅう" },
  "西国分寺": { nameKana: "にしこくぶんじ", interchanges: [{ toOperator: "JR東日本", toLine: "中央線" }] },
  "新小平": { nameKana: "しんこだいら" },
  "新秋津": { nameKana: "しんあきつ", interchanges: [{ toOperator: "西武鉄道", toLine: "池袋線", toStationName: "秋津駅" }] },
  "東所沢": { nameKana: "ひがしところざわ" },
  "新座": { nameKana: "にいざ" },
  "北朝霞": { nameKana: "きたあさか", interchanges: [{ toOperator: "東武鉄道", toLine: "東上線", toStationName: "朝霞台駅" }] },
  "西浦和": { nameKana: "にしうらわ" },
  "武蔵浦和": { nameKana: "むさしうらわ", interchanges: [{ toOperator: "JR東日本", toLine: "埼京線" }] },
  "南浦和": { nameKana: "みなみうらわ", interchanges: [{ toOperator: "JR東日本", toLine: "京浜東北線" }] },
  "東浦和": { nameKana: "ひがしうらわ" },
  "東川口": { nameKana: "ひがしかわぐち", interchanges: [{ toOperator: "埼玉高速鉄道", toLine: "埼玉高速鉄道線", toStationName: "埼玉スタジアム線" }] },
  "南越谷": { nameKana: "みなみこしがや", interchanges: [{ toOperator: "東武鉄道", toLine: "伊勢崎線", toStationName: "東武スカイツリーライン／新越谷駅" }] },
  "越谷レイクタウン": { nameKana: "こしがやれいくたうん" },
  "吉川": { nameKana: "よしかわ" },
  "吉川美南": { nameKana: "よしかわみなみ" },
  "新三郷": { nameKana: "しんみさと" },
  "三郷": { nameKana: "みさと" },
  "南流山": { nameKana: "みなみながれやま", interchanges: [{ toOperator: "首都圏新都市鉄道", toLine: "つくばエクスプレス" }] },
  "新松戸": { nameKana: "しんまつど", interchanges: [{ toOperator: "JR東日本", toLine: "常磐線（各駅停車）" }, { toOperator: "流鉄", toLine: "流山線", toStationName: "幸谷駅" }] },
  "新八柱": { nameKana: "しんやはしら", interchanges: [{ toOperator: "京成電鉄", toLine: "松戸線", toStationName: "八柱駅" }] },
  "東松戸": { nameKana: "ひがしまつど", interchanges: [{ toOperator: "北総鉄道", toLine: "北総線" }, { toOperator: "京成電鉄", toLine: "成田空港線", toStationName: "成田スカイアクセス線" }] },
  "市川大野": { nameKana: "いちかわおおの" },
  "船橋法典": { nameKana: "ふなばしほうてん" },
  "西船橋": { nameKana: "にしふなばし", interchanges: [{ toOperator: "JR東日本", toLine: "京葉線" }, { toOperator: "JR東日本", toLine: "総武線（各駅停車）" }, { toOperator: "東京メトロ", toLine: "東西線" }, { toOperator: "東葉高速鉄道", toLine: "東葉高速線" }] }
});
===== FILE: station_metadata\lines\kanto_nambu.js =====
// 路線別メタデータ: 南武線（関東）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "川崎": {"nameKana":"かわさき","interchanges":[{"toOperator":"京急","toLine":"本線","toStationName":"京急川崎"}]},
  "尻手": {"nameKana":"しって"},
  "矢向": {"nameKana":"やこう"},
  "鹿島田": {"nameKana":"かしまだ"},
  "平間": {"nameKana":"ひらま"},
  "向河原": {"nameKana":"むかいがわら"},
  "武蔵小杉": {"nameKana":"むさしこすぎ","interchanges":[{"toOperator":"東急","toLine":"東横線"},{"toOperator":"東急","toLine":"目黒線"}]},
  "武蔵中原": {"nameKana":"むさしなかはら"},
  "武蔵新城": {"nameKana":"むさししんじょう"},
  "武蔵溝ノ口": {"nameKana":"むさしみぞのくち","interchanges":[{"toOperator":"東急","toLine":"田園都市線","toStationName":"溝の口"},{"toOperator":"東急","toLine":"大井町線","toStationName":"溝の口"}]},
  "津田山": {"nameKana":"つだやま"},
  "久地": {"nameKana":"くじ"},
  "宿河原": {"nameKana":"しゅくがわら"},
  "登戸": {"nameKana":"のぼりと","interchanges":[{"toOperator":"小田急","toLine":"小田原線"}]},
  "中野島": {"nameKana":"なかのしま"},
  "稲田堤": {"nameKana":"いなだづつみ","interchanges":[{"toOperator":"京王","toLine":"相模原線","toStationName":"京王稲田堤"}]},
  "矢野口": {"nameKana":"やのくち"},
  "稲城長沼": {"nameKana":"いなぎながぬま"},
  "南多摩": {"nameKana":"みなみたま"},
  "府中本町": {"nameKana":"ふちゅうほんまち"},
  "分倍河原": {"nameKana":"ぶばいがわら","interchanges":[{"toOperator":"京王","toLine":"京王線"}]},
  "西府": {"nameKana":"にしふ"},
  "谷保": {"nameKana":"やほ"},
  "矢川": {"nameKana":"やがわ"},
  "西国立": {"nameKana":"にしくにたち"},
  "立川": {"nameKana":"たちかわ","interchanges":[{"toOperator":"多摩都市モノレール","toLine":"多摩都市モノレール線"}]}
});
===== FILE: station_metadata\lines\kanto_narita.js =====
// 路線別メタデータ: 成田線（関東）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "千葉": { nameKana: "ちば", interchanges: [{ toOperator: "千葉都市モノレール", toLine: "1号線" }, { toOperator: "千葉都市モノレール", toLine: "2号線" }] },
  "成田": { nameKana: "なりた", interchanges: [{ toOperator: "京成", toLine: "本線", toStationName: "京成成田" }] },
  "佐原": { nameKana: "さわら" },
  "銚子": { nameKana: "ちょうし", interchanges: [{ toOperator: "銚子電気鉄道", toLine: "銚子電気鉄道線" }] }
});
===== FILE: station_metadata\lines\kanto_nikko.js =====
// 路線別メタデータ: 日光線（関東）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "宇都宮": { nameKana: "うつのみや", interchanges: [{ toOperator: "宇都宮ライトレール", toLine: "宇都宮芳賀ライトレール線" }] },
  "日光": { nameKana: "にっこう", interchanges: [{ toOperator: "東武", toLine: "日光線", toStationName: "東武日光" }] }
});
===== FILE: station_metadata\lines\kanto_ome.js =====
// 路線別メタデータ: 青梅線（関東）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "立川": { nameKana: "たちかわ", interchanges: [{ toOperator: "多摩都市モノレール", toLine: "多摩都市モノレール線" }] },
  "拝島": { nameKana: "はいじま", interchanges: [{ toOperator: "西武", toLine: "拝島線" }] },
  "青梅": { nameKana: "おうめ" },
  "奥多摩": { nameKana: "おくたま" }
});
===== FILE: station_metadata\lines\kanto_ryomo.js =====
// 路線別メタデータ: 両毛線（関東）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "高崎": { nameKana: "たかさき", interchanges: [{ toOperator: "上信電鉄", toLine: "上信線" }] },
  "前橋": { nameKana: "まえばし" },
  "桐生": { nameKana: "きりゅう", interchanges: [{ toOperator: "わたらせ渓谷鐵道", toLine: "わたらせ渓谷線" }] },
  "足利": { nameKana: "あしかが" },
  "小山": { nameKana: "おやま" }
});
===== FILE: station_metadata\lines\kanto_sagami.js =====
// 路線別メタデータ: 相模線（関東）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "茅ケ崎": {"nameKana":"ちがさき"},
  "北茅ケ崎": {"nameKana":"きたちがさき"},
  "香川": {"nameKana":"かがわ"},
  "寒川": {"nameKana":"さむかわ"},
  "宮山": {"nameKana":"みややま"},
  "倉見": {"nameKana":"くらみ"},
  "門沢橋": {"nameKana":"かどさわばし"},
  "社家": {"nameKana":"しゃけ"},
  "厚木": {"nameKana":"あつぎ","interchanges":[{"toOperator":"小田急","toLine":"小田原線"}]},
  "海老名": {"nameKana":"えびな","interchanges":[{"toOperator":"小田急","toLine":"小田原線"},{"toOperator":"相鉄","toLine":"本線"}]},
  "入谷": {"nameKana":"いりや"},
  "相武台下": {"nameKana":"そうぶだいした"},
  "下溝": {"nameKana":"しもみぞ"},
  "原当麻": {"nameKana":"はらたいま"},
  "番田": {"nameKana":"ばんだ"},
  "上溝": {"nameKana":"かみみぞ"},
  "南橋本": {"nameKana":"みなみはしもと"},
  "橋本": {"nameKana":"はしもと","interchanges":[{"toOperator":"京王","toLine":"相模原線"}]}
});
===== FILE: station_metadata\lines\kanto_saikyo.js =====
// 路線別メタデータ: 埼京線（関東）
// 上り（大宮→大崎）/下り（大崎→大宮）

window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "大崎": { nameKana: "おおさき", interchanges: [{ toOperator: "JR東日本", toLine: "山手線" }, { toOperator: "JR東日本", toLine: "湘南新宿ライン" }, { toOperator: "東京臨海高速鉄道", toLine: "りんかい線", toStationName: "直通例あり" }] },
  "恵比寿": { nameKana: "えびす", interchanges: [{ toOperator: "JR東日本", toLine: "山手線" }] },
  "渋谷": { nameKana: "しぶや", interchanges: [{ toOperator: "JR東日本", toLine: "山手線" }, { toOperator: "JR東日本", toLine: "湘南新宿ライン" }] },
  "新宿": { nameKana: "しんじゅく", interchanges: [{ toOperator: "JR東日本", toLine: "山手線" }, { toOperator: "JR東日本", toLine: "中央線" }, { toOperator: "JR東日本", toLine: "中央・総武緩行線" }, { toOperator: "JR東日本", toLine: "湘南新宿ライン" }, { toOperator: "JR東日本", toLine: "他各線" }, { toOperator: "京王電鉄", toLine: "京王線" }, { toOperator: "小田急電鉄", toLine: "小田原線" }, { toOperator: "西武鉄道", toLine: "西武新宿線" }, { toOperator: "東京メトロ", toLine: "各線" }] },
  "池袋": { nameKana: "いけぶくろ", interchanges: [{ toOperator: "JR東日本", toLine: "山手線" }, { toOperator: "東京メトロ", toLine: "各線" }, { toOperator: "東武鉄道", toLine: "東上線" }, { toOperator: "西武鉄道", toLine: "池袋線" }] },
  "板橋": { nameKana: "いたばし" },
  "十条": { nameKana: "じゅうじょう" },
  "赤羽": { nameKana: "あかばね", interchanges: [{ toOperator: "JR東日本", toLine: "京浜東北線" }, { toOperator: "JR東日本", toLine: "高崎線" }, { toOperator: "JR東日本", toLine: "宇都宮線" }] },
  "北赤羽": { nameKana: "きたあかばね" },
  "浮間舟渡": { nameKana: "うきまふなと" },
  "戸田公園": { nameKana: "とだこうえん" },
  "戸田": { nameKana: "とだ" },
  "北戸田": { nameKana: "きたとだ" },
  "武蔵浦和": { nameKana: "むさしうらわ", interchanges: [{ toOperator: "JR東日本", toLine: "武蔵野線" }] },
  "中浦和": { nameKana: "なかうらわ" },
  "南与野": { nameKana: "みなみよの" },
  "与野本町": { nameKana: "よのほんまち" },
  "さいたま新都心": { nameKana: "さいたましんとしん" },
  "大宮": { nameKana: "おおみや", interchanges: [{ toOperator: "JR東日本", toLine: "東北線" }, { toOperator: "JR東日本", toLine: "高崎線" }, { toOperator: "JR東日本", toLine: "宇都宮線" }, { toOperator: "JR東日本", toLine: "京浜東北線" }, { toOperator: "JR東日本", toLine: "川越線" }, { toOperator: "JR東日本", toLine: "他多数" }] }
});
===== FILE: station_metadata\lines\kanto_shinetsu_main.js =====
// 路線別メタデータ: 信越本線（関東）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "高崎": { nameKana: "たかさき", interchanges: [{ toOperator: "上信電鉄", toLine: "上信線" }] },
  "安中": { nameKana: "あんなか" },
  "磯部": { nameKana: "いそべ" },
  "横川": { nameKana: "よこかわ" }
});
===== FILE: station_metadata\lines\kanto_sobu_main.js =====
// 路線別メタデータ: 総武本線（関東）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "千葉": { nameKana: "ちば", interchanges: [{ toOperator: "千葉都市モノレール", toLine: "1号線" }, { toOperator: "千葉都市モノレール", toLine: "2号線" }] },
  "佐倉": { nameKana: "さくら" },
  "成東": { nameKana: "なるとう" },
  "八日市場": { nameKana: "ようかいちば" },
  "銚子": { nameKana: "ちょうし", interchanges: [{ toOperator: "銚子電気鉄道", toLine: "銚子電気鉄道線" }] }
});
===== FILE: station_metadata\lines\kanto_sobu_rapid.js =====
// 路線別メタデータ: 総武快速線（関東）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "東京": { nameKana: "とうきょう", interchanges: [{ toOperator: "東京メトロ", toLine: "丸ノ内線" }] },
  "新橋": { nameKana: "しんばし", interchanges: [{ toOperator: "都営", toLine: "浅草線" }, { toOperator: "東京メトロ", toLine: "銀座線" }, { toOperator: "ゆりかもめ", toLine: "東京臨海新交通臨海線" }] },
  "品川": { nameKana: "しながわ", interchanges: [{ toOperator: "京急", toLine: "本線" }] },
  "錦糸町": { nameKana: "きんしちょう", interchanges: [{ toOperator: "東京メトロ", toLine: "半蔵門線" }] },
  "新小岩": { nameKana: "しんこいわ" },
  "市川": { nameKana: "いちかわ" },
  "船橋": { nameKana: "ふなばし", interchanges: [{ toOperator: "東武", toLine: "野田線" }, { toOperator: "京成", toLine: "本線", toStationName: "京成船橋" }] },
  "津田沼": { nameKana: "つだぬま", interchanges: [{ toOperator: "新京成", toLine: "新京成線", toStationName: "新津田沼" }] },
  "稲毛": { nameKana: "いなげ" },
  "千葉": { nameKana: "ちば", interchanges: [{ toOperator: "千葉都市モノレール", toLine: "1号線" }, { toOperator: "千葉都市モノレール", toLine: "2号線" }] }
});
===== FILE: station_metadata\lines\kanto_sotobo.js =====
// 路線別メタデータ: 外房線（関東）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "千葉": { nameKana: "ちば", interchanges: [{ toOperator: "千葉都市モノレール", toLine: "1号線" }, { toOperator: "千葉都市モノレール", toLine: "2号線" }] },
  "蘇我": { nameKana: "そが" },
  "鎌取": { nameKana: "かまとり" },
  "誉田": { nameKana: "ほんだ" },
  "土気": { nameKana: "とけ" },
  "大網": { nameKana: "おおあみ" },
  "茂原": { nameKana: "もばら" },
  "上総一ノ宮": { nameKana: "かずさいちのみや" },
  "勝浦": { nameKana: "かつうら" },
  "安房鴨川": { nameKana: "あわかもがわ" }
});
===== FILE: station_metadata\lines\kanto_suigun.js =====
// 路線別メタデータ: 水郡線（関東）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "水戸": { nameKana: "みと", interchanges: [{ toOperator: "鹿島臨海鉄道", toLine: "大洗鹿島線" }] },
  "常陸大子": { nameKana: "ひたちだいご" },
  "郡山": { nameKana: "こおりやま" }
});
===== FILE: station_metadata\lines\kanto_takasaki.js =====
// 路線別メタデータ: 高崎線（関東）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "東京": { nameKana: "とうきょう", interchanges: [{ toOperator: "東京メトロ", toLine: "丸ノ内線" }] },
  "上野": { nameKana: "うえの", interchanges: [{ toOperator: "東京メトロ", toLine: "銀座線" }, { toOperator: "東京メトロ", toLine: "日比谷線" }] },
  "尾久": { nameKana: "おく" },
  "赤羽": { nameKana: "あかばね" },
  "浦和": { nameKana: "うらわ" },
  "さいたま新都心": { nameKana: "さいたましんとしん" },
  "大宮": { nameKana: "おおみや", interchanges: [{ toOperator: "東武", toLine: "野田線" }, { toOperator: "埼玉新都市交通", toLine: "伊奈線" }] },
  "宮原": { nameKana: "みやはら" },
  "上尾": { nameKana: "あげお" },
  "北上尾": { nameKana: "きたあげお" },
  "桶川": { nameKana: "おけがわ" },
  "鴻巣": { nameKana: "こうのす" },
  "熊谷": { nameKana: "くまがや", interchanges: [{ toOperator: "秩父鉄道", toLine: "秩父本線" }] },
  "籠原": { nameKana: "かごはら" },
  "深谷": { nameKana: "ふかや" },
  "本庄": { nameKana: "ほんじょう" },
  "新町": { nameKana: "しんまち" },
  "倉賀野": { nameKana: "くらがの" },
  "高崎": { nameKana: "たかさき", interchanges: [{ toOperator: "上信電鉄", toLine: "上信線" }] }
});
===== FILE: station_metadata\lines\kanto_togane.js =====
// 路線別メタデータ: 東金線（関東）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "大網": { nameKana: "おおあみ" },
  "東金": { nameKana: "とうがね" },
  "成東": { nameKana: "なるとう" }
});
===== FILE: station_metadata\lines\kanto_tokaido.js =====
// 路線別メタデータ: 東海道線（関東）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "東京": {"nameKana":"とうきょう","interchanges":[{"toOperator":"東京メトロ","toLine":"丸ノ内線"}]},
  "新橋": {"nameKana":"しんばし","interchanges":[{"toOperator":"都営","toLine":"浅草線"},{"toOperator":"東京メトロ","toLine":"銀座線"},{"toOperator":"ゆりかもめ","toLine":"東京臨海新交通臨海線"}]},
  "品川": {"nameKana":"しながわ","interchanges":[{"toOperator":"京急","toLine":"本線"}]},
  "川崎": {"nameKana":"かわさき","interchanges":[{"toOperator":"京急","toLine":"本線","toStationName":"京急川崎"}]},
  "横浜": {"nameKana":"よこはま","interchanges":[{"toOperator":"東急","toLine":"東横線"},{"toOperator":"京急","toLine":"本線"},{"toOperator":"相鉄","toLine":"本線"},{"toOperator":"横浜市営地下鉄","toLine":"ブルーライン"},{"toOperator":"みなとみらい線","toLine":"みなとみらい線"}]},
  "戸塚": {"nameKana":"とつか","interchanges":[{"toOperator":"横浜市営地下鉄","toLine":"ブルーライン"}]},
  "大船": {"nameKana":"おおふな","interchanges":[{"toOperator":"湘南モノレール","toLine":"江の島線"}]},
  "藤沢": {"nameKana":"ふじさわ","interchanges":[{"toOperator":"小田急","toLine":"江ノ島線"},{"toOperator":"江ノ島電鉄","toLine":"江ノ島電鉄線"}]},
  "辻堂": {"nameKana":"つじどう"},
  "茅ケ崎": {"nameKana":"ちがさき"},
  "平塚": {"nameKana":"ひらつか"},
  "大磯": {"nameKana":"おおいそ"},
  "二宮": {"nameKana":"にのみや"},
  "国府津": {"nameKana":"こうづ"},
  "鴨宮": {"nameKana":"かものみや"},
  "小田原": {"nameKana":"おだわら","interchanges":[{"toOperator":"小田急","toLine":"小田原線"},{"toOperator":"箱根登山鉄道","toLine":"鉄道線"},{"toOperator":"伊豆箱根鉄道","toLine":"大雄山線"}]},
  "早川": {"nameKana":"はやかわ"},
  "根府川": {"nameKana":"ねぶかわ"},
  "真鶴": {"nameKana":"まなづる"},
  "湯河原": {"nameKana":"ゆがわら"},
  "熱海": {"nameKana":"あたみ"}
});
===== FILE: station_metadata\lines\kanto_tsurumi.js =====
// 路線別メタデータ: 鶴見線（関東）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "鶴見": {"nameKana":"つるみ","interchanges":[{"toOperator":"京急","toLine":"本線","toStationName":"京急鶴見"}]},
  "国道": {"nameKana":"こくどう"},
  "鶴見小野": {"nameKana":"つるみおの"},
  "弁天橋": {"nameKana":"べんてんばし"},
  "浅野": {"nameKana":"あさの"},
  "安善": {"nameKana":"あんぜん"},
  "武蔵白石": {"nameKana":"むさししらいし"},
  "浜川崎": {"nameKana":"はまかわさき"},
  "昭和": {"nameKana":"しょうわ"},
  "扇町": {"nameKana":"おうぎまち"},
  "新芝浦": {"nameKana":"しんしばうら"},
  "海芝浦": {"nameKana":"うみしばうら"},
  "大川": {"nameKana":"おおかわ"}
});
===== FILE: station_metadata\lines\kanto_uchibo.js =====
// 路線別メタデータ: 内房線（関東）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "蘇我": { nameKana: "そが" },
  "浜野": { nameKana: "はまの" },
  "八幡宿": { nameKana: "やわたじゅく" },
  "五井": { nameKana: "ごい", interchanges: [{ toOperator: "小湊鐵道", toLine: "小湊鉄道線" }] },
  "姉ケ崎": { nameKana: "あねがさき" },
  "木更津": { nameKana: "きさらづ" },
  "君津": { nameKana: "きみつ" },
  "富浦": { nameKana: "とみうら" },
  "那古船形": { nameKana: "なこふなかた" },
  "館山": { nameKana: "たてやま" },
  "千倉": { nameKana: "ちくら" },
  "安房鴨川": { nameKana: "あわかもがわ" }
});
===== FILE: station_metadata\lines\kanto_utsunomiya.js =====
// 路線別メタデータ: 宇都宮線（関東）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "東京": { nameKana: "とうきょう", interchanges: [{ toOperator: "東京メトロ", toLine: "丸ノ内線" }] },
  "上野": { nameKana: "うえの", interchanges: [{ toOperator: "東京メトロ", toLine: "銀座線" }, { toOperator: "東京メトロ", toLine: "日比谷線" }] },
  "尾久": { nameKana: "おく" },
  "赤羽": { nameKana: "あかばね" },
  "浦和": { nameKana: "うらわ" },
  "さいたま新都心": { nameKana: "さいたましんとしん" },
  "大宮": { nameKana: "おおみや", interchanges: [{ toOperator: "東武", toLine: "野田線" }, { toOperator: "埼玉新都市交通", toLine: "伊奈線" }] },
  "蓮田": { nameKana: "はすだ" },
  "久喜": { nameKana: "くき", interchanges: [{ toOperator: "東武", toLine: "伊勢崎線" }] },
  "古河": { nameKana: "こが" },
  "小山": { nameKana: "おやま" },
  "自治医大": { nameKana: "じちいだい" },
  "石橋": { nameKana: "いしばし" },
  "雀宮": { nameKana: "すずめのみや" },
  "宇都宮": { nameKana: "うつのみや", interchanges: [{ toOperator: "宇都宮ライトレール", toLine: "宇都宮芳賀ライトレール線" }] }
});
===== FILE: station_metadata\lines\kanto_yokohama.js =====
// 路線別メタデータ: 横浜線（関東）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "東神奈川": {"nameKana":"ひがしかながわ","interchanges":[{"toOperator":"京急","toLine":"本線","toStationName":"京急東神奈川"}]},
  "大口": {"nameKana":"おおぐち"},
  "菊名": {"nameKana":"きくな","interchanges":[{"toOperator":"東急","toLine":"東横線"}]},
  "新横浜": {"nameKana":"しんよこはま","interchanges":[{"toOperator":"横浜市営地下鉄","toLine":"ブルーライン"},{"toOperator":"相鉄","toLine":"相鉄新横浜線"},{"toOperator":"東急","toLine":"新横浜線"}]},
  "小机": {"nameKana":"こづくえ"},
  "鴨居": {"nameKana":"かもい"},
  "中山": {"nameKana":"なかやま","interchanges":[{"toOperator":"横浜市営地下鉄","toLine":"グリーンライン"}]},
  "十日市場": {"nameKana":"とおかいちば"},
  "長津田": {"nameKana":"ながつた","interchanges":[{"toOperator":"東急","toLine":"田園都市線"},{"toOperator":"東急","toLine":"こどもの国線"}]},
  "成瀬": {"nameKana":"なるせ"},
  "町田": {"nameKana":"まちだ","interchanges":[{"toOperator":"小田急","toLine":"小田原線"}]},
  "古淵": {"nameKana":"こぶち"},
  "淵野辺": {"nameKana":"ふちのべ"},
  "矢部": {"nameKana":"やべ"},
  "相模原": {"nameKana":"さがみはら"},
  "橋本": {"nameKana":"はしもと","interchanges":[{"toOperator":"京王","toLine":"相模原線"}]},
  "相原": {"nameKana":"あいはら"},
  "八王子みなみ野": {"nameKana":"はちおうじみなみの"},
  "片倉": {"nameKana":"かたくら"},
  "八王子": {"nameKana":"はちおうじ","interchanges":[{"toOperator":"京王","toLine":"京王線","toStationName":"京王八王子"}]}
});
===== FILE: station_metadata\lines\kanto_yokosuka.js =====
// 路線別メタデータ: 横須賀線（関東）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "東京": {"nameKana":"とうきょう","interchanges":[{"toOperator":"東京メトロ","toLine":"丸ノ内線"}]},
  "新橋": {"nameKana":"しんばし","interchanges":[{"toOperator":"都営","toLine":"浅草線"},{"toOperator":"東京メトロ","toLine":"銀座線"},{"toOperator":"ゆりかもめ","toLine":"東京臨海新交通臨海線"}]},
  "品川": {"nameKana":"しながわ","interchanges":[{"toOperator":"京急","toLine":"本線"}]},
  "西大井": {"nameKana":"にしおおい"},
  "武蔵小杉": {"nameKana":"むさしこすぎ","interchanges":[{"toOperator":"東急","toLine":"東横線"},{"toOperator":"東急","toLine":"目黒線"}]},
  "新川崎": {"nameKana":"しんかわさき"},
  "横浜": {"nameKana":"よこはま","interchanges":[{"toOperator":"東急","toLine":"東横線"},{"toOperator":"京急","toLine":"本線"},{"toOperator":"相鉄","toLine":"本線"},{"toOperator":"横浜市営地下鉄","toLine":"ブルーライン"},{"toOperator":"みなとみらい線","toLine":"みなとみらい線"}]},
  "保土ケ谷": {"nameKana":"ほどがや"},
  "東戸塚": {"nameKana":"ひがしとつか"},
  "戸塚": {"nameKana":"とつか","interchanges":[{"toOperator":"横浜市営地下鉄","toLine":"ブルーライン"}]},
  "大船": {"nameKana":"おおふな","interchanges":[{"toOperator":"湘南モノレール","toLine":"江の島線"}]},
  "北鎌倉": {"nameKana":"きたかまくら"},
  "鎌倉": {"nameKana":"かまくら","interchanges":[{"toOperator":"江ノ島電鉄","toLine":"江ノ島電鉄線"}]},
  "逗子": {"nameKana":"ずし","interchanges":[{"toOperator":"京急","toLine":"逗子線","toStationName":"逗子・葉山"}]},
  "東逗子": {"nameKana":"ひがしずし"},
  "田浦": {"nameKana":"たうら"},
  "横須賀": {"nameKana":"よこすか"},
  "衣笠": {"nameKana":"きぬがさ"},
  "久里浜": {"nameKana":"くりはま"}
});
===== FILE: station_metadata\lines\shinetsu_banetsu_west.js =====
// 路線別メタデータ: 磐越西線（信越/新潟支社）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "新津": {"nameKana":"にいつ"},
  "津川": {"nameKana":"つがわ"},
  "野沢": {"nameKana":"のざわ"},
  "日出谷": {"nameKana":"ひでや"},
  "荻野": {"nameKana":"おぎの"},
  "会津若松": {"nameKana":"あいづわかまつ","interchanges":[{"toOperator":"会津鉄道","toLine":"会津線"}]},
});
===== FILE: station_metadata\lines\shinetsu_echigo.js =====
// 路線別メタデータ: 越後線（信越/新潟支社）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "柏崎": {"nameKana":"かしわざき"},
  "吉田": {"nameKana":"よしだ"},
  "内野": {"nameKana":"うちの"},
  "新潟": {"nameKana":"にいがた"},
});
===== FILE: station_metadata\lines\shinetsu_gono.js =====
// 路線別メタデータ: 五能線（信越/能代方）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "東能代": {"nameKana":"ひがしのしろ"},
  "深浦": {"nameKana":"ふかうら"},
  "鰺ケ沢": {"nameKana":"あじがさわ"},
  "五所川原": {"nameKana":"ごしょがわら","interchanges":[{"toOperator":"津軽鉄道","toLine":"津軽鉄道線"}]},
  "弘前": {"nameKana":"ひろさき","interchanges":[{"toOperator":"弘南鉄道","toLine":"弘南線"}]},
});
===== FILE: station_metadata\lines\shinetsu_hakushin.js =====
// 路線別メタデータ: 白新線（信越/新潟支社）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "新潟": {"nameKana":"にいがた"},
  "豊栄": {"nameKana":"とよさか"},
  "新発田": {"nameKana":"しばた"},
});
===== FILE: station_metadata\lines\shinetsu_iiyama.js =====
// 路線別メタデータ: 飯山線（信越/長野支社）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "長野": {"nameKana":"ながの","interchanges":[{"toOperator":"長野電鉄","toLine":"長野線"}]},
  "豊野": {"nameKana":"とよの","interchanges":[{"toOperator":"しなの鉄道","toLine":"北しなの線"}]},
  "飯山": {"nameKana":"いいやま"},
  "戸狩野沢温泉": {"nameKana":"とがりのざわおんせん"},
  "森宮野原": {"nameKana":"もりみやのはら"},
  "十日町": {"nameKana":"とおかまち","interchanges":[{"toOperator":"北越急行","toLine":"ほくほく線"}]},
  "越後川口": {"nameKana":"えちごかわぐち"},
});
===== FILE: station_metadata\lines\shinetsu_joetsu.js =====
// 路線別メタデータ: 上越線（信越/高崎・越後湯沢側）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "高崎": {"nameKana":"たかさき","interchanges":[{"toOperator":"上信電鉄","toLine":"上信線"}]},
  "渋川": {"nameKana":"しぶかわ"},
  "水上": {"nameKana":"みなかみ"},
  "越後湯沢": {"nameKana":"えちごゆざわ","interchanges":[{"toOperator":"北越急行","toLine":"ほくほく線"}]},
  "小千谷": {"nameKana":"おぢや"},
  "長岡": {"nameKana":"ながおか"},
});
===== FILE: station_metadata\lines\shinetsu_koshinetsu_chuo_main.js =====
// 路線別メタデータ: 中央本線（信越/長野支社）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "小淵沢": {"nameKana":"こぶちざわ"},
  "富士見": {"nameKana":"ふじみ"},
  "上諏訪": {"nameKana":"かみすわ"},
  "岡谷": {"nameKana":"おかや"},
  "塩尻": {"nameKana":"しおじり"},
  "松本": {"nameKana":"まつもと","interchanges":[{"toOperator":"アルピコ交通","toLine":"上高地線"}]},
});
===== FILE: station_metadata\lines\shinetsu_koumi.js =====
// 路線別メタデータ: 小海線（信越/長野支社）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "小淵沢": {"nameKana":"こぶちざわ"},
  "野辺山": {"nameKana":"のべやま"},
  "小海": {"nameKana":"こうみ"},
  "小諸": {"nameKana":"こもろ","interchanges":[{"toOperator":"しなの鉄道","toLine":"しなの鉄道線"}]},
});
===== FILE: station_metadata\lines\shinetsu_oito.js =====
// 路線別メタデータ: 大糸線（信越/長野支社）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "松本": {"nameKana":"まつもと","interchanges":[{"toOperator":"アルピコ交通","toLine":"上高地線"}]},
  "信濃大町": {"nameKana":"しなのおおまち"},
  "白馬": {"nameKana":"はくば"},
  "南小谷": {"nameKana":"みなみおたり"},
});
===== FILE: station_metadata\lines\shinetsu_shinetsu_main.js =====
// 路線別メタデータ: 信越本線（信越/新潟支社）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "直江津": {"nameKana":"なおえつ","interchanges":[{"toOperator":"えちごトキめき鉄道","toLine":"妙高はねうまライン"},{"toOperator":"えちごトキめき鉄道","toLine":"日本海ひすいライン"}]},
  "柿崎": {"nameKana":"かきざき"},
  "柏崎": {"nameKana":"かしわざき"},
  "長岡": {"nameKana":"ながおか"},
  "見附": {"nameKana":"みつけ"},
  "東三条": {"nameKana":"ひがしさんじょう"},
  "新津": {"nameKana":"にいつ"},
  "新潟": {"nameKana":"にいがた"},
});
===== FILE: station_metadata\lines\shinetsu_shinonoi.js =====
// 路線別メタデータ: 篠ノ井線（信越/長野支社）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "松本": {"nameKana":"まつもと","interchanges":[{"toOperator":"アルピコ交通","toLine":"上高地線"}]},
  "明科": {"nameKana":"あかしな"},
  "姨捨": {"nameKana":"おばすて"},
  "篠ノ井": {"nameKana":"しののい"},
});
===== FILE: station_metadata\lines\shinetsu_tadami.js =====
// 路線別メタデータ: 只見線（信越/新潟支社）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "只見": {"nameKana":"ただみ"},
  "大白川": {"nameKana":"おおしらかわ"},
  "小出": {"nameKana":"こいで"},
});
===== FILE: station_metadata\lines\shinetsu_uetsu.js =====
// 路線別メタデータ: 羽越本線（信越/新潟支社）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "新津": {"nameKana":"にいつ"},
  "新発田": {"nameKana":"しばた"},
  "中条": {"nameKana":"なかじょう"},
  "坂町": {"nameKana":"さかまち"},
  "村上": {"nameKana":"むらかみ"},
});
===== FILE: station_metadata\lines\shinetsu_yahiko.js =====
// 路線別メタデータ: 弥彦線（信越/新潟支社）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "東三条": {"nameKana":"ひがしさんじょう"},
  "燕三条": {"nameKana":"つばめさんじょう"},
  "吉田": {"nameKana":"よしだ"},
  "弥彦": {"nameKana":"やひこ"},
});
===== FILE: station_metadata\lines\shinetsu_yonesaka.js =====
// 路線別メタデータ: 米坂線（信越/新潟支社）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "坂町": {"nameKana":"さかまち"},
  "小国": {"nameKana":"おぐに"},
  "今泉": {"nameKana":"いまいずみ","interchanges":[{"toOperator":"山形鉄道","toLine":"フラワー長井線"}]},
  "米沢": {"nameKana":"よねざわ"},
});
===== FILE: station_metadata\lines\tohoku_aterazawa.js =====
// 路線別メタデータ: 左沢線（東北）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "山形": {"nameKana":"やまがた"},
  "寒河江": {"nameKana":"さがえ"},
  "左沢": {"nameKana":"あてらざわ"},
});
===== FILE: station_metadata\lines\tohoku_banetsu_east.js =====
// 路線別メタデータ: 磐越東線（東北）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "いわき": {"nameKana":"いわき"},
  "小野新町": {"nameKana":"おのにいまち"},
  "船引": {"nameKana":"ふねひき"},
  "郡山": {"nameKana":"こおりやま"},
});
===== FILE: station_metadata\lines\tohoku_banetsu_west.js =====
// 路線別メタデータ: 磐越西線（東北）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "郡山": {"nameKana":"こおりやま"},
  "磐梯熱海": {"nameKana":"ばんだいあたみ"},
  "猪苗代": {"nameKana":"いなわしろ"},
  "会津若松": {"nameKana":"あいづわかまつ","interchanges":[{"toOperator":"会津鉄道","toLine":"会津線"}]},
  "野沢": {"nameKana":"のざわ"},
  "日出谷": {"nameKana":"ひでや"},
  "荻野": {"nameKana":"おぎの"},
});
===== FILE: station_metadata\lines\tohoku_gono.js =====
// 路線別メタデータ: 五能線（東北）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "能代": {"nameKana":"のしろ"},
  "東能代": {"nameKana":"ひがしのしろ"},
  "深浦": {"nameKana":"ふかうら"},
  "鰺ケ沢": {"nameKana":"あじがさわ"},
  "五所川原": {"nameKana":"ごしょがわら","interchanges":[{"toOperator":"津軽鉄道","toLine":"津軽鉄道線"}]},
  "陸奥鶴田": {"nameKana":"むつつるだ"},
  "弘前": {"nameKana":"ひろさき","interchanges":[{"toOperator":"弘南鉄道","toLine":"弘南線"}]},
});
===== FILE: station_metadata\lines\tohoku_hachinohe.js =====
// 路線別メタデータ: 八戸線（東北）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "八戸": {"nameKana":"はちのへ","interchanges":[{"toOperator":"青い森鉄道","toLine":"青い森鉄道線"}]},
  "鮫": {"nameKana":"さめ"},
  "久慈": {"nameKana":"くじ","interchanges":[{"toOperator":"三陸鉄道","toLine":"リアス線"}]},
});
===== FILE: station_metadata\lines\tohoku_hanawa.js =====
// 路線別メタデータ: 花輪線（東北）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "好摩": {"nameKana":"こうま","interchanges":[{"toOperator":"IGRいわて銀河鉄道","toLine":"いわて銀河鉄道線"}]},
  "荒屋新町": {"nameKana":"あらやしんまち"},
  "鹿角花輪": {"nameKana":"かづのはなわ"},
  "大館": {"nameKana":"おおだて"},
});
===== FILE: station_metadata\lines\tohoku_ishinomaki.js =====
// 路線別メタデータ: 石巻線（東北）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "小牛田": {"nameKana":"こごた"},
  "前谷地": {"nameKana":"まえやち"},
  "石巻": {"nameKana":"いしのまき"},
  "女川": {"nameKana":"おながわ"},
});
===== FILE: station_metadata\lines\tohoku_joban.js =====
// 路線別メタデータ: 常磐線（東北）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "いわき": {"nameKana":"いわき"},
  "原ノ町": {"nameKana":"はらのまち"},
  "相馬": {"nameKana":"そうま"},
  "亘理": {"nameKana":"わたり"},
  "岩沼": {"nameKana":"いわぬま"},
  "仙台": {"nameKana":"せんだい","interchanges":[{"toOperator":"仙台市地下鉄","toLine":"南北線"},{"toOperator":"仙台市地下鉄","toLine":"東西線"}]},
});
===== FILE: station_metadata\lines\tohoku_kamaishi.js =====
// 路線別メタデータ: 釜石線（東北）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "花巻": {"nameKana":"はなまき"},
  "遠野": {"nameKana":"とおの"},
  "釜石": {"nameKana":"かまいし","interchanges":[{"toOperator":"三陸鉄道","toLine":"リアス線"}]},
});
===== FILE: station_metadata\lines\tohoku_kesennuma_brt.js =====
// 路線別メタデータ: 気仙沼線ＢＲＴ（東北）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "柳津": {"nameKana":"やないづ"},
  "陸前戸倉": {"nameKana":"りくぜんとぐら"},
  "清水浜": {"nameKana":"しずはま"},
  "歌津": {"nameKana":"うたつ"},
  "気仙沼": {"nameKana":"けせんぬま"},
});
===== FILE: station_metadata\lines\tohoku_kesennuma.js =====
// 路線別メタデータ: 気仙沼線（東北）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "小牛田": {"nameKana":"こごた"},
  "前谷地": {"nameKana":"まえやち"},
  "柳津": {"nameKana":"やないづ"},
  "気仙沼": {"nameKana":"けせんぬま"},
});
===== FILE: station_metadata\lines\tohoku_kitakami.js =====
// 路線別メタデータ: 北上線（東北）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "北上": {"nameKana":"きたかみ"},
  "ほっとゆだ": {"nameKana":"ほっとゆだ"},
  "横手": {"nameKana":"よこて"},
});
===== FILE: station_metadata\lines\tohoku_ofunato_brt.js =====
// 路線別メタデータ: 大船渡線ＢＲＴ（東北）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "気仙沼": {"nameKana":"けせんぬま"},
  "陸前高田": {"nameKana":"りくぜんたかた"},
  "盛": {"nameKana":"さかり","interchanges":[{"toOperator":"三陸鉄道","toLine":"リアス線"}]},
});
===== FILE: station_metadata\lines\tohoku_ofunato.js =====
// 路線別メタデータ: 大船渡線（東北）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "一ノ関": {"nameKana":"いちのせき"},
  "気仙沼": {"nameKana":"けせんぬま"},
  "盛": {"nameKana":"さかり","interchanges":[{"toOperator":"三陸鉄道","toLine":"リアス線"}]},
});
===== FILE: station_metadata\lines\tohoku_oga.js =====
// 路線別メタデータ: 男鹿線（東北）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "秋田": {"nameKana":"あきた"},
  "追分": {"nameKana":"おいわけ"},
  "男鹿": {"nameKana":"おが"},
});
===== FILE: station_metadata\lines\tohoku_omminato.js =====
// 路線別メタデータ: 大湊線（東北）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "野辺地": {"nameKana":"のへじ","interchanges":[{"toOperator":"青い森鉄道","toLine":"青い森鉄道線"}]},
  "下北": {"nameKana":"しもきた"},
  "大湊": {"nameKana":"おおみなと"},
});
===== FILE: station_metadata\lines\tohoku_ou_main_aomori_akita.js =====
// 路線別メタデータ: 奥羽本線（東北）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "青森": {"nameKana":"あおもり","interchanges":[{"toOperator":"青い森鉄道","toLine":"青い森鉄道線"}]},
  "弘前": {"nameKana":"ひろさき","interchanges":[{"toOperator":"弘南鉄道","toLine":"弘南線"}]},
  "大館": {"nameKana":"おおだて"},
  "鷹ノ巣": {"nameKana":"たかのす","interchanges":[{"toOperator":"秋田内陸縦貫鉄道","toLine":"秋田内陸線"}]},
  "秋田": {"nameKana":"あきた"},
  "福島": {"nameKana":"ふくしま","interchanges":[{"toOperator":"福島交通","toLine":"飯坂線"},{"toOperator":"阿武隈急行","toLine":"阿武隈急行線"}]},
  "米沢": {"nameKana":"よねざわ"},
  "高畠": {"nameKana":"たかはた"},
  "赤湯": {"nameKana":"あかゆ"},
  "かみのやま温泉": {"nameKana":"かみのやまおんせん"},
  "山形": {"nameKana":"やまがた"},
  "天童": {"nameKana":"てんどう"},
  "新庄": {"nameKana":"しんじょう"},
});
===== FILE: station_metadata\lines\tohoku_rikuu_east.js =====
// 路線別メタデータ: 陸羽東線（東北）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "小牛田": {"nameKana":"こごた"},
  "古川": {"nameKana":"ふるかわ"},
  "鳴子温泉": {"nameKana":"なるこおんせん"},
  "新庄": {"nameKana":"しんじょう"},
});
===== FILE: station_metadata\lines\tohoku_rikuu_west.js =====
// 路線別メタデータ: 陸羽西線（東北）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "新庄": {"nameKana":"しんじょう"},
  "余目": {"nameKana":"あまるめ"},
});
===== FILE: station_metadata\lines\tohoku_senseki_tohoku.js =====
// 路線別メタデータ: 仙石東北ライン（東北）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "仙台": {"nameKana":"せんだい","interchanges":[{"toOperator":"仙台市地下鉄","toLine":"南北線"},{"toOperator":"仙台市地下鉄","toLine":"東西線"}]},
  "塩釜": {"nameKana":"しおがま"},
  "高城町": {"nameKana":"たかぎまち"},
  "石巻": {"nameKana":"いしのまき"},
});
===== FILE: station_metadata\lines\tohoku_senseki.js =====
// 路線別メタデータ: 仙石線（東北）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "あおば通": {"nameKana":"あおばどおり"},
  "仙台": {"nameKana":"せんだい","interchanges":[{"toOperator":"仙台市地下鉄","toLine":"南北線"},{"toOperator":"仙台市地下鉄","toLine":"東西線"}]},
  "本塩釜": {"nameKana":"ほんしおがま"},
  "松島海岸": {"nameKana":"まつしまかいがん"},
  "高城町": {"nameKana":"たかぎまち"},
  "石巻": {"nameKana":"いしのまき"},
});
===== FILE: station_metadata\lines\tohoku_senzan.js =====
// 路線別メタデータ: 仙山線（東北）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "仙台": {"nameKana":"せんだい","interchanges":[{"toOperator":"仙台市地下鉄","toLine":"南北線"},{"toOperator":"仙台市地下鉄","toLine":"東西線"}]},
  "奥新川": {"nameKana":"おくにっかわ"},
  "面白山高原": {"nameKana":"おもしろやまこうげん"},
  "山寺": {"nameKana":"やまでら"},
  "山形": {"nameKana":"やまがた"},
});
===== FILE: station_metadata\lines\tohoku_suigun.js =====
// 路線別メタデータ: 水郡線（東北）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "水戸": {"nameKana":"みと","interchanges":[{"toOperator":"鹿島臨海鉄道","toLine":"大洗鹿島線"}]},
  "常陸大子": {"nameKana":"ひたちだいご"},
  "郡山": {"nameKana":"こおりやま"},
});
===== FILE: station_metadata\lines\tohoku_tadami.js =====
// 路線別メタデータ: 只見線（東北）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "会津若松": {"nameKana":"あいづわかまつ","interchanges":[{"toOperator":"会津鉄道","toLine":"会津線"}]},
  "会津坂下": {"nameKana":"あいづばんげ"},
  "会津川口": {"nameKana":"あいづかわぐち"},
  "只見": {"nameKana":"ただみ"},
  "大白川": {"nameKana":"おおしらかわ"},
  "小出": {"nameKana":"こいで"},
});
===== FILE: station_metadata\lines\tohoku_tazawako.js =====
// 路線別メタデータ: 田沢湖線（東北）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "盛岡": {"nameKana":"もりおか","interchanges":[{"toOperator":"IGRいわて銀河鉄道","toLine":"いわて銀河鉄道線"}]},
  "雫石": {"nameKana":"しずくいし"},
  "田沢湖": {"nameKana":"たざわこ"},
  "角館": {"nameKana":"かくのだて","interchanges":[{"toOperator":"秋田内陸縦貫鉄道","toLine":"秋田内陸線"}]},
  "大曲": {"nameKana":"おおまがり"},
});
===== FILE: station_metadata\lines\tohoku_tohoku_main.js =====
// 路線別メタデータ: 東北本線（東北）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "仙台": {"nameKana":"せんだい","interchanges":[{"toOperator":"仙台市地下鉄","toLine":"南北線"},{"toOperator":"仙台市地下鉄","toLine":"東西線"}]},
  "松島": {"nameKana":"まつしま"},
  "小牛田": {"nameKana":"こごた"},
  "一ノ関": {"nameKana":"いちのせき"},
  "北上": {"nameKana":"きたかみ"},
  "花巻": {"nameKana":"はなまき"},
  "盛岡": {"nameKana":"もりおか","interchanges":[{"toOperator":"IGRいわて銀河鉄道","toLine":"いわて銀河鉄道線"}]},
});
===== FILE: station_metadata\lines\tohoku_tsugaru.js =====
// 路線別メタデータ: 津軽線（東北）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "青森": {"nameKana":"あおもり","interchanges":[{"toOperator":"青い森鉄道","toLine":"青い森鉄道線"}]},
  "蟹田": {"nameKana":"かにた"},
  "三厩": {"nameKana":"みんまや"},
});
===== FILE: station_metadata\lines\tohoku_uetsu_northern.js =====
// 路線別メタデータ: 羽越本線（東北）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "秋田": {"nameKana":"あきた"},
  "羽後本荘": {"nameKana":"うごほんじょう"},
  "仁賀保": {"nameKana":"にかほ"},
  "酒田": {"nameKana":"さかた"},
});
===== FILE: station_metadata\lines\tohoku_yamada.js =====
// 路線別メタデータ: 山田線（東北）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "盛岡": {"nameKana":"もりおか","interchanges":[{"toOperator":"IGRいわて銀河鉄道","toLine":"いわて銀河鉄道線"}]},
  "茂市": {"nameKana":"もいち"},
  "宮古": {"nameKana":"みやこ","interchanges":[{"toOperator":"三陸鉄道","toLine":"リアス線"}]},
});
===== FILE: station_metadata\lines\tohoku_yonesaka.js =====
// 路線別メタデータ: 米坂線（東北）
window.stationMetadataChunks = window.stationMetadataChunks || {};
Object.assign(window.stationMetadataChunks, {
  "坂町": {"nameKana":"さかまち"},
  "小国": {"nameKana":"おぐに"},
  "今泉": {"nameKana":"いまいずみ"},
  "米沢": {"nameKana":"よねざわ"},
});
===== FILE: tools\check_station_completeness.js =====
const fs = require("fs");
const path = require("path");
const vm = require("vm");

const ROOT = process.cwd();
const REPORT_DIR = path.join(ROOT, "reports");
const REPORT_PATH = path.join(REPORT_DIR, "station_completeness.md");
const MASTER_PATH = path.join(ROOT, "station_master", "full_line_stations.json");

const DATA_FILES = [
  "data_kanto.js",
  "data_tohoku.js",
  "data_shinetsu.js",
  "data_limited.js",
  "data_shinkansen.js"
];

function loadLineData() {
  const ctx = { window: {} };
  vm.createContext(ctx);
  DATA_FILES.forEach((rel) => {
    const abs = path.join(ROOT, rel);
    if (!fs.existsSync(abs)) {
      return;
    }
    const code = fs.readFileSync(abs, "utf8");
    vm.runInContext(code, ctx, { filename: rel });
  });
  return ctx.window.railwayLinesDataChunks || {};
}

function lineRows(lines) {
  return Object.entries(lines)
    .map(([lineKey, line]) => {
      const stations = Array.isArray(line.stations) ? line.stations : [];
      return {
        lineKey,
        area: line.area || "",
        lineName: line.lineName || "",
        scope: line.scope || "",
        stationNames: stations.map((s) => String((s && s.name) || "")).filter(Boolean),
      };
    })
    .sort((a, b) => a.lineKey.localeCompare(b.lineKey, "ja"));
}

function readMasterOrNull() {
  if (!fs.existsSync(MASTER_PATH)) {
    return null;
  }
  return JSON.parse(fs.readFileSync(MASTER_PATH, "utf8"));
}

function compareWithMaster(rows, master) {
  const curMap = new Map(rows.map((r) => [r.lineKey, r]));
  const masterMap = new Map(Object.entries(master));

  const missingInMaster = [];
  const missingInCurrent = [];
  const lengthMismatch = [];
  const orderMismatch = [];

  curMap.forEach((row, lineKey) => {
    if (!masterMap.has(lineKey)) {
      missingInMaster.push(lineKey);
      return;
    }
    const expected = Array.isArray(masterMap.get(lineKey)) ? masterMap.get(lineKey) : [];
    if (expected.length !== row.stationNames.length) {
      lengthMismatch.push({
        lineKey,
        expected: expected.length,
        current: row.stationNames.length
      });
      return;
    }
    const same = expected.every((name, i) => name === row.stationNames[i]);
    if (!same) {
      orderMismatch.push(lineKey);
    }
  });

  masterMap.forEach((_, lineKey) => {
    if (!curMap.has(lineKey)) {
      missingInCurrent.push(lineKey);
    }
  });

  return {
    missingInMaster: missingInMaster.sort((a, b) => a.localeCompare(b, "ja")),
    missingInCurrent: missingInCurrent.sort((a, b) => a.localeCompare(b, "ja")),
    lengthMismatch: lengthMismatch.sort((a, b) => a.lineKey.localeCompare(b.lineKey, "ja")),
    orderMismatch: orderMismatch.sort((a, b) => a.localeCompare(b, "ja"))
  };
}

function buildReport(rows, master, diff) {
  const lines = [];
  lines.push("# 駅データ完全性レポート");
  lines.push("");
  lines.push(`- 生成日時: ${new Date().toISOString()}`);
  lines.push(`- 対象路線数: ${rows.length}`);
  lines.push("");

  if (!master) {
    lines.push("## 判定状態");
    lines.push("- `station_master/full_line_stations.json` が未作成のため、全駅網羅判定は未実施です。");
    lines.push("- まずは全路線の正規駅順を `full_line_stations.json` に投入してください。");
    lines.push("");
    lines.push("## 現在の登録駅数一覧");
    rows.forEach((r) => {
      lines.push(`- \`${r.lineKey}\` ${r.lineName}（${r.scope}）: ${r.stationNames.length}駅`);
    });
    return lines.join("\n") + "\n";
  }

  lines.push("## 判定状態");
  const ok =
    diff.missingInMaster.length === 0 &&
    diff.missingInCurrent.length === 0 &&
    diff.lengthMismatch.length === 0 &&
    diff.orderMismatch.length === 0;
  lines.push(ok ? "- 全路線が全駅マスタと一致しています。" : "- 不一致があります。以下を修正してください。");
  lines.push("");

  lines.push(`- マスタ未登録路線: ${diff.missingInMaster.length}`);
  lines.push(`- 現行未登録路線: ${diff.missingInCurrent.length}`);
  lines.push(`- 駅数不一致: ${diff.lengthMismatch.length}`);
  lines.push(`- 駅順不一致: ${diff.orderMismatch.length}`);
  lines.push("");

  if (diff.missingInMaster.length) {
    lines.push("### マスタ未登録路線");
    diff.missingInMaster.forEach((k) => lines.push(`- \`${k}\``));
    lines.push("");
  }
  if (diff.missingInCurrent.length) {
    lines.push("### 現行未登録路線");
    diff.missingInCurrent.forEach((k) => lines.push(`- \`${k}\``));
    lines.push("");
  }
  if (diff.lengthMismatch.length) {
    lines.push("### 駅数不一致");
    diff.lengthMismatch.forEach((d) => {
      lines.push(`- \`${d.lineKey}\`: current=${d.current}, expected=${d.expected}`);
    });
    lines.push("");
  }
  if (diff.orderMismatch.length) {
    lines.push("### 駅順不一致");
    diff.orderMismatch.forEach((k) => lines.push(`- \`${k}\``));
    lines.push("");
  }

  return lines.join("\n") + "\n";
}

function main() {
  const rows = lineRows(loadLineData());
  const master = readMasterOrNull();
  const diff = master ? compareWithMaster(rows, master) : null;

  if (!fs.existsSync(REPORT_DIR)) {
    fs.mkdirSync(REPORT_DIR, { recursive: true });
  }
  fs.writeFileSync(REPORT_PATH, buildReport(rows, master, diff), "utf8");

  if (!master) {
    console.log("WARN: master file not found:", MASTER_PATH);
    console.log("Generated:", REPORT_PATH);
    process.exitCode = 2;
    return;
  }

  const hasError =
    diff.missingInMaster.length ||
    diff.missingInCurrent.length ||
    diff.lengthMismatch.length ||
    diff.orderMismatch.length;
  console.log("Generated:", REPORT_PATH);
  if (hasError) {
    process.exitCode = 1;
  }
}

main();

===== FILE: tools\make_bundle.ps1 =====
param(
  [string]$Root = ".",
  [string]$OutFile = "out/bundle.txt",
  [string]$ReportFile = "out/bundle_report.txt",
  [int]$MaxFileSizeMB = 5,
  [string[]]$IncludePaths = @()
)

Set-StrictMode -Version Latest
$ErrorActionPreference = "Stop"

function Normalize-RelPath([string]$rootAbs, [string]$fileAbs) {
  $rel = [System.IO.Path]::GetRelativePath($rootAbs, $fileAbs)
  return $rel.Replace("/", "\")
}

function Should-ExcludeFile([string]$relPath) {
  $p = $relPath.ToLowerInvariant()
  $name = [System.IO.Path]::GetFileName($p)

  if ($p -like ".git\*" -or $p -eq ".git") { return $true }
  if ($p -like ".venv\*" -or $p -eq ".venv") { return $true }
  if ($p -like "venv\*" -or $p -eq "venv") { return $true }
  if ($p -like "__pycache__\*" -or $p -like "*\__pycache__\*") { return $true }
  if ($p -like "node_modules\*" -or $p -like "*\node_modules\*") { return $true }
  if ($p -like "dist\*" -or $p -like "*\dist\*") { return $true }
  if ($p -like "build\*" -or $p -like "*\build\*") { return $true }
  if ($p -like "out\*" -or $p -like "*\out\*") { return $true }
  if ($p -like ".pytest_cache\*" -or $p -like "*\.pytest_cache\*") { return $true }

  if ($name -like "*.pyc") { return $true }
  if ($name -like "*.log") { return $true }
  if ($name -like "*.tmp") { return $true }
  if ($name -eq ".env") { return $true }

  return $false
}

function Is-LikelyText([byte[]]$bytes) {
  if ($bytes.Length -eq 0) { return $true }
  foreach ($b in $bytes) {
    if ($b -eq 0) { return $false }
  }
  return $true
}

$rootAbs = [System.IO.Path]::GetFullPath($Root)
$outAbs = [System.IO.Path]::GetFullPath((Join-Path $rootAbs $OutFile))
$reportAbs = [System.IO.Path]::GetFullPath((Join-Path $rootAbs $ReportFile))
$maxBytes = $MaxFileSizeMB * 1MB

$outDir = [System.IO.Path]::GetDirectoryName($outAbs)
$reportDir = [System.IO.Path]::GetDirectoryName($reportAbs)
if ($outDir -and -not (Test-Path $outDir)) { New-Item -ItemType Directory -Path $outDir | Out-Null }
if ($reportDir -and -not (Test-Path $reportDir)) { New-Item -ItemType Directory -Path $reportDir | Out-Null }

$allFiles = @()
if ($IncludePaths.Count -gt 0) {
  foreach ($inc in $IncludePaths) {
    $target = [System.IO.Path]::GetFullPath((Join-Path $rootAbs $inc))
    if (Test-Path $target -PathType Container) {
      $allFiles += Get-ChildItem -LiteralPath $target -Recurse -File
    } elseif (Test-Path $target -PathType Leaf) {
      $allFiles += Get-Item -LiteralPath $target
    }
  }
} else {
  $allFiles = Get-ChildItem -LiteralPath $rootAbs -Recurse -File
}

$allFiles = $allFiles | Sort-Object FullName -Unique

$sb = New-Object System.Text.StringBuilder
$includeCount = 0
$includeChars = 0
$skipped = New-Object System.Collections.Generic.List[string]

foreach ($f in $allFiles) {
  $abs = $f.FullName
  if ($abs -eq $outAbs -or $abs -eq $reportAbs) { continue }

  $rel = Normalize-RelPath -rootAbs $rootAbs -fileAbs $abs
  if (Should-ExcludeFile $rel) { continue }

  if ($f.Length -gt $maxBytes) {
    $skipped.Add("$rel`tSKIP_SIZE`t$f.Length")
    continue
  }

  try {
    $bytes = [System.IO.File]::ReadAllBytes($abs)
    if (-not (Is-LikelyText $bytes)) {
      $skipped.Add("$rel`tSKIP_BINARY`t$f.Length")
      continue
    }
    $content = [System.Text.Encoding]::UTF8.GetString($bytes)
  } catch {
    $skipped.Add("$rel`tSKIP_READ_ERROR`t$($_.Exception.Message)")
    continue
  }

  [void]$sb.Append("===== FILE: $rel =====`r`n")
  [void]$sb.Append($content)
  if (-not $content.EndsWith("`n") -and -not $content.EndsWith("`r")) {
    [void]$sb.Append("`r`n")
  }

  $includeCount += 1
  $includeChars += $content.Length
}

$utf8NoBom = New-Object System.Text.UTF8Encoding($false)
[System.IO.File]::WriteAllText($outAbs, $sb.ToString(), $utf8NoBom)

$report = New-Object System.Text.StringBuilder
[void]$report.AppendLine("BUNDLE REPORT")
[void]$report.AppendLine("Root: $rootAbs")
[void]$report.AppendLine("Bundle: $outAbs")
[void]$report.AppendLine("GeneratedAt: $(Get-Date -Format s)")
[void]$report.AppendLine("IncludedFiles: $includeCount")
[void]$report.AppendLine("IncludedChars: $includeChars")
[void]$report.AppendLine("SkippedFiles: $($skipped.Count)")
[void]$report.AppendLine("")
[void]$report.AppendLine("SKIPPED LIST")
foreach ($line in $skipped) {
  [void]$report.AppendLine($line)
}
[System.IO.File]::WriteAllText($reportAbs, $report.ToString(), $utf8NoBom)

Write-Host "Bundle generated: $outAbs"
Write-Host "Report generated: $reportAbs"
Write-Host "Included files: $includeCount"
Write-Host "Skipped files: $($skipped.Count)"
